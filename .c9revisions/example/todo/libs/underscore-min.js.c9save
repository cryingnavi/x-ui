{"ts":1382330408201,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*\n * \n * http://\n *\n * Copyright 2011, Young Nam, Heo \n * Dual licensed under the GPL Version 1 licenses.\n *\n */\n\n\n/*\n\tNamespace Create\n*/\nX = {\n    version : '1.1.0.0'\n};\n\n/*\n\tX Common\n*/\n(function(){\n\n\tvar win = $(window), \n\t\tdoc = $(document),\n\t\tbody;\n\n\tX.apply = $.extend;\n\tX.apply(X, {\n\t\temptyFn: $.noop,\n\t\tformat: function(str){\n\t\t\tvar args = arguments, len = args.length;\n\t\t\tvar reg;\n\t\t\tfor(var i=0; i<len; i++){\n\t\t\t\treg = new RegExp('\\\\{'+i+'\\\\}', 'g');\n\t\t\t\tstr = str.replace(reg, args[i+1]);\n\t\t\t}\n\t\t\treturn str;\n\t\t},\n\t\textend: function(sp, proto){\n\t\t\tvar sb = function(){\n\t\t\t\tvar args = $.makeArray(arguments);\n\t\t\t\tthis.initialize.apply(this, args);\n\t\t\t};\n\n\t\t\tvar F = function(){ },\n\t\t\t\tspp = sp.prototype;\n\t\t\t\n\t\t\tF.prototype = spp;\n\t\t\tif(!spp.initialize){\n\t\t\t\tspp.initialize = X.emptyFn;\n\t\t\t}\n\t\t\tsb.prototype = new F();\n\t\t\tsb.prototype.constructor = sb;\n\t\t\tsb.base = spp;\n\n\t\t\tif (proto){\n\t\t\t\tX.apply(sb.prototype, proto);\n\t\t\t}\n\t\t\t\n\t\t\tsb.extend = function(proto){\n\t\t\t\tvar sp = this;\n\t\t\t\treturn X.extend(sp, proto);\n\t\t\t};\n\n\t\t\treturn sb;\n\t\t},\n\t\ttype: function(o){\n\t\t\tvar t = $.type(o);\n\t\t\tif(t === 'object'){\n\t\t\t\tif(o.innerHTML){\n\t\t\t\t\tt = 'dom';\n\t\t\t\t}\n\t\t\t\telse if(o.jquery){\n\t\t\t\t\tt = 'jquery';\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn t;\n\t\t},\n\t\tgetOrientation: function(){\n\t\t\tvar ori = window.orientation;\n\t\t\tif(ori === 0){\n\t\t\t\treturn 'portrait';\n\t\t\t}\n\t\t\telse if(ori === 90){\n\t\t\t\treturn 'landscape';\n\t\t\t}\n\t\t\telse if(ori === -90){\n\t\t\t\treturn 'landscape';\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn 'portrait';\n\t\t\t}\n\t\t},\n\t\tgetBody: function(flag){\n\t\t\tif(!body){\n\t\t\t\tbody = $('body');\n\t\t\t}\n\t\t\treturn flag === true ? document.body : body;\n\t\t},\n\t\tgetDoc: function(flag){\n\t\t\treturn flag === true ? document : doc;\n\t\t},\n\t\tgetWindow: function(flag){\n\t\t\treturn flag === true ? window : win;\n\t\t},\n\t\tgetWindowSize: function(){\n\t\t\tvar win = this.getWindow();\n\t\t\treturn {\n\t\t\t\twidth: win.width(),\n\t\t\t\theight: win.height()\n\t\t\t};\n\t\t}\n\t});\n\n\t//animation complete callback\n\t$.fn.animationComplete = function( callback, data ){\n\t\tif('WebKitTransitionEvent' in window){\n\t\t\treturn $(this).one('webkitAnimationEnd', data, callback);\n\t\t}\n\t\telse{\n\t\t\t// defer execution for consistency between webkit/non webkit\n\t\t\tsetTimeout(callback, 0);\n\t\t\treturn $(this);\n\t\t}\n\t};\n\n\t\n\n\tX.platform = (function(){\n\t\tvar userAgent = navigator.userAgent.toLowerCase();\n\t\tvar platform = navigator.platform;\n\n\t\tvar iPhone = /iPhone/i.test(platform),\n\t\t\tiPad = /iPad/i.test(platform),\n\t\t\tiPod = /iPod/i.test(platform);\n\n\t\tvar win = /win/i.test(platform),\n\t\t\tmac = /mac/i.test(platform),\n\t\t\tlinux = /linux/i.test(platform),\n\t\t\tiOs = iPhone || iPad || iPod;\n\n\t\tvar android = /android/i.test(userAgent),\n\t\t\tandroidVersion = parseFloat(userAgent.slice(userAgent.indexOf(\"android\")+8));\n\n\t\treturn {\n\t\t\tisIos: iOs,\n\t\t\tisWindows: win,\n\t\t\tisMac: mac,\n\t\t\tisLinux: linux,\n\t\t\tisDesktop: win || (!android && linux) || mac,\n\t\t\tiPod: iPod,\n\t\t\tiPhone: iPhone,\n\t\t\tiPad: iPad,\n\t\t\tandroid: android,\n\t\t\tandroidVersion: androidVersion,\n\t\t\thasTouch: ('ontouchstart' in window)\n\t\t};\n\t})();\n\n\tX.events = (function(){\n\t\tvar hasTouch = X.platform.hasTouch ? true : false;\n\t\treturn {\n\t\t\tstart: hasTouch ? 'touchstart' : 'vmousedown',\n\t\t\tmove: hasTouch ? 'touchmove' : 'vmousemove',\n\t\t\tend: hasTouch ? 'touchend' : 'vmouseup',\n\t\t\torientationchange: hasTouch ? 'orientationchange' : 'resize'\n\t\t};\n\t})();\n})();\n\n\nX.apply(Array.prototype, {\n\tremove: function(from, to){\n\t\tvar rest = this.slice((to || from) + 1 || this.length);\n\t\tthis.length = from < 0 ? this.length + from : from;\n\t\treturn this.push.apply(this, rest);\n\t}\n});\n\n\nX.util = { };\nX.util.Observer = X.extend(X.emptyFn, {\n\tinitialize: function(listener){\n\t\tthis.eventTypes = this.eventTypes || {};\n\t\tfor (var attr in listener) {\n\t\t\tthis.eventTypes[attr] = listener[attr];\n\t\t}\n\t},\n\taddEvent: function(){\n\t\tvar a = arguments,\n\t\t\ti = a.length;\n\n\t\twhile(i--) {\n\t\t\tfor (var attr in a[i]){\n\t\t\t\tif(this.eventTypes[attr]){\n\t\t\t\t\tif(X.type(this.eventTypes[attr]) === 'array'){\n\t\t\t\t\t\tthis.eventTypes[attr].push(a[i][attr]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.eventTypes[attr] = [this.eventTypes[attr], a[i][attr]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.eventTypes[attr] = a[i][attr];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tfireEvent: function(o, type, args){\n\t\tvar params = o.config ? o.config.params || [] : [];\n\t\t\n\t\tif (this.eventTypes[type]) {\n\t\t\targs = args || [];\n\t\t\tif(X.type(this.eventTypes[type]) === 'object'){\n\t\t\t\tvar event = this.eventTypes[type];\n\t\t\t\tparams = event.params ? params.concat(event.params) : params;\n\t\t\t\t\n\t\t\t\tif(event.type === 'listener'){\n\t\t\t\t\tif(X.type(event.comp) === 'string') {\n\t\t\t\t\t\tevent.comp = X.util.cm.get(event.comp);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(event.comp){\n\t\t\t\t\t\treturn event.comp.fireEvent(event.comp, event.eventName, params);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(event.type === 'javascript'){\n\t\t\t\t\tif(params.length > 0){\n\t\t\t\t\t\tvar a = [];\n\t\t\t\t\t\tfor(var i=0; i<params.length; i++){\n\t\t\t\t\t\t\ta.push('a' + (i+1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar fn = new Function(a, event.body);\n\t\t\t\t\t\treturn fn.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tvar fn = new Function(event.body);\n\t\t\t\t\t\treturn fn.call(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\treturn event.fn.apply(event.scope || o, args.concat(params));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(X.type(this.eventTypes[type]) === 'array'){\n\t\t\t\tfor(var i=0, len = this.eventTypes[type].length; i<len; i++){\n\t\t\t\t\tvar event = this.eventTypes[type][i],\n\t\t\t\t\t\tresult = false;\n\n\t\t\t\t\tif(X.type(event) === 'object'){\n\t\t\t\t\t\tparams = event.params ? params.concat(event.params) : params;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(event.type === 'listener'){\n\t\t\t\t\t\t\tif(X.type(event.comp) === 'string') {\n\t\t\t\t\t\t\t\tevent.comp = X.util.cm.get(event.comp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(event.comp){\n\t\t\t\t\t\t\t\tresult = event.comp.fireEvent(event.comp, event.eventName, params);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(event.type === 'javascript'){\n\t\t\t\t\t\t\tif(params.length > 0){\n\t\t\t\t\t\t\t\tvar a = [];\n\t\t\t\t\t\t\t\tfor(var j=0; j<params.length; j++){\n\t\t\t\t\t\t\t\t\ta.push('a' + (j+1));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar fn = new Function(a, event.body);\n\t\t\t\t\t\t\t\tresult = fn.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tvar fn = new Function(event.body);\n\t\t\t\t\t\t\t\tresult = fn.call(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tresult = event.fn.apply(event.scope || o, args.concat(params));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tresult = event.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn this.eventTypes[type].apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn false;\n\t},\n\tremoveEvent: function(type){\n\t\tif (this.eventTypes[type]) {\n\t\t\tdelete this.eventTypes[type];\n\t\t}\n\t},\n\tclear: function(){\n\t\tthis.eventTypes = {};\n\t}\n});\n\nX.util.Observer.prototype.on = X.util.Observer.prototype.addEvent;\nX.util.Observer.prototype.off = X.util.Observer.prototype.removeEvent;\nX.util.Observer.prototype.fire = X.util.Observer.prototype.fireEvent;\n\nX.util.ElementManager = X.util.em = {\n\tid: 'x-ui-',\n\tindex: 1000,\n\tget: function(selector){\n\t\tif(selector){\n\t\t\tvar type = X.type(selector);\n\t\t\tif(type === 'string' || type === 'dom'){\n\t\t\t\tvar el = $(selector),\n\t\t\t\t\tme = this;\n\t\t\t\t\n\t\t\t\tel.each(function(){\n\t\t\t\t\tif(!this.id){\n\t\t\t\t\t\tthis.id = me.id + me.index++;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\telse if(type === 'jquery'){\n\t\t\t\tvar el = selector,\n\t\t\t\t\tme = this;\n\t\t\t\t\n\t\t\t\tel.each(function(){\n\t\t\t\t\tif(!this.id){\n\t\t\t\t\t\tthis.id = me.id + me.index++;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\telse if(type === 'object'){\n\t\t\t\tvar config = selector,\n\t\t\t\t\ttag = config.tag;\n\t\t\t\t\n\t\t\t\treturn this.create(tag, config);\n\t\t\t}\n\t\t}\n\n\t\treturn this.create();\n\t},\n\tcreate: function(tag, config){\n\t\tvar el = null;\n\t\tconfig = config || {};\n\t\tdelete config.tag;\n\t\tif(tag){\n\t\t\tel = $('<' + tag + ' />', config);\n\t\t}\n\t\telse{\n\t\t\tel = $('<div />', config);\n\t\t}\n\n\t\tif(config.id){\n\t\t\tel.attr('id', config.id);\n\t\t}\n\t\telse{\n\t\t\tel.attr('id', this.id + this.index++);\n\t\t}\n\n\t\treturn el;\n\t}\n};\n\nX.util.ComponentManager = X.util.cm = {\n\tmap: { },\n\tcString: { },\n\tcreate: function(contain, items){\n\t\tfor(var i=0, len=items.length; i<len; i++){\n\t\t\tif(!items[i].render){\n\t\t\t\titems[i] = new this.cString[items[i].cString](items[i]);\n\t\t\t}\n\n\t\t\tthis.elementAdd(contain, items[i].el);\n\t\t\tif(!items[i].config.autoRender){\n\t\t\t\titems[i].render();\n\t\t\t}\n\t\t\t\n\t\t\tthis.set(items[i].el.attr('id'), items[i]);\n\t\t}\n\t\t\n\t\treturn items;\n\t},\n\telementAdd: function(contain, el){\n\t\tcontain.append(el);\n\t},\n\tset: function(id, item){\n\t\tthis.map[id] = item;\n\t},\n\tget: function(id){\n\t\treturn this.map[id];\n\t},\n\taddCString: function(name, klass){\n\t\tthis.cString[name] = klass;\n\t},\n\tremove: function(id){\n\t\tdelete this.map[id];\n\t},\n\tclear: function(){\n\t\tthis.map = { };\n\t}\n};\n\n\nX.util.History = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tvc: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.History.base.initialize.call(this, listener);\n\t\t\n\t\t/* view */\n\t\tthis.viewMap = { };\n\t\t\n\t\t/* ajax data save */\n\t\tthis.ajaxCache = { };\n\t\t\n\t\t/* view id */\n\t\tthis.stack = [];\n\t},\n\tinitPageSave: function(key, view){\n\t\tthis.clear();\n\t\t\n\t\tthis.viewMap[key] = {\n\t\t\tview: view,\n\t\t\ttransition: 'none'\n\t\t};\n\t\tthis.stack.push(key);\n\t},\n\tnextPageSave: function(key, view, transition){\n\t\tthis.viewMap[key] = {\n\t\t\tview: view,\n\t\t\ttransition: transition\n\t\t};\n\t\tthis.stack.push(key);\n\t},\n\tprevPageSave: function(key){\n\t\tvar reverse = this.stack.reverse();\n\t\tvar len = 0;\n\t\tvar removeView = [];\n\n\t\tfor(var i=0; i<reverse.length; i++){\n\t\t\tif(key === reverse[i]){\n\t\t\t\tlen = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tremoveView.push(reverse[i]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i=0; i<removeView.length; i++){\n\t\t\tif(this.viewMap[removeView[i]]){\n\t\t\t\tthis.viewMap[removeView[i]].view.destroy();\n\t\t\t\tthis.removeViewMap(removeView[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis.stack.reverse();\n\t\tthis.stack = this.stack.slice(0, this.stack.length - len);\n\t},\n\tremoveViewMap: function(key){\n\t\tthis.viewMap[key].view.destroy();\n\t\tdelete this.viewMap[key];\n\t},\n\tremoveStack: function(key){\n\t\tvar i=0,\n\t\t\tstack = this.stack,\n\t\t\tlen = stack.length,\n\t\t\tarray = [];\n\t\tfor(;i<len;i++){\n\t\t\tif(stack[i] !== key){\n\t\t\t\tarray.push(stack[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis.stack = array;\n\t},\n\tgetBackPageInfo: function(){\n\t\tif(this.stack.length < 2){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar from = this.stack[this.stack.length - 1];\n\t\tvar to = this.stack[this.stack.length - 2];\n\t\t\n\t\tvar fromView = this.viewMap[from];\n\t\tvar toView = this.viewMap[to];\n\t\t\n\t\treturn {\n\t\t\tfromView: fromView.view,\n\t\t\ttoView: toView.view,\n\t\t\ttransition: fromView.transition\n\t\t}\n\t},\n\tsetAjaxCache: function(key, cacheData){\n\t\tthis.ajaxCache[key] = cacheData;\n\t},\n\tgetAjaxCache: function(key){\n\t\treturn this.ajaxCache[key];\n\t},\n\tisCache: function(key){\n\t\tif(this.ajaxCache[key]){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\tgetViewInfo: function(key){\n\t\tif(this.viewMap[key]){\n\t\t\treturn this.viewMap[key];\n\t\t}\n\t\treturn null;\n\t},\n\tclear: function(){\n\t\tvar removeView = this.stack;\n\t\tfor(var i=0; i<removeView.length; i++){\n\t\t\tif(this.viewMap[removeView[i]]){\n\t\t\t\tthis.viewMap[removeView[i]].view.destroy();\n\t\t\t}\n\t\t}\n\n\t\tthis.viewMap = { };\n\t\tthis.ajaxCache = { };\n\t\tthis.stack = [ ];\n\t},\n\tgetStackLength: function(){\n\t\treturn this.stack.length;\n\t}\n});\n\n\n\nX.util.ViewController = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tactiveIndex: 0,\n\t\t\ttransition: 'slide'\n\t\t};\n\t\tX.apply(this.config, config);\n\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.ViewController.base.initialize.call(this, listener);\n\n\t\tthis.history = new X.util.History({\n\t\t\tvc: this\n\t\t});\n\t\t\n\t\tthis.id = this.config.id || 'ui-vc-' + (X.util.ViewController.id++);\n\n\t\tX.util.ViewController.set(this);\n\t},\n\tinit: function(view){\n\t\tthis.view = view;\n\t},\n\tvalid: function(fromView, toView){\n\t\tif(fromView === toView){\n\t\t\treturn true;\n\t\t}\n\t\telse{\n\t\t\treturn false;\n\t\t}\n\t},\n\ttransitionStart: function(fromView, toView, transition, reverse){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(fromView, toView, transition, reverse){\n\t\t\tvar viewIn = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.addClass(transition + ' in ' + reverse + ' ui-transitioning ui-vc-active');\n\t\t\t\ttel.animationComplete(viewOut);\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.addClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t},\n\t\t\tviewOut = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.removeClass(transition + ' in ' + reverse + ' ui-transitioning');\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.removeClass(transition + ' out ' + reverse + ' ui-transitioning ui-vc-active');\n\t\t\t\t\n\t\t\t\tdone();\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this, [fromView, toView]);\n\n\t\t\t\tfromView = null, toView = null, transition = null, reverse = null;\n\t\t\t};\n\n\t\t\tviewIn();\n\t\t}\n\n\t\ttransitionHandler(fromView, toView, transition, reverse);\n\t\t\n\t\treturn deferred;\n\t},\n\tprevMove: function(fromView, toView, config){\n\t\tvar promise,\n\t\t\tme = this;\n\n\t\tconfig = X.apply({\n\t\t\ttransition: this.config.transition,\n\t\t\treverse: 'reverse'\n\t\t}, config);\n\n\t\n\t\tif(!X.util.vcm.transition){\n\t\t\tconfig.transition = false;\n\t\t}\n\n\t\tthis.fireEvent(this, 'beforeprevchange', [fromView, toView, config.params || null]);\n\n\t\tpromise = this.transitionStart(fromView, toView, config.transition, config.reverse);\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\n\t\t\tme.setActiveView(toView);\n\t\t\tme.history.prevPageSave(toView.getId());\n\n\t\t\tme.fireEvent(me, 'afterprevchange', [fromView, toView, config.params || null]);\n\n\t\t\tme = null, fromView = null, toView = null, config = null;\n\t\t});\n\t},\n\tnextMove: function(fromView, toView, config){\n\t\tvar promise,\n\t\t\tme = this;\n\t\t\n\t\tconfig = X.apply({\n\t\t\ttransition: this.config.transition,\n\t\t\thistory: true,\n\t\t\treverse: ''\n\t\t}, config);\n\t\t\n\t\tif(!X.util.vcm.transition){\n\t\t\tconfig.transition = false;\n\t\t}\n\n\t\tthis.fireEvent(this, 'beforenextchange', [fromView, toView, config.params || null]);\n\n\t\tpromise = this.transitionStart(fromView, toView, config.transition, config.reverse);\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\t\t\t\n\t\t\tme.setActiveView(toView);\n\t\t\tme.history.nextPageSave(toView.getId(), toView, config.transition);\n\t\t\tme.fireEvent(me, 'afternextchange', [fromView, toView, config.params || null]);\n\n\t\t\tme = null, fromView = null, toView = null, config = null;\n\t\t});\n\t},\n\tbackPage: function(){\n\t\tif(this.history.getStackLength() < 2){\n\t\t\treturn false;\n\t\t}\n\t\tvar o = this.history.getBackPageInfo();\n\t\tthis.prevMove(o.fromView, o.toView, {\n\t\t\ttransition: o.transition\n\t\t});\n\n\t\treturn true;\n\t}\n});\n\nX.util.vcm = X.util.ViewControllerManager = X.apply(X.util.ViewController, {\n\tid: 0,\n\ttransition: true,\n\tchanging: false,\n\tmap: { },\n\tloadingMsg: 'Loading..',\n\terrorMsg: '화면을 불러오지 못했습니다.',\n\tget: function(id){\n\t\treturn this.map[id];\n\t},\n\tset: function(vc){\n\t\tthis.map[vc.id] = vc;\n\t}\n});\n\n\nX.util.LocalViewController = X.extend(X.util.ViewController, {\n\tinitialize: function(config){\n\t\tthis.config = {  };\n\t\tX.apply(this.config, config);\n\t\tX.util.LocalViewController.base.initialize.call(this, this.config);\n\n\t\tthis.views = [];\n\t},\n\tinit: function(view){\n\t\tX.util.LocalViewController.base.init.call(this, view);\n\t\t\n\t\tthis.views = this.view.config.items;\n\t\tthis.viewsInit();\n\t},\n\tviewsInit: function(){\n\t\tif(this.views.length < 1){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar views = this.views,\n\t\t\tlen = views.length,\n\t\t\tactiveIndex = this.config.activeIndex,\n\t\t\tactiveView;\n\n\t\tactiveView = views[activeIndex];\n\n\t\tthis.setActiveView(activeView);\n\t\tthis.history.initPageSave(activeView.getId(), activeView);\n\n\t\tviews.forEach(function(view){\n\t\t\tview.el.addClass('ui-vc-views');\n\t\t});\n\t},\n\tsetActiveView: function(activeView){\n\t\tthis.activeView = activeView;\n\t\tthis.activeView.el.addClass('ui-vc-active');\n\t},\n\tgetActiveView: function(){\n\t\treturn this.activeView;\n\t},\n\tgetActiveIndex: function(){\n\t\tvar active = this.getActiveView();\n\t\tfor(var i=0; i<this.config.views.length; i++){\n\t\t\tif(active === this.config.views[i]){\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t},\n\tgetView: function(index){\n\t\tif(this.views.length < 1){\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tvar view = this.views[index];\n\t\tif(!view){\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\treturn view;\n\t},\n\tnextPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoView = this.getView(config.index);\n\t\t\n\t\tif(this.valid(fromView, toView)){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tX.util.vcm.changing = true;\n\t\tthis.nextMove(fromView, toView, config);\n\t},\n\tprevPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoViewInfo = this.history.getViewInfo(this.getView(config.index).getId());\n\t\t\n\t\tif(this.valid(fromView, toViewInfo.view)){\n\t\t\treturn false;\n\t\t}\n\n\t\tX.util.vcm.changing = true;\n\t\tthis.prevMove(fromView, toViewInfo.view, {\n\t\t\ttransition: toViewInfo.transition\n\t\t});\n\t},\n\tappendView: function(view){\n\t\tview.el.addClass('ui-vc-active');\n\t\tthis.views.push(view);\n\t},\n\tremoveView: function(view){\n\t\tvar i=0,\n\t\t\tviews = this.views,\n\t\t\tlen = views.length,\n\t\t\tarray = [],\n\t\t\tid = view.getId();\n\t\t\n\t\tfor(; i<len; i++){\n\t\t\tif(views[i] !== view){\n\t\t\t\tarray.push(views[i]);\n\t\t\t}\n\t\t}\n\t\tthis.views = array;\n\n\t\tthis.history.removeMap(id);\n\t\tthis.history.removeStack(id);\n\t}\n});\n\n\nX.util.cm.addCString('localviewcontroller', X.util.LocalViewController);\n\n\nX.util.RemoteViewController = X.extend(X.util.ViewController, {\n\tinitialize: function(config){\n\t\tthis.config = {  };\n\t\tX.apply(this.config, config);\n\t\tX.util.RemoteViewController.base.initialize.call(this, this.config);\n\n\t\tthis.views = [];\n\t\tthis.updater = new X.util.ViewUpdater({\n\t\t\tvc: this\n\t\t});\n\t},\n\tinit: function(view){\n\t\tX.util.RemoteViewController.base.init.call(this, view);\n\t\t\n\t\tif(this.config.initPage){\n\t\t\tthis.initPage(this.config.initPage);\n\t\t}\n\t},\n\tinitPage: function(config){\n\t\tthis.fireEvent(this, 'beforeinit', []);\n\t\tthis.callMethod = 'initSuccess';\n\t\tthis.send(config);\n\t},\n\tnextPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn;\n\t\t}\n\t\tX.util.ViewController.changing = true;\n\t\tthis.callMethod = 'nextSuccess';\n\t\t\n\t\tthis.send(config);\n\t},\n\tprevPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoViewInfo = this.history.getViewInfo(config.url);\n\t\t\n\t\tif(this.valid(fromView, toViewInfo.view)){\n\t\t\treturn false;\n\t\t}\n\n\t\tX.util.vcm.changing = true;\n\t\tthis.prevMove(fromView, toViewInfo.view, {\n\t\t\ttransition: toViewInfo.transition\n\t\t});\n\t},\n\tsetActiveView: function(active){\n\t\tthis.activeView = active;\n\t\tthis.activeView.el.addClass('ui-vc-active');\n\t},\n\tgetActiveView: function(){\n\t\tvar active = this.activeView;\n\t\treturn active;\n\t},\n\tgetToView: function(index){\n\t\tvar view;\n\t\tvar config = index;\n\t\tconfig.scroll = false;\n\t\tview = new X.View(config);\n\t\t\n\t\tview.getEl().addClass('ui-vc-views');\n\t\treturn view;\n\t},\n\tappend: function(view){\n\t\tthis.views.push(view);\n\t\tview.addClass('ui-vc-views');\n\t},\n\tsend: function(config){\n\t\tif(!this.history.isCache(config.url)){\n\t\t\t//loading..\n\t\t\tthis.loading = X.util.em.get()\n\t\t\t\t.html(X.util.vcm.loadingMsg).addClass('ui-loading-msg');\n\n\t\t\tX.getBody().prepend(this.loading);\n\t\t\tthis.loading.addClass('ui-popup in');\n\n\t\t\tif(this.updater && config.url){\n\t\t\t\tif(config.url){\n\t\t\t\t\tthis.updater.send(config);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tthis.success(this.history.getAjaxCache(config.url), config);\n\t\t}\n\t},\n\tsuccess: function(data, config){\n\t\tif(this.loading){\n\t\t\tthis.loading.remove();\n\t\t}\n\n\t\tthis.history.setAjaxCache(config.url, data);\n\t\tdata = $(data);\n\n\t\tvar html = [],\n\t\t\tscript = [];\n\t\t\n\t\tdata.each(function(){\n\t\t\tif(this.nodeName !== 'SCRIPT'){\n\t\t\t\thtml.push(this);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tscript.push(this);\n\t\t\t}\n\t\t});\n\t\t\n\t\tdata = {\n\t\t\thtml: $(html),\n\t\t\tscript: $(script)\n\t\t};\n\t\t\n\t\tvar toViewEl = data.html.eq(0),\n\t\t\tviewConfig = { id: config.url },\n\t\t\ttoView;\n\t\t\n\t\ttoView = this.history.getViewInfo(config.url);\n\t\tif(!toView){\n\t\t\ttoView = this.getToView(viewConfig);\n\t\t\ttoView.el.addClass('ui-vc-views');\n\t\t}\n\t\telse{\n\t\t\ttoView = toView.view;\n\t\t}\n\n\t\tthis[this.callMethod](data, toView, config);\n\t},\n\tinitSuccess: function(data, toView, config){\n\t\tthis.history.initPageSave(config.url, toView);\n\t\n\t\tthis.setActiveView(toView);\n\t\ttoView.setContent(data.html);\n\t\tthis.view.append([toView]);\n\t\ttoView.body.append(data.script);\n\n\t\tthis.fireEvent(this, 'afterinit', [this.getActiveView()]);\n\t},\n\tnextSuccess: function(data, toView, config){\n\t\tvar fromView = this.getActiveView({\n\t\t\tid: config.url\n\t\t});\t\t\n\n\t\tif(!this.history.getViewInfo(config.url)){\n\t\t\ttoView.setContent(data.html);\n\t\t\tthis.view.append([toView]);\n\t\t\ttoView.body.append(data.script);\n\t\t}\n\t\tthis.nextMove(fromView, toView, config);\n\t},\n\terrorTransition: function(div, type){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(div, type){\n\t\t\tvar divIn = function(){\n\t\t\t\tdiv.addClass('ui-popup in');\n\t\t\t\tdiv.animationComplete(divOut);\n\t\t\t},\n\t\t\tdivOut = function(){\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tdiv.removeClass('ui-popup in').addClass('ui-popup out');\n\t\t\t\t\tdiv.animationComplete(done);\n\t\t\t\t}, 3000);\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this);\n\n\t\t\t\tdiv = null, type = null;\n\t\t\t};\n\n\t\t\tif(type === 'show'){\n\t\t\t\tdivOut();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdivIn();\n\t\t\t}\n\t\t}\n\n\t\ttransitionHandler(div, type);\n\t\t\n\t\treturn deferred;\n\t},\n\terror: function(){\n\t\t//error\n\t\tvar div,\n\t\t\tpromise,\n\t\t\tfn = function(div){\n\t\t\t\tvar promise = this.errorTransition(div);\n\t\t\t\treturn promise;\n\t\t\t};\n\t\t\n\t\tif(this.loading){\n\t\t\tdiv = this.loading;\n\t\t\tdiv.html(X.util.vcm.errorMsg);\n\t\t\t\n\t\t\tif(div.css('display') !== 'none'){\n\t\t\t\tpromise = this.errorTransition(div, 'show');\n\t\t\t}\n\t\t\telse{\n\t\t\t\tpromise = fn.call(this, div);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tvar div = X.util.em.get()\n\t\t\t\t.html(X.util.vcm.errorMsg).addClass('ui-loading-msg');\n\t\t\tX.getBody().prepend(div);\n\t\t\t\n\t\t\tpromise = fn.call(this, div);\n\t\t}\n\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\t\t\tdiv.remove();\n\t\t\tdiv = null;\n\t\t});\n\t}\n});\n\n\nX.util.ViewUpdater = X.extend(X.util.Observer,{\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tclear: true,\n\t\t\tajax: {\n\t\t\t\tcontext: this,\n\t\t\t\ttimeout: 10000,\n\t\t\t\tdataType: 'html',\n\t\t\t\tsuccess: this.success,\n\t\t\t\terror: this.error\n\t\t\t}\n\t\t};\n\t\t\n\t\tX.apply(true, this.config, config);\n\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.ViewUpdater.base.initialize.call(this, listener);\n\t},\n\tsend: function(config){\n\t\tconfig = X.apply(config, this.config.ajax);\n\t\tvar xhr = $.ajax(config);\n\n\t\tvar params = { };\n\t\tparams.url = config.url;\n\t\tif(config.hasOwnProperty('transition')){\n\t\t\tparams.transition = config.transition;\n\t\t}\n\t\tif(config.hasOwnProperty('history')){\n\t\t\tparams.history = config.history;\n\t\t}\n\t\txhr.params = params;\n\t},\n\tsuccess: function(data, status, xhr){\n\t\tthis.config.vc.success(data, xhr.params);\n\t},\n\terror: function(xhr, status){\n\t\tthis.config.vc.error(xhr);\n\t}\n});\n\nX.util.cm.addCString('viewupdater', X.util.ViewUpdater);\n\nX.View = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tel: null,\n\t\t\twidth: 200,\n\t\t\theight: 200,\n\t\t\tautoSize: true,\n\t\t\tscroll: true,\n\t\t\tscrollConfig: { },\n\t\t\tcontent: null,\n\t\t\titems: [ ],\n\t\t\ttoolbars: [ ],\n\t\t\tfloating: false,\n\t\t\toverlay: false,\n\t\t\tviewController: null,\n\t\t\tlayout: 'y',\n\t\t\tflexible: true,\n\t\t\tpanels: null,\n\t\t\tclassName: null,\n\t\t\tstyle: null\n\t\t};\n\t\tX.apply(true, this.config, config);\n\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.View.base.initialize.call(this, listener);\n\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t\t\n\t\tthis.body = this.el.wrapInner(\n\t\t\tX.util.em.get().addClass('ui-view-body')\n\t\t).children();\n\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\tthis.el.addClass('ui-view');\n\n\t\tthis.setLayout(this.config.layout);\n\t\tthis.setSize(this.config.autoSize);\n\n\t\tif(this.config.className){\n\t\t\tthis.el.addClass(this.config.className);\n\t\t}\n\n\t\tif(this.config.style){\n\t\t\tthis.el.css(this.config.style);\n\t\t}\n\n\t\tif(this.config.toolbars.length > 0){\n\t\t\tthis.addToolbar(this.config.toolbars);\n\t\t}\n\n\t\tif(this.config.content){\n\t\t\tthis.setContent(this.config.content);\n\t\t}\n\t\t\n\t\tif(this.config.items.length > 0){\n\t\t\tthis.add(this.config.items);\n\t\t}\n\n\t\tif(this.config.viewController){\n\t\t\tthis.setViewController(this.config.viewController);\n\t\t}\n\t\t\n\t\tif(this.config.floating){\n\t\t\tthis.setFloating(this.config.floating);\n\t\t}\n\t\t\n\t\tif(this.config.panels){\n\t\t\tthis.panelsCreate(this.config.panels);\n\t\t}\t\n\n\t\tthis.setFlexible(this.config.flexible);\n\t\tthis.scrollCreate(this.config.scroll);\n\n\t\tX.getWindow().on(X.events.orientationchange, { me: this }, this.onOrientationChange);\n\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tscrollRefresh: function(){\n\t\tif(this.scroll){\n\t\t\tthis.scroll.refresh();\n\t\t}\n\t},\n\tpanelsCreate: function(panels){\n\t\tif(panels.left){\n\t\t\tthis.panelsLeft = X.util.em.get()\n\t\t\t\t.addClass('ui-view-panels-left');\n\t\t\t\n\t\t\tthis.el.append(this.panelsLeft);\n\t\t\t\n\t\t\tX.util.cm.create(this.panelsLeft, [panels.left]);\n\t\t}\n\t\t\n\t\tif(panels.right){\n\t\t\tthis.panelsRight = X.util.em.get()\n\t\t\t\t.addClass('ui-view-panels-right');\n\t\t\t\n\t\t\tthis.el.append(this.panelsRight);\n\t\t\t\n\t\t\tX.util.cm.create(this.panelsRight, [panels.right]);\n\t\t}\t\t\n\t\t\n\t\tthis.body.addClass('ui-view-panels ui-view-panels-close');\n\t},\n\tpanelsOpen: function(type){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tthis.body.removeClass('ui-view-panels-close').addClass('ui-view-panels-open-' + type);\n\t\t\t\n\t\t\tthis.fireEvent(this, 'panelsopen', [this]);\n\t\t}\n\t},\n\tpanelsClose: function(){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tthis.body.removeClass('ui-view-panels-open').addClass('ui-view-panels-close');\n\t\t\t\n\t\t\tthis.fireEvent(this, 'panelsclose', [this]);\n\t\t}\n\t},\n\tpanelsToggle: function(type){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tif(this.body.hasClass('ui-view-panels-close')){\n\t\t\t\tthis.panelsOpen(type);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.panelsClose(type);\n\t\t\t}\n\t\t}\n\t},\n\tsetContent: function(content){\n\t\tvar reg = /^#/;\n\t\tif(X.type(content) === 'string' && reg.test(content)){\n\t\t\tcontent = $(content);\n\t\t\tif(this.body.children('.ui-scrollview-view').length > 0){\n\t\t\t\tthis.body.children('.ui-scrollview-view').html(content);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.body.html(content);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(this.body.children('.ui-scrollview-view').length > 0){\n\t\t\t\tthis.body.children('.ui-scrollview-view').html(content);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.body.html(content);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.createHtmlComponent();\n\t},\n\tsetLayout: function(layout){\n\t\tif(layout === \"x\"){\n\t\t\tthis.el.addClass(\"ui-view-horizontal\");\n\t\t\tthis.body.removeClass(\"ui-view-body-vertical\")\n\t\t\t\t.addClass(\"ui-view-body-horizontal\");\n\t\t}\n\t\telse if(layout === \"y\"){\n\t\t\tthis.body.removeClass(\"ui-view-body-horizontal\")\n\t\t\t\t.addClass('ui-view-body-vertical');\n\t\t}\n\t},\n\tsetFlexible: function(flex){\n\t\tif(flex){\n\t\t\tthis.el.removeClass('ui-view-inflexible')\n\t\t\t\t.addClass('ui-view-flexible');\n\t\t}\n\t\telse{\n\t\t\tthis.el.removeClass('ui-view-flexible')\n\t\t\t\t.addClass('ui-view-inflexible');\n\t\t}\n\t},\n\tsetSize: function(autoSize){\n\t\tthis.setWidth(autoSize);\n\t\tthis.setHeight(autoSize);\n\t},\n\tsetWidth: function(width){\n\t\tif(X.type(width) !== 'boolean' && width !== true){\n\t\t\tthis.setFlexible(false);\n\t\t\tvar w = width || this.config.width;\n\t\t\tthis.el.width(w);\n\t\t}\n\t},\n\tsetHeight: function(height){\n\t\tif(X.type(height) !== 'boolean' && height !== true){\n\t\t\tthis.setFlexible(false);\n\t\t\tvar h = height || this.config.height;\n\t\t\tthis.el.height(h)\n\t\t\t\t.css('min-height', h);\n\t\t}\n\t},\n\tgetWidth: function(){\n\t\tvar width = this.el.outerWidth();\n\t\treturn width;\n\t},\n\tgetHeight: function(){\n\t\tvar height = this.el.outerHeight();\n\t\treturn height;\n\t},\n\tscrollCreate: function(scroll){\n\t\tif(scroll){\n\t\t\tthis.scroll = new iScroll(this.body.get(0), this.config.scrollConfig);\n\t\t}\n\t},\n\tscrollDestroy: function(){\n\t\tif(this.scroll){\n\t\t\tthis.scroll.destroy();\n\t\t}\n\t},\n\tonOrientationChange: function(e){\n\t\tvar me = e.data.me;\n\t\tme.fireEvent(me, 'orientationchange', []);\n\t},\n\tshow: function(transition){\n\t\tif(!this.el.hasClass('ui-view-hide')){\n\t\t\treturn;\n\t\t}\n\n\t\tif(this.config.floating){\n\t\t\tif(this.config.floating){\n\t\t\t\tvar style = this.el.get(0).style;\n\t\t\t\tthis.el.css({\n\t\t\t\t\tmarginTop: -(parseInt(style.height) / 2),\n\t\t\t\t\tmarginLeft: -(parseInt(style.width) / 2)\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(this.overlay){\n\t\t\t\tthis.overlay.show();\n\t\t\t}\n\t\t}\n\n\t\tthis.el.removeClass('ui-view-hide');\n\n\t\tif(transition){\n\t\t\tthis.el.addClass('pop in').animationComplete(function(){\n\t\t\t\tthis.className = this.className.replace('pop in', '');\n\t\t\t});\n\t\t}\t\n\t\tthis.fireEvent(this, 'show', [this]);\n\n\t\treturn this;\n\t},\n\thide: function(transition){\n\t\tif(this.el.hasClass('ui-view-hide')){\n\t\t\treturn;\n\t\t}\n\n\t\tif(transition){\n\t\t\tthis.el.addClass('out').animationComplete(function(){\n\t\t\t\tthis.className = this.className.replace('out', '') + 'ui-view-hide';\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tthis.el.addClass('ui-view-hide');\n\t\t}\n\t\t\n\t\t\n\t\tif(this.config.floating && this.overlay){\n\t\t\tthis.overlay.hide();\n\t\t}\n\n\t\tthis.fireEvent(this, 'hide', [this]);\n\t\treturn this;\n\t},\n\ttoggle: function(){\n\t\tif(this.el.hasClass('ui-view-hide')){\n\t\t\tthis.show();\n\t\t}\n\t\telse{\n\t\t\tthis.hide();\n\t\t}\n\t},\n\tgetEl: function(){\n\t\treturn this.el;\n\t},\n\tgetId: function(){\n\t\treturn this.el.attr('id');\n\t},\n\tgetViewController: function(){\n\t\treturn this.config.viewController;\n\t},\n\tsetViewController: function(vc){\n\t\tif(X.type(vc) === 'string'){\n\t\t\tvc = X.util.ViewController.get(vc);\n\t\t}\n\n\t\tif(!vc){\n\t\t\tnew Error('arguments is unknow');\n\t\t}\n\n\t\tvc.init(this);\n\t\tthis.config.viewController = vc;\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t\tX.getWindow().off(X.events.orientationchange, this.onOrientationChange);\n\n\t\tthis.fireEvent(this, 'destroy', [this]);\n\t},\n\tadd: function(comps){\n\t\tvar el = this.body.children('.ui-scrollview-view');\n\t\tif(el.length < 1){\n\t\t\tel = this.body;\n\t\t}\n\t\tcomps = X.util.cm.create(el, comps);\n\t\tthis.config.items = $.unique(this.config.items.concat(comps));\n\t\tthis.config.items.reverse();\n\t\t\n\t\treturn comps;\n\t},\n\tremove: function(index){\n\n\t},\n\taddToolbar: function(toolbars){\n\t\ttoolbars = X.util.cm.create(this.el, toolbars);\n\t\tthis.config.toolbars.push(toolbars);\n\n\t\treturn toolbars;\n\t},\n\tsetFloating: function(float){\n\t\tif(float){\n\t\t\tthis.config.floating = float;\n\t\t\tthis.el.addClass('ui-view-floating ui-view-hide');\n\t\t}\n\t\telse{\n\t\t\tthis.el.removeClass('ui-view-floating ui-view-hide');\n\t\t}\t\t\n\t\tthis.setOverlay(this.config.overlay);\n\t},\n\tsetOverlay: function(overlay){\n\t\tif(overlay){\n\t\t\tif(this.config.floating){\n\t\t\t\tthis.overlay = X.util.em.get().addClass('ui-overlay');\n\t\t\t\tX.getBody().append(this.overlay);\n\t\t\t\tthis.overlay.bind('vclick', { me: this }, function(e){\n\t\t\t\t\tvar me = e.data.me;\n\t\t\t\t\tme.hide();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(this.overlay){\n\t\t\t\t\tthis.overlay.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(this.overlay){\n\t\t\t\tthis.overlay.remove();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.config.overlay = overlay;\n\t},\n\tcreateHtmlComponent: function(){\n\t\tvar\tviews = this.el.find('[data-role=\"view\"]');\n\t\tviews.each(function(){\n\t\t\tvar el = $(this);\n\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val, panels = { };\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\t\t\t\n\t\t\tconfig.el = el;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tnew X.View(config);\n\t\t});\n\n\t\tvar panels = this.el.find('[data-role=\"view\"][data-panels=\"true\"]');\n\t\tpanels.each(function(){\n\t\t\tvar id = this.id,\n\t\t\t\tview = X.util.cm.get(id),\n\t\t\t\tpanels = { }, left, right;\n\n\t\t\tif(!view.scroll){\n\t\t\t\tleft = view.body.children('[data-role=\"view\"][data-panels=\"left\"]');\n\t\t\t\tright = view.body.children('[data-role=\"view\"][data-panels=\"right\"]');\n\n\t\t\t\tif(left.length > 0){\n\t\t\t\t\tpanels.left = X.util.cm.get(left.get(0).id);\n\t\t\t\t}\n\n\t\t\t\tif(right.length > 0){\n\t\t\t\t\tpanels.right = X.util.cm.get(right.get(0).id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tview.panelsCreate(panels);\n\t\t});\n\t\t\n\n\t\tvar\tcomps = this.el.find('[data-role]').not('[data-role=\"view\"]');\n\t\tvar charts = [];\n\t\t\n\t\tcomps.each(function(){\n\t\t\tvar el = $(this),\n\t\t\t\tcomp = el.data('role');\n\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val;\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\t\t\t\n\t\t\tconfig.el = el;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tif(comp === 'toolbar'){\n\t\t\t\tel.parents('.ui-view').eq(0).prepend(el);\n\t\t\t\tconfig.title = el.html();\n\t\t\t\tel.empty();\n\t\t\t\tnew X.ui.Toolbar(config);\n\t\t\t}\n\n\t\t\tif(comp === 'tabs'){\n\t\t\t\tvar tabs = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ], titles = [ ];\n\t\t\t\t\n\t\t\t\ttabs.each(function(){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t\ttitles.push(this.dataset.title);\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tconfig.titles = titles;\n\t\t\t\t\n\t\t\t\tnew X.ui.Tabs(config);\n\t\t\t}\n\n\t\t\tif(comp === 'carousel'){\n\t\t\t\tvar views = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ];\n\t\t\t\t\n\t\t\t\tviews.each(function(){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tnew X.ui.Carousel(config);\n\t\t\t}\n\n\t\t\tif(comp === 'listview'){\n\t\t\t\tnew X.ui.ListView(config);\n\t\t\t}\n\n\t\t\tif(comp === 'accordion'){\n\t\t\t\tvar views = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ], titles = [ ];\n\n\t\t\t\tviews.each(function(i){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t\ttitles.push(this.dataset.title);\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tconfig.titles = titles;\n\n\t\t\t\tnew X.ui.Accordion(config);\n\t\t\t}\n\n\t\t\tif(comp === 'textbox'){\n\t\t\t\tnew X.ui.TextBox(config);\n\t\t\t}\n\n\t\t\tif(comp === 'slider'){\n\t\t\t\tnew X.ui.Slider(config);\n\t\t\t}\n\n\t\t\tif(comp === 'progress'){\n\t\t\t\tnew X.ui.Progressbar(config);\n\t\t\t}\n\n\t\t\tif(comp === 'spinner'){\n\t\t\t\tnew X.ui.Spinner(config);\n\t\t\t}\n\n\t\t\tif(comp === 'switchbox'){\n\t\t\t\tnew X.ui.SwitchBox(config);\n\t\t\t}\n\n\t\t\tif(comp === 'checkbox'){\n\t\t\t\tnew X.ui.CheckBox(config);\n\t\t\t}\n\t\t\t\n\t\t\tif(comp === 'radiobox'){\n\t\t\t\tnew X.ui.RadioBox(config);\n\t\t\t}\n\t\t\t\n\t\t\tif(comp === 'selectbox'){\n\t\t\t\tnew X.ui.SelectBox(config);\n\t\t\t}\n\t\t});\n\n\t\tvar\tformView = this.el.find('[data-role=\"formview\"]');\n\t\tformView.each(function(){\n\t\t\tvar el = $(this),\n\t\t\t\titems = [],\n\t\t\t\tselector = '[data-role=\"textbox\"],' +\n\t\t\t\t\t'[data-role=\"slider\"],' +\n\t\t\t\t\t'[data-role=\"spinner\"],' + \n\t\t\t\t\t'[data-role=\"switchbox\"],' +\n\t\t\t\t\t'[data-role=\"progress\"]';\n\t\t\t\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val, panels = { };\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\n\t\t\tel.children(selector).each(function(){\n\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t});\n\n\t\t\tconfig.el = el;\n\t\t\tconfig.items = items;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tnew X.ui.FormView(config);\n\t\t});\n\t}\t\n});\n\nX.util.cm.addCString('view', X.View);\n\n\n\n\n\nX.ui = { };\nX.ui.ListView = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tscrollConfig: {\n\t\t\t\tdirection: 'y'\n\t\t\t}\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.ListView.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.ListView.base.render.call(this);\n\t\tthis.el.addClass('ui-listview');\n\n\t\tthis.ul = this.body.children('.ui-scrollview-view').children('ul');\n\t\tthis.ul.children('li').addClass('ui-listview-item');\n\n\t\tthis.scrollEvent();\n\t},\n\tscrollEvent: function(){\n\t\tthis.scroll.options.onScrollStart = function(){\n\t\t\t\n\t\t};\n\n\t\tthis.scroll.options.onScrollMove = function(){\n\t\t\t\n\t\t};\n\n\t\tthis.scroll.options.onScrollEnd = function(){\n\t\t\t\n\t\t};\n\t},\n\tappend: function(rows){\n\t\tvar type = X.type(row);\n\t\tif(type === 'string'){\n\t\t\trows = $(rows).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trows.addClass('ui-listview-item');\n\t\t}\n\n\t\tthis.ul.append(rows);\n\t\tthis.scrollRefresh();\n\t},\n\tprepend: function(rows){\n\t\tvar type = X.type(rows);\n\t\tif(type === 'string'){\n\t\t\trows = $(rows).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trows.addClass('ui-listview-item');\n\t\t}\n\n\t\tthis.ul.prepend(rows);\n\t\tthis.scrollRefresh();\n\t},\n\treplaceWith: function(index, row){\n\t\tif(X.type(index) !== 'number'){\n\t\t\tthrow new Error('arguments must be number ');\n\t\t}\n\n\t\tvar type = X.type(row);\n\t\tif(type === 'string'){\n\t\t\trow = $(row).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trow.addClass('ui-listview-item');\n\t\t}\n\t\n\t\tthis.ul.children('li:eq(' + index + ')').replaceWith(row);\n\t},\n\tremove: function(index){\n\t\tif(X.type(index) !== 'number'){\n\t\t\tthrow new Error('arguments must be number ');\n\t\t}\n\t\tthis.ul.children('li:eq(' + index + ')').remove();\n\t\tthis.scrollRefresh();\n\t}\n});\n\nX.util.cm.addCString('listview', X.ui.ListView);\n\n\n\nX.ui.Accordion = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\ttitles: [],\n\t\t\titems: [],\n\t\t\tscroll: false,\n\t\t\tactiveIndex: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Accordion.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Accordion.base.render.call(this);\n\t\tthis.el.addClass('ui-accordion');\n\t\t\n\t\tthis.createItems();\n\t\tthis.createTitle();\n\n\t\tviews = this.body.on('vclick', '.ui-accordion-views > .ui-accordion-title', { me: this }, function(e){\n\t\t\tvar me = e.data.me;\n\t\t\t\n\t\t\tvar index = me.body.children('.ui-accordion-views').index($(this).parent());\n\t\t\tme.change(index);\n\t\t\treturn false;\n\t\t});\n\t},\n\tcreateItems: function(){\n\t\tthis.body.children('.ui-view').each(function(){\n\t\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\t\t\t\n\t\t\t$(this).wrap(div);\n\t\t});\n\n\t\tvar items = this.body.children('.ui-accordion-views');\n\t\titems.eq(this.config.activeIndex)\n\t\t\t.removeClass('ui-accordion-close')\n\t\t\t.addClass('ui-accordion-open');\n\t},\n\tcreateTitle: function(){\n\t\tvar views = this.body.children('.ui-accordion-views'),\n\t\t\ttitles = this.config.titles;\n\t\tviews.each(function(i){\n\t\t\tif(titles[i]){\n\t\t\t\tdiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(titles[i]);\n\t\t\t\t\n\t\t\t\t$(this).prepend(div);\n\t\t\t}\n\t\t});\n\n\t\ttitles = null;\t\t\n\t},\n\tchange: function(index){\n\t\tif(this.config.activeIndex === index){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.body.children('.ui-accordion-views')\n\t\t\t.removeClass('ui-accordion-open')\n\t\t\t.addClass('ui-accordion-close')\n\t\t\t.eq(index).addClass('ui-accordion-open')\n\t\t\t.removeClass('ui-accordion-close');\n\t\t\n\t\tthis.config.activeIndex = index;\n\n\t\tthis.fireEvent(this, 'change', [this]);\n\t},\n\tappend: function(comp, title){\n\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(title);\n\n\t\tthis.body.append(div);\n\t\tcomp = X.util.cm.create(div, [comp]);\n\t\tdiv.prepend(titleDiv);\n\n\t\tthis.config.activeIndex = null;\n\n\t\treturn [comp[0], title];\n\t},\n\tprepend: function(comp, title){\n\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(title);\n\n\t\tthis.body.prepend(div);\n\t\tcomp = X.util.cm.create(div, [comp]);\n\t\tdiv.prepend(titleDiv);\n\n\t\tthis.config.activeIndex = null;\n\n\t\treturn [comp[0], title];\n\t},\n\tremove: function(index){\n\t\tthis.body.children('.ui-accordion-views').eq(index).remove();\n\t\tthis.config.items = this.config.items.filter(function(el, i){\n\t\t\treturn (index !== i);\n\t\t});\n\n\t\tthis.config.titles = this.config.titles.filter(function(el, i){\n\t\t\treturn (index !== i);\n\t\t});\n\t\tthis.config.activeIndex = null;\n\t},\n\tremoveAll: function(){\n\t\tthis.body.empty();\n\t\tthis.config.activeIndex = null;\n\t},\n\tchangeTitle: function(title, index){\n\t\tindex = index || 0;\n\t\tvar view = this.body.children('.ui-accordion-views')\n\t\t\t.eq(index);\n\t\t\n\t\tview\n\t\t\t.children('.ui-accordion-title')\n\t\t\t.html(title);\n\t\t\n\t\tthis.config.titles[index] = title;\n\t},\n\tgetItem: function(index){\n\t\treturn this.config.items[index];\n\t}\n});\n\nX.util.cm.addCString('accordion', X.ui.Accordion);\n\n\nX.ui.Toolbar = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tposition: 'top',\n\t\t\ttitle: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.ui.Toolbar.base.initialize.call(this, listener);\n\t\t\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\t\n\t\tif(!X.util.cm.get(this.el.get(0).id)){\n\t\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t}\n\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\t\n\t\tthis.el.addClass('ui-toolbar ' + this.config.position);\n\n\t\tthis.inner = X.util.em.get()\n\t\t\t.addClass('ui-toolbar-inner');\n\n\t\tthis.el.append(this.inner);\n\n\t\tthis.setTitle(this.config.title);\n\t\t\n\t\tvar parent = this.el.parent();\n\t\tif(this.config.position === 'bottom'){\n\t\t\tparent.append(this.el);\n\t\t}\n\t\telse{\n\t\t\tparent.prepend(this.el);\n\t\t}\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tsetTitle: function(title){\n\t\tif(!this.title){\n\t\t\tthis.title = X.util.em.get().\n\t\t\t\taddClass('ui-toolbar-title');\n\n\t\t\tthis.inner.append(this.title);\n\t\t}\n\t\tthis.title.html(title);\n\t},\n\tgetTitle: function(){\n\t\tif(this.title){\n\t\t\treturn this.title.text();\n\t\t}\n\t},\n\tchangeTitle: function(title){\n\t\tthis.title.html(title);\n\t\t\n\t\tthis.fireEvent(this, 'changetitle', [this, title]);\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t}\n});\n\nX.util.cm.addCString('toolbar', X.ui.Toolbar);\n\n\n\nX.ui.Tabs = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tposition: 'top',\n\t\t\tactiveIndex: 0,\n\t\t\ttitles: [],\n\t\t\tautoSize: true,\n\t\t\ttransition: 'slide',\n\t\t\tscroll: false,\n\t\t\titems: []\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Tabs.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Tabs.base.render.call(this);\n\t\tthis.el.addClass('ui-tabs');\n\n\t\tthis.createTabBar();\n\t\t\n\t\tvar activeIndex = this.config.activeIndex;\n\t\t\n\t\tthis.tabBar\n\t\t\t.children('.ui-tabs-bar-items')\n\t\t\t.eq(activeIndex)\n\t\t\t.addClass('ui-tabs-bar-items-active');\n\t\t\n\t\tthis.activeView = this.config.items[activeIndex];\n\t\tfor(var i=0,len=this.config.items.length; i<len; i++){\n\t\t\tif(i === activeIndex){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.config.items[i].hide();\n\t\t}\n\t},\n\tcreateTabBar: function(){\n\t\tthis.tabBar = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar ui-tabs-bar-' + this.config.position);\n\t\t\n\t\tvar items = this.config.items,\n\t\t\tlen = items.length,\n\t\t\to, html = '';\n\n\t\tfor(var i=0; i<len; i++){\n\t\t\thtml += '<div class=\"ui-tabs-bar-items\"><span>' + items[i].config.title + '</span></div>'; \n\t\t}\n\t\tthis.tabBar.html(html);\n\t\t\n\t\tif(this.config.position === 'top'){\n\t\t\tthis.el.prepend(this.tabBar);\n\t\t}\n\t\telse{\n\t\t\tthis.el.append(this.tabBar);\n\t\t}\n\t\t\n\t\tthis.tabBar.on('vclick', '.ui-tabs-bar-items', { me: this }, this._click);\n\t},\n\t_click: function(e){\n\t\tvar me = e.data.me,\n\t\t\tbar = $(this), parent = bar.parent();\n\t\t\n\t\tvar index = parent.find('.ui-tabs-bar-items').index(bar);\n\t\t\n\t\tparent.find('.ui-tabs-bar-items').removeClass('ui-tabs-bar-items-active');\n\t\tbar.addClass('ui-tabs-bar-items-active');\n\t\t\n\t\tme.change(index);\n\t\treturn false;\n\t},\n\tchange: function(index){\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoView = this.config.items[index];\n\t\t\t\n\t\tif(fromView === toView){\n\t\t\treturn;\n\t\t}\t\n\t\n\t\tif(fromView.el.nextAll('#' + toView.getId()).length > 0){\n\t\t\tthis.right(fromView, toView);\n\t\t}\n\t\telse{\n\t\t\tthis.left(fromView, toView);\n\t\t}\n\t},\n\ttransitionStart: function(fromView, toView, transition, reverse){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(fromView, toView, transition, reverse){\n\t\t\tvar viewIn = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttoView.show();\n\t\t\t\ttel.show().addClass(transition + ' in ' + reverse + ' ui-transitioning');\n\t\t\t\ttel.animationComplete(viewOut);\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.addClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t},\n\t\t\tviewOut = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.removeClass(transition + ' in ' + reverse + ' ui-transitioning');\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.removeClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t\t\n\t\t\t\tdone();\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this, [fromView, toView]);\n\n\t\t\t\tfromView = null, toView = null, transition = null, reverse = null;\n\t\t\t};\n\n\t\t\tviewIn();\n\t\t}\n\n\t\ttransitionHandler(fromView, toView, transition, reverse);\n\t\t\n\t\treturn deferred;\n\t},\n\tsetActiveView: function(view){\n\t\tthis.activeView = view;\n\t},\n\tgetActiveView: function(){\n\t\treturn this.activeView;\n\t},\n\tgetActiveViewIndex: function(){\n\t\tvar active = this.getActiveView();\n\t\tfor(var i=0; i<this.config.items.length; i++){\n\t\t\tif(active === this.config.items[i]){\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t},\n\tgetView: function(index){\n\t\treturn this.config.items[index];\n\t},\n\tright: function(fromView, toView){\n\t\tthis.fireEvent(this, 'beforechange', [this, this.getActiveView(), this.getActiveViewIndex(), toView]);\n\n\t\tvar promise = this.transitionStart(fromView, toView, this.config.transition, ''), me = this;\n\t\tpromise.done(function(){\n\t\t\tfromView.hide();\n\t\t\tme.setActiveView(toView);\n\n\t\t\tme.fireEvent(me, 'afterchange', [me.getActiveView(), me.getActiveViewIndex(), fromView]);\n\t\t\tme = null, fromView = null, toView = null;\n\t\t});\n\t},\n\tleft: function(fromView, toView){\n\t\tthis.fireEvent(this, 'beforechange', [this, this.getActiveView(), this.getActiveViewIndex(), toView]);\n\n\t\tvar promise = this.transitionStart(fromView, toView, this.config.transition, 'reverse'), me = this;\n\t\tpromise.done(function(){\n\t\t\tfromView.hide();\n\t\t\tme.setActiveView(toView);\n\n\t\t\tme.fireEvent(me, 'afterchange', [me.getActiveView(), me.getActiveViewIndex(), fromView]);\n\t\t\tme = null, fromView = null, toView = null;\n\t\t});\n\t},\n\tappend: function(comp, title){\n\t\tcomp = X.util.cm.create(this.body, [comp]);\n\t\tthis.config.items.push(comp[0]);\n\t\tcomp[0].hide();\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar-items')\n\t\t\t.html('<span>' + title + '</span>');\n\n\t\tthis.tabBar.append(titleDiv);\n\t\treturn [comp[0], title];\n\t},\n\tprepend: function(comp, title){\n\t\tcomp = X.util.cm.create(this.body, [comp]);\n\t\tthis.config.items = comp.concat(this.config.items);\n\t\tcomp[0].hide();\n\t\tthis.body.prepend(comp[0].el);\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar-items')\n\t\t\t.html('<span>' + title + '</span>');\n\n\t\tthis.tabBar.prepend(titleDiv);\n\t\treturn [comp[0], title];\n\t},\n\tremove: function(index){\n\t\tthis.config.items[index].destroy();\n\t\tthis.config.items.remove(index);\n\n\t\tthis.tabBar.children('.ui-tabs-bar-items').eq(index).remove();\n\t},\n\tdestroy: function(){\n\t\tX.ui.Tabs.base.destroy.call(this);\n\t\tthis.tabBar.remove();\n\t}\n});\nX.util.cm.addCString('tabs', X.ui.Tabs);\n\nX.ui.Carousel = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tdirection: 'x',\n\t\t\tscroll: false\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Carousel.base.initialize.call(this, this.config);\n\t\t\n\t\tthis.current = 0;\n\t\tthis.endPos = 0;\n\t\tthis.dragging = false;\n\t},\n\trender: function(){\n\t\tX.ui.Carousel.base.render.call(this);\n\t\tthis.el.addClass('ui-carousel');\n\n\t\tvar views = this.body.children('.ui-view').addClass('ui-carousel-views');\n\t\tthis.carouselBody = X.util.em.get().addClass('ui-carousel-body');\n\t\t\n\t\tif(views.length > 0){\n\t\t\tviews.wrapAll(this.carouselBody);\n\t\t}\n\t\telse{\n\t\t\tthis.el.append(this.carouselBody);\n\t\t}\n\t\t\n\t\t\n\t\tthis.carouselBody = this.body.children('.ui-carousel-body');\n\t\t\n\t\tif(this.config.direction === 'x'){\n\t\t\tthis.carouselBody.addClass('ui-carousel-horizontal');\n\t\t}\n\t\telse{\n\t\t\tthis.carouselBody.addClass('ui-carousel-vertical');\n\t\t}\n\n\t\tif(this.config.direction === 'y'){\n\t\t\tvar me = this;\n\t\t\tthis.config.items.forEach(function(view){\n\t\t\t\tview.setHeight(me.getHeight());\n\t\t\t});\n\t\t\tme = null;\n\t\t\t\n\t\t\tX.getWindow().on(X.events.orientationchange, { me: this }, this.resize);\n\t\t}\n\t\t\n\t\tthis.carouselBody.bind(X.events.start, {me: this}, this.onStart);\n\t},\n\tresize: function(e){\n\t\tvar me = e.data.me;\n\t\tme.config.items.forEach(function(view){\n\t\t\tview.setHeight(me.getHeight());\n\t\t});\n\t\tme = null;\n\t\treturn false;\n\t},\n\tonStart: function(e){\n\t\tvar me = e.data.me;\n\n\t\tvar pageX = e.originalEvent.touches ? \n\t\t\t\te.originalEvent.touches[0].pageX : e.originalEvent.pageX,\n\t\t\tpageY = e.originalEvent.touches ? \n\t\t\t\te.originalEvent.touches[0].pageY : e.originalEvent.pageY;\n\n\t\tme.startPageX = pageX;\n\t\tme.startPageY = pageY;\n\t\tme.dragging = true;\n\n\t\tme.carouselBody.on(X.events.move, { me: me }, me.onMove);\n\t\tme.carouselBody.on(X.events.end, { me: me }, me.onEnd);\n\t},\n\tonMove: function(e){\n\t\tvar me = e.data.me;\n\t\t\n\t\tif(me.dragging){\n\t\t\tvar pageX = e.originalEvent.touches ? \n\t\t\t\t\te.originalEvent.touches[0].pageX : e.originalEvent.pageX;\n\n\t\t\tvar\tpageY = e.originalEvent.touches ? \n\t\t\t\t\te.originalEvent.touches[0].pageY : e.originalEvent.pageY;\n\n\t\t\tme.carouselBody.get(0).style.webkitTransitionDuration = \"0\";\n\t\t\tif(me.config.direction === 'x'){\n\t\t\t\tme.movePos  = (pageX - me.startPageX) + (-1 * me.current) * me.getWidth();\n\t\t\t\tme.moveLimit = Math.abs(pageX - me.startPageX);\n\n\t\t\t\tme.carouselBody.get(0).style.webkitTransform = 'translate3d(' + me.movePos + 'px, 0px, 0px)';\n\t\t\t\tme.carouselBody.get(0).style.msTransform = 'translateX(' + me.movePos + 'px)';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tme.movePos  = (pageY - me.startPageY) + (-1 * me.current) * me.getHeight();\n\t\t\t\tme.moveLimit = Math.abs(pageY - me.startPageY);\n\n\t\t\t\tme.carouselBody.get(0).style.webkitTransform = 'translate3d(0px, ' + me.movePos + 'px, 0px)';\n\t\t\t\tme.carouselBody.get(0).style.msTransform = 'translateY(' + me.movePos + 'px)';\t\t\n\t\t\t}\n\n\t\t\tconsole.log(me.moveLimit);\n\t\t}\n\t\t\n\t\treturn false;\n\t},\n\tonEnd: function(e){\n\t\tvar me = e.data.me, \n\t\t\tendPos = 0,\n\t\t\tstyle = me.carouselBody.get(0).style;\n\n\t\tif(me.moveLimit > 30){\n\t\t\tif(me.movePos > 0){\n\t\t\t\tme.current = 0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(Math.abs(me.movePos) > Math.abs(me.endPos)){\n\t\t\t\t\tme.current++;\n\t\t\t\t\tif(me.current >= (me.config.items.length - 1)){\n\t\t\t\t\t\tme.current = me.config.items.length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tme.current--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(me.current === 0){\n\t\t\t\tendPos = 0;\n\t\t\t}\n\t\t\telse if(me.current > 0){\n\t\t\t\tif(me.config.direction === 'x'){\n\t\t\t\t\tendPos = (me.getWidth() * me.current) * -1;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tendPos = (me.getHeight() * me.current) * -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tme.endPos = endPos;\n\t\t}\n\t\telse{\n\t\t\tendPos = me.endPos;\t\n\t\t}\n\t\t\n\t\tstyle.webkitTransitionDuration = '200ms';\n\t\tif(me.config.direction === 'x'){\n\t\t\tstyle.webkitTransform = 'translate3d(' + endPos + 'px, 0px, 0px)';\n\t\t}\n\t\telse{\n\t\t\tstyle.webkitTransform = 'translate3d(0px, ' + endPos + 'px, 0px)';\n\t\t}\n\n\t\tme.fireEvent(me, 'change', [me, me.current, me.getActive()]);\n\n\t\tme.carouselBody.off(X.events.move);\n\t\tme.carouselBody.off(X.events.end);\n\n\t\tme.dragging = false;\n\t},\n\tgetActive: function(){\n\t\treturn this.config.items[this.current];\n\t},\n\tappend: function(comp){\n\t\tvar comps = X.util.cm.create(this.carouselBody, [comp]);\n\t\tthis.config.items.push(comps[0]);\n\t\tcomps[0].addClass('ui-carousel-views');\n\t\t\n\t\treturn comps[0];\n\t},\n\tremove: function(index){\n\t\tthis.config.items[index].destroy();\n\t\tthis.config.items.remove(index);\n\t},\n\tdestroy: function(){\n\t\tX.ui.Carousel.base.destroy.call(this);\n\t\tX.getWindow().off(X.events.orientationchange, { me: this }, this.resize);\n\t}\n});\n\nX.util.cm.addCString('carousel', X.ui.Carousel);\n\n\nX.ui.FormView = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\t\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.FormView.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.FormView.base.render.call(this);\n\t},\n\tserialize: function(){\n\t\treturn $.param(this.getJSON());\n\t},\n\tgetJSON: function(){\n\t\tvar params = { },\n\t\t\titems = this.config.items,\n\t\t\tlen = items.length;\n\t\t\n\t\tfor(var i=0; i<len; i++){\n\t\t\tparams[items[i].getName()] = items[i].getValue();\n\t\t}\n\n\t\treturn params;\n\t}\n});\n\n\nX.ui.Form = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tplaceholder: 'please..',\n\t\t\trequired: false,\n\t\t\tdisabled: false,\n\t\t\tdefaultValue: null,\n\t\t\tlabel: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\t\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.ui.Form.base.initialize.call(this, listener);\n\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\t\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\t\n\t\tif(!X.util.cm.get(this.el.get(0).id)){\n\t\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t}\n\t\t\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\tthis.el.addClass('ui-form-box');\n\t\t\n\t\tif(this.config.label){\n\t\t\tthis.labelCreate();\n\t\t}\n\t\t\n\t\tif(this.config.style){\n\t\t\tthis.el.css(this.config.style);\n\t\t}\n\t\t\n\t\tthis.formcontin = X.util.em.get()\n\t\t\t.addClass('ui-form-container');\n\t\t\n\t\tthis.el.append(this.formcontin);\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t},\n\tgetName: function(){\n\t\treturn this.config.name || this.el.get(0).id;\n\t},\n\tsetValue: function(val){\n\t\tif (this.form.attr('disabled')) {\n\t\t\treturn;\n\t\t}\n\t\tthis.form.val(val);\n\t\tthis.fireEvent(this, 'setvalue', [this, val]);\n\t},\n\tgetValue: function(){\n\t\treturn this.form.val();\n\t},\n\tlabelCreate: function(){\n\t\tthis.formlabel = X.util.em.get()\n\t\t\t.addClass('ui-form-label').html(this.config.label);\n\t\t\n\t\tthis.el.append(this.formlabel);\n\t},\n\tshow: function(){\n\t\tthis.el.show();\n\t\tthis.fireEvent(this, 'show', [this]);\n\t},\n\thide: function(){\n\t\tthis.el.hide();\n\t\tthis.fireEvent(this, 'hide', [this]);\n\t},\n\ttoggle: function(){\n\t\tif(this.el.css('display') !== 'none'){\n\t\t\tthis.hide();\n\t\t}\n\t\telse{\n\t\t\tthis.show();\n\t\t}\n\t},\n\tgetEl: function(){\n\t\treturn this.el;\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.form.attr('disabled', true);\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.form.attr('disabled', false);\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t}\n});\n\nX.ui.TextBox = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\ttype: 'text'\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.TextBox.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.TextBox.base.render.call(this);\n\n\t\tthis.el.addClass('ui-textbox');\n\t\tthis.formCreate();\n\t\t\n\t\tthis.form.bind('focus keypress blur keydown keyup', {me: this}, this.setEvt);\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', []);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: this.config.type,\n\t\t\t'class': 'ui-text-input',\n\t\t\tplaceholder: this.config.placeholder,\n\t\t\tdisabled: this.config.disabled,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsetType: function(type){\n\t\tthis.form.prop('type', type);\n\t},\n\tsetPlaceholder: function(placeholder){\n\t\tthis.config.placeholder = placeholder;\n\t\tthis.form.attr('placeholder', placeholder);\n\t},\n\tsetEvt: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = me.getValue(),\n\t\t\ttype =  e.type;\n\n\t\tme.fireEvent(me, type, [val]);\n\t}\n});\n\nX.util.cm.addCString('textbox', X.ui.TextBox);\n\nX.ui.Slider = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmin: 0,\n\t\t\tmax: 100,\n\t\t\tstep: 1,\n\t\t\tdefaultValue: 50,\n\t\t\tdirection: 'x',\n\t\t\tstyle: { },\n\t\t\tsubhandle: false\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Slider.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Slider.base.render.call(this);\n\t\t\n\t\tthis.el.addClass('ui-slider ui-slider-' + this.config.direction);\n\t\tthis.formCreate();\n\t\tthis.handleCreate();\n\t\tthis.subHandleCreate();\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t\t\n\t\tthis.dragging = false;\n\t\tthis.handle.bind( X.events.start, {me: this}, function(e){\n\t\t\tvar me = e.data.me,\n\t\t\t\tel = me.el;\n\t\t\t\n\t\t\tif(el.hasClass('ui-disabled')){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tme.dragging = true;\n\t\t\tme.subdragging = false;\n\n\t\t\tX.getDoc().on(X.events.move, {me: me}, me.move);\n\t\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\t\treturn false;\n\t\t});\n\n\t\t\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.bind( X.events.start, {me: this}, function(e){\n\t\t\t\tvar me = e.data.me,\n\t\t\t\t\tel = me.el;\n\t\t\t\t\n\t\t\t\tif(el.hasClass('ui-disabled')){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tme.dragging = true;\n\t\t\t\tme.subdragging = true;\n\n\t\t\t\tX.getDoc().on(X.events.move, {me: me}, me.move);\n\t\t\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\n\t\tthis.setValue(this.config.defaultValue);\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tmove: function(e){\n\t\tvar me = e.data.me;\n\t\tif ( me.dragging ) {\n\t\t\tme.setValue( e );\n\t\t\treturn false;\n\t\t}\n\t},\n\tend: function(e){\n\t\tvar me = e.data.me;\n\t\tif ( me.dragging ) {\n\t\t\tme.dragging = false;\n\t\t\tvar val = me.getValue();\n\t\t\tme.fireEvent(me, 'change', [val]);\n\t\t\treturn false;\n\t\t}\n\n\t\tX.getDoc().off(X.events.move, {me: me}, me.move);\n\t\tX.getDoc().off(X.events.end, {me: me}, me.end);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'range',\n\t\t\t'class': 'ui-slider-input',\n\t\t\trequired: this.config.required,\n\t\t\tplaceholder: this.config.placeholder,\n\t\t\tmin: this.config.min,\n\t\t\tmax: this.config.max,\n\t\t\tstep: this.config.step,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsubHandleCreate: function(){\n\t\tif(this.config.subhandle){\n\t\t\tthis.subhandle = X.util.em.get().addClass('ui-slider-subhandle');\n\t\t\tthis.formcontin.append(this.subhandle);\n\t\t\t\n\t\t\tif(X.type(this.config.range) === 'object'){\n\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.subhandle.addClass('ui-slider-subhandle');\n\t\t\t}\n\t\t}\n\t},\n\thandleCreate: function(val){\n\t\tthis.handle = X.util.em.get(false, false, 'a').addClass('ui-slider-handle');\n\t\tthis.formcontin.append(this.handle);\n\n\t\tif(X.type(this.config.range) === 'object'){\n\t\t\tthis.subhandle = X.util.em.get(false, false, 'a').addClass('ui-slider-handle ui-slider-subhandle');\n\t\t\tthis.formcontin.append(this.subhandle);\n\t\t}\n\t},\n\tsetValue: function(val){\n\t\tvar percent,\n\t\t\tmin = this.getMin(),\n\t\t\tmax = this.getMax();\t\n\t\t\t\n\t\tif (X.type(val) === 'object') {\n\t\t\tvar e = val,\n\t\t\t\ttol = 8;\n\n\t\t\tif(this.config.direction === 'x'){\n\t\t\t\tvar w = this.formcontin.width(),\n\t\t\t\t\tl = this.formcontin.offset().left,\n\t\t\t\t\tx = e.originalEvent.pageX;\n\t\t\t\t\n\t\t\t\tif ( !this.dragging || x < l - tol || x > l + w + tol ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpercent = Math.round(((x - l) / w ) * 100 );\n\t\t\t}\n\t\t\tif(this.config.direction === 'y'){\n\t\t\t\tvar h = this.formcontin.height(),\n\t\t\t\t\tt = this.formcontin.offset().top,\n\t\t\t\t\ty = e.originalEvent.pageY;\n\t\t\t\t\t\n\t\t\t\tif ( !this.dragging || y < t - tol || y > t + h + tol ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpercent = Math.round(((y - t) / h ) * 100);\n\t\t\t}\n\t\t}\n\n\t\tif(X.type(val) === 'number'){\n\t\t\tpercent = this.percentValue(val);\n\t\t}\n\t\t\n\t\tvar newval = Math.round( (percent / 100) * (max - min) ) + min;\n\t\tnewval = this.trimValue(newval);\n\n\t\tpercent = this.percentValue(newval);\n\n\t\tif(this.subdragging){\n\t\t\tvar data = this.handle.data('data');\n\n\t\t\tif(data){\n\t\t\t\tdata = parseInt(data);\n\t\t\t\tif(newval < data){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(!this.subdragging && this.subhandle){\n\t\t\tvar data = this.subhandle.data('data');\n\t\t\tif(data){\n\t\t\t\tdata = parseInt(data);\n\t\t\t\tif(newval > data)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar subPercent = (this.config.subhandle - min) / (max - min) * 100;\n\t\t\t\tvar subNewVal = Math.round( (subPercent / 100) * (max - min) ) + min;\n\t\t\t\t\n\n\t\t\t\tif(this.config.direction === 'x'){\n\t\t\t\t\tthis.subhandle.css(\"left\", subPercent + \"%\").data('data', subNewVal);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.subhandle.css(\"top\", subPercent + \"%\").data('data', subNewVal);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(this.config.direction === 'x'){\n\t\t\tif(this.subdragging){\n\t\t\t\tthis.subhandle.css(\"left\", percent + \"%\").data('data', newval);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.handle.css(\"left\", percent + \"%\").data('data', newval);\n\t\t\t}\n\t\t}\n\n\t\tif(this.config.direction === 'y'){\n\t\t\tif(this.subdragging){\n\t\t\t\tthis.subhandle.css(\"top\", (percent) + \"%\").data('data', newval);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.handle.css(\"top\", (percent) + \"%\").data('data', newval);\n\t\t\t}\n\t\t}\n\n\t\tthis.change(percent, newval);\n\t},\n\ttrimValue: function(val){\n\t\tvar min = this.getMin(),\n\t\t\tmax = this.getMax();\n\n\t\tif ( val <= min ) {\n\t\t\treturn min;\n\t\t}\n\t\tif ( val >= max ) {\n\t\t\treturn max;\n\t\t}\n\t\tvar step = ( this.config.step > 0 ) ? this.config.step : 1,\n\t\t\tstepVal = (val - min) % step,\n\t\t\talignValue = val - stepVal;\n\n\t\tif ( Math.abs(stepVal) * 2 >= step ) {\n\t\t\talignValue += ( stepVal > 0 ) ? step : ( -step );\n\t\t}\n\n\t\treturn parseFloat(alignValue.toFixed(5));\n\t},\n\tpercentValue: function(val){\n\t\tvar min = this.getMin(),\n\t\t\tmax = this.getMax();\n\n\t\tpercent = (parseFloat(val) - min) / (max - min) * 100;\n\t\t\n\t\tif(isNaN(percent)){\n\t\t\treturn 0;\n\t\t}\n\t\tif (percent < 0) { \n\t\t\tpercent = 0; \n\t\t}\n\t\tif (percent > 100) { \n\t\t\tpercent = 100; \n\t\t}\n\n\t\treturn percent;\n\t},\n\tchange: function(p, v){\n\t\tthis.fireEvent(this, 'change', [this, p, v]);\n\t},\n\t//override\n\tgetValue: function(){\n\t\tif(this.subhandle){\n\t\t\treturn [this.handle.data('data'), this.subhandle.data('data')];\n\t\t}\n\t\telse{\n\t\t\treturn this.handle.data('data');\n\t\t}\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.handle.addClass('ui-disabled');\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.addClass('ui-disabled');\n\t\t}\n\t\tthis.form.attr('disabled', true);\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.handle.removeClass('ui-disabled');\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.removeClass('ui-disabled');\n\t\t}\n\t\tthis.form.attr('disabled', false);\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t},\n\tsetMin: function(min){\n\t\tthis.config.min = min;\n\t},\n\tsetMax: function(max){\n\t\tthis.config.max = max;\n\t},\n\tgetMin: function(){\n\t\treturn this.config.min;\n\t},\n\tgetMax: function(){\n\t\treturn this.config.max;\n\t}\n});\n\nX.util.cm.addCString('slider', X.ui.Slider);\n\nX.ui.Progressbar = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmax: 100,\n\t\t\tdefaultValue: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Progressbar.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Progressbar.base.render.call(this);\n\t\t\n\t\tthis.el.addClass('ui-progressbar');\n\t\n\t\tthis.formCreate();\n\t\t\n\t\tthis.setValue(this.config.defaultValue);\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'progress',\n\t\t\t'class': 'ui-progress',\n\t\t\tmax: this.config.max,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\t\n\t\tthis.gauge = X.util.em.get().addClass('ui-progress-gauge');\n\t\tthis.bar = X.util.em.get().addClass('ui-progress-bar');\n\t\tthis.formcontin.append(this.gauge, this.bar);\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsetValue: function(val){\n\t\tif (this.el.hasClass('ui-disabled')) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar w = this.el.width(),\n\t\t\tpercent = (w / this.config.max) * val;\n\n\t\tif(isNaN(percent)){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(percent > w){\n\t\t\tpercent = w;\n\t\t}\t\t\n\t\t\n\t\tif(val < 0){\n\t\t\tval = 0;\n\t\t}\n\t\t\n\t\tif(val > this.config.max){\n\t\t\tval = this.config.max;\n\t\t}\n\t\tthis.form.val(val);\n\t\t\n\t\tthis.gauge.width(percent);\n\t\tthis.fireEvent(this, 'update', [this, val]);\n\t},\n\tsetMax: function(max){\n\t\tthis.config.max = max;\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t}\n});\n\nX.util.cm.addCString('progressbar', X.ui.Progressbar);\n\n\nX.ui.Spinner = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmin: 0,\n\t\t\tmax: 100,\n\t\t\tstep: 1,\n\t\t\tdefaultValue: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Spinner.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Spinner.base.render.call(this);\n\t\tthis.el.addClass('ui-spinner').width(this.config.width);\n\t\t\n\t\tthis.formCreate();\n\t\tthis.handleCreate();\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', []);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'number',\n\t\t\tmin: this.config.min,\n\t\t\tmax: this.config.max,\n\t\t\tvalue: this.config.defaultValue,\n\t\t\tstep: this.config.step\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t\t\n\t\tthis.form.bind('change', { me: this }, this._change);\n\t},\n\t_change: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tif(val < me.config.min){\n\t\t\tval = me.config.min\n\t\t\tme.form.val(val);\n\t\t}\n\t\telse if(val > me.config.max){\n\t\t\tval = me.config.max;\n\t\t\tme.form.val(val);\n\t\t}\n\t\t\n\t\tme.fireEvent(me, 'change', [me,  val]);\n\t},\n\thandleCreate: function(){\n\t\tvar plus = X.util.em.get()\n\t\t\t.html('+').addClass('ui-spinner-btn ui-spinner-plus');\n\n\t\tthis.formcontin.append(plus);\n\t\t\n\t\t\n\t\tvar minus = X.util.em.get()\n\t\t\t.html('-').addClass('ui-spinner-btn ui-spinner-minus');\n\n\t\tthis.formcontin.append(minus);\n\t\t\n\t\tplus.bind(X.events.start, { me: this }, this.plus);\n\t\tminus.bind(X.events.start, { me: this }, this.minus);\n\t},\n\tend: function(e){\n\t\tvar me = e.data.me;\n\t\tme.clearTimer();\n\t\t\n\t\treturn false;\n\t},\n\tclearTimer: function(){\n\t\tif(this.interval){\n\t\t\twindow.clearInterval(this.interval);\n\t\t\tthis.interval = null;\n\t\t}\n\n\t\tX.getDoc().off(X.events.end, {me: this}, this.end);\n\t},\n\ttimer: function(e, flag){\n\t\tif(!this.interval){\n\t\t\tvar me = this;\n\t\t\tthis.interval = window.setInterval(function(){\n\t\t\t\tme[flag](e);\n\t\t\t}, 100);\n\t\t}\n\t},\n\tplus: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tvar result = val + me.config.step;\n\t\t\n\t\tif(result > me.config.max){\n\t\t\tresult = me.config.max;\n\t\t}\n\t\t\n\t\tresult = parseFloat(result.toFixed(1), 10);\n\t\tme.form.val(result);\n\n\t\tme.timer(e, 'plus');\n\t\t\n\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\treturn false;\n\t},\n\tminus: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tvar result = val - me.config.step;\n\t\t\n\t\tif(result < me.config.min){\n\t\t\tresult = me.config.min;\n\t\t}\n\t\t\n\t\tresult = parseFloat(result.toFixed(1), 10);\n\t\tme.form.val(result);\n\t\t\n\t\tme.timer(e, 'minus');\n\n\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\treturn false;\n\t},\n\tsetValue: function(val){\n\t\tif (this.el.hasClass('ui-disabled')) {\n\t\t\treturn;\n\t\t}\n\t\tif(!val){\n\t\t\tval = 0;\n\t\t}\n\n\t\tif(val < this.config.min){\n\t\t\tval = this.config.min;\n\t\t}\n\t\tif(val > this.config.max){\n\t\t\tval = this.config.max;\n\t\t}\n\t\t\n\t\tthis.form.val(val);\n\t\t\n\t\tthis.fireEvent(this, 'change', [this,  val]);\n\t},\n\tsetMax: function(max){\n\t\tif(X.type(max) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.max = max;\n\t\tthis.form.attr('max', max);\n\t},\n\tsetMin: function(min){\n\t\tif(X.type(min) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.min = min;\n\t\tthis.form.attr('min', min);\n\t},\n\tgetMax: function(){\n\t\treturn this.config.max;\n\t},\n\tgetMin: function(){\n\t\treturn this.config.min;\n\t},\n\tsetStep: function(step){\n\t\tif(X.type(step) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.step = step;\n\t\tthis.form.attr('step', step);\n\t}\n});\n\nX.util.cm.addCString('spinner', X.ui.Spinner);\n\n\nX.ui.SwitchBox = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tchecked: false,\n\t\t\ton: 'ON',\n\t\t\toff: 'OFF'\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.SwitchBox.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.SwitchBox.base.render.call(this);\n\t\tthis.el.addClass('ui-switchbox').width(this.config.width);\n\t\tthis.formCreate();\n\n\t\tthis.handle = X.util.em.get().addClass('ui-switchbox-handle');\n\t\tthis.text = X.util.em.get({tag: 'span'}).addClass('ui-switchbox-text');\n\t\t\n\n\t\tthis.formcontin.append(this.text)\n\t\t\t.append(this.handle);\n\t\t\n\t\tthis.el.bind('vclick', { me: this }, this._change);\n\n\t\tif(this.config.checked){\n\t\t\tthis.el.addClass('on');\n\t\t}\n\t\telse{\n\t\t\tthis.el.addClass('off');\n\t\t}\n\n\t\tthis.setText();\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'checkbox',\n\t\t\tchecked: this.config.checked\n\t\t}).hide();\n\t\tthis.formcontin.append(this.form);\n\t},\n\t_change: function(e){\n\t\tvar me = e.data.me,\n\t\t\tel = me.el;\n\n\t\tif(me.el.hasClass('on')){\n\t\t\tme.unchecked();\n\t\t}\n\t\telse{\n\t\t\tme.checked();\n\t\t}\n\t},\n\tsetOn: function(on){\n\t\tthis.config.on = on;\n\t},\n\tsetOff: function(off){\n\t\tthis.config.off = off;\n\t},\n\tsetText: function(){\n\t\tvar text;\n\t\tif(this.el.hasClass('on')){\n\t\t\ttext = this.config.on;\n\t\t}\n\t\telse{\n\t\t\ttext = this.config.off;\n\t\t}\n\n\t\tthis.text.html(text);\n\t},\n\ttoggle: function(){\n\t\tif(this.el.hasClass('on')){\n\t\t\tthis.unchecked();\n\t\t}\n\t\telse{\n\t\t\tthis.checked();\n\t\t}\n\t},\n\tchecked: function(){\n\t\tif(this.el.hasClass('ui-disabled')){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.el.removeClass('off').addClass('on');\n\t\t\n\t\tthis.setText();\n\t\tthis.form.attr('checked', true);\n\n\t\tthis.fireEvent(this, 'change', [this, true]);\n\t},\n\tunchecked: function(){\n\t\tif(this.el.hasClass('ui-disabled')){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.el.removeClass('on').addClass('off');\n\t\t\n\t\tthis.setText();\n\t\tthis.form.attr('checked', false);\n\t\tthis.fireEvent(this, 'change', [this, false]);\n\t},\n\tgetValue: function(){\n\t\treturn this.form.is(':checked');\n\t}\n});\n\nX.util.cm.addCString('switchbox', X.ui.SwitchBox);\n\n(function(){\n\t\n\tvar head = $('head');\n\tfunction SetMeta(name, content){\n\t\tvar meta = $('<meta />');\n\t\tmeta.attr('name', name);\n\t\tmeta.attr('content', content);\n\t\t\n\t\thead.eq(0).append(meta);\n\t}\n\t\n\t\n\t// Non-Retina iPhone, iPod touch, and Android devices\n\t//57\n\t// Non-Retina iPad\n\t//72\n\t// Retina iPhone and iPod touch\n\t//114\n\t// Retina iPad\n\t//144\n\t\n\tfunction SetLink(rel, icon, size){\n\t\tvar link = $('<link />');\n\t\tlink.attr('rel', rel);\n\t\tlink.attr('href', icon);\n\t\t\n\t\tif (size) {\n\t\t\tlink.setAttribute('sizes', size + 'x' + size);\n\t\t}\n\t\thead.eq(0).append(link);\n\t}\t\n\t\n\tX.App = function(config){\n\t\tvar default_config = {\n\t\t\tname: 'Application',\n\t\t\ticon: null,\n\t\t\ticonsize: null,\n\t\t\tsplash: null,\n\t\t\tviewport: true,\n\t\t\tfullscreen: true,\n\t\t\tstatusbar: null,\n\t\t\tready: null,\n\t\t\tinitialScale: 1,\n\t\t\tmaximumScale: 1,\n\t\t\tminimumScale: 1,\n\t\t\tuserScalable: 'no'\n\t\t};\n\t\tconfig = X.apply(default_config, config);\n\n\t\tif(config.viewport){\n\t\t\tSetMeta('viewport', 'initial-scale=' + default_config.initialScale + \n\t\t\t\t\t', maximum-scale=' + default_config.maximumScale + \n\t\t\t\t\t', minimum-scale=' + default_config.minimumScale + \n\t\t\t\t\t', user-scalable=' + default_config.userScalable);\n\t\t}\n\t\tif(config.fullscreen){\n\t\t\tSetMeta('apple-mobile-web-app-capable', 'yes');\n\t\t\tSetMeta('apple-touch-fullscreen', 'yes');\n\t\t}\n\t\t\n\t\tif(config.statusbar){\n\t\t\tSetMeta('apple-mobile-web-app-status-bar-style', config.statusbar);\n\t\t}\n\t\t\n\t\tif(config.splash){\n\t\t\tSetLink('apple-touch-startup-image', config.splash);\n\t\t}\n\t\t\n\t\tif(config.icon){\n\t\t\tSetLink('apple-touch-icon', config.icon, config.iconsize);\n\t\t}\n\t\t\n\t\t\n\t\tif(config.id){\n\t\t\tconfig.id = config.id + config.name;\n\t\t}\n\n\t\tX.getDoc().ready(function(){\n\t\t\tvar default_config = {\n\t\t\t\tid: config.id,\n\t\t\t\tel: 'body',\n\t\t\t\tautoSize: true,\n\t\t\t\tautoRender: true,\n\t\t\t\tscroll: false\n\t\t\t};\n\t\t\t\n\t\t\tdefault_config = X.apply(default_config, config.viewConfig);\n\t\n\t\t\t\n\t\t\tX.App.View = new X.View(default_config);\n\n\t\t\tX.getDoc().on('vclick', 'a', { view: X.App.View }, function(e){\n\t\t\t\tvar el = $(this),\n\t\t\t\t\thref = el.attr('href'),\n\t\t\t\t\ttransition = el.data('transition') || 'slide',\n\t\t\t\t\thistory = el.data('history') === false ? false : true,\n\t\t\t\t\tback = el.data('back'),\n\t\t\t\t\trel = el.attr('rel'),\n\t\t\t\t\tparents, vc;\n\t\t\t\t\n\t\t\t\tif(!href){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(rel === \"external\"){\n\t\t\t\t\tif(!X.platform.isDesktop){\n\t\t\t\t\t\tvar href = el.attr(\"href\");\n\t\t\t\t\t\thref = href.replace(\"emulIndex\", \"mssIndex\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tel.attr(\"href\", href);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(href.match(/^tel\\:/)){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tparents = el.parents('.ui-view');\n\t\t\t\tparents.each(function(){\n\t\t\t\t\tvar id = this.id;\n\t\t\t\t\tvar view = X.util.cm.get(id);\n\t\t\t\t\tvc = view.getViewController();\n\t\t\t\t\tif(vc){\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(!vc){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(back && href === '#'){\n\t\t\t\t\tvc.backPage();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(href !== '#' && back){\n\t\t\t\t\tvc.prevPage({ url: href });\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\n\t\t\t\tif(href === '#' || !href){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvc.nextPage({\n\t\t\t\t\turl: href,\n\t\t\t\t\ttransition: transition,\n\t\t\t\t\thistory: history\n\t\t\t\t});\n\t\n\t\t\t\treturn false;\n\t\t\t});\n\n\n\t\t\tif(config.ready){\n\t\t\t\tconfig.ready(X.App.View);\n\t\t\t}\n\n\t\t\tconfig = null;\n\n\t\t\tX.getDoc().bind('orientationchange', function(e){\n\t\t\t\treturn false;\n\t\t\t});\n\t\t});\n\t};\n\t\n\tX.getApp = function(){\n\t\tif(X.App.View){\n\t\t\treturn X.App.View;\n\t\t}\n\t\treturn null;\n\t};\n})();"]],"start1":0,"start2":0,"length1":0,"length2":72788}]],"length":72788}
{"contributors":[],"silentsave":false,"ts":1382330411590,"patch":[[{"diffs":[[-1,"/*\n * \n * http://\n *\n * Copyright 2011, Young Nam, Heo \n * Dual licensed under the GPL Version 1 licenses.\n *\n */\n\n\n/*\n\tNamespace Create\n*/\nX = {\n    version : '1.1.0.0'\n};\n\n/*\n\tX Common\n*/\n(function(){\n\n\tvar win = $(window), \n\t\tdoc = $(document),\n\t\tbody;\n\n\tX.apply = $.extend;\n\tX.apply(X, {\n\t\temptyFn: $.noop,\n\t\tformat: function(str){\n\t\t\tvar args = arguments, len = args.length;\n\t\t\tvar reg;\n\t\t\tfor(var i=0; i<len; i++){\n\t\t\t\treg = new RegExp('\\\\{'+i+'\\\\}', 'g');\n\t\t\t\tstr = str.replace(reg, args[i+1]);\n\t\t\t}\n\t\t\treturn str;\n\t\t},\n\t\textend: function(sp, proto){\n\t\t\tvar sb = function(){\n\t\t\t\tvar args = $.makeArray(arguments);\n\t\t\t\tthis.initialize.apply(this, args);\n\t\t\t};\n\n\t\t\tvar F = function(){ },\n\t\t\t\tspp = sp.prototype;\n\t\t\t\n\t\t\tF.prototype = spp;\n\t\t\tif(!spp.initialize){\n\t\t\t\tspp.initialize = X.emptyFn;\n\t\t\t}\n\t\t\tsb.prototype = new F();\n\t\t\tsb.prototype.constructor = sb;\n\t\t\tsb.base = spp;\n\n\t\t\tif (proto){\n\t\t\t\tX.apply(sb.prototype, proto);\n\t\t\t}\n\t\t\t\n\t\t\tsb.extend = function(proto){\n\t\t\t\tvar sp = this;\n\t\t\t\treturn X.extend(sp, proto);\n\t\t\t};\n\n\t\t\treturn sb;\n\t\t},\n\t\ttype: function(o){\n\t\t\tvar t = $.type(o);\n\t\t\tif(t === 'object'){\n\t\t\t\tif(o.innerHTML){\n\t\t\t\t\tt = 'dom';\n\t\t\t\t}\n\t\t\t\telse if(o.jquery){\n\t\t\t\t\tt = 'jquery';\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn t;\n\t\t},\n\t\tgetOrientation: function(){\n\t\t\tvar ori = window.orientation;\n\t\t\tif(ori === 0){\n\t\t\t\treturn 'portrait';\n\t\t\t}\n\t\t\telse if(ori === 90){\n\t\t\t\treturn 'landscape';\n\t\t\t}\n\t\t\telse if(ori === -90){\n\t\t\t\treturn 'landscape';\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn 'portrait';\n\t\t\t}\n\t\t},\n\t\tgetBody: function(flag){\n\t\t\tif(!body){\n\t\t\t\tbody = $('body');\n\t\t\t}\n\t\t\treturn flag === true ? document.body : body;\n\t\t},\n\t\tgetDoc: function(flag){\n\t\t\treturn flag === true ? document : doc;\n\t\t},\n\t\tgetWindow: function(flag){\n\t\t\treturn flag === true ? window : win;\n\t\t},\n\t\tgetWindowSize: function(){\n\t\t\tvar win = this.getWindow();\n\t\t\treturn {\n\t\t\t\twidth: win.width(),\n\t\t\t\theight: win.height()\n\t\t\t};\n\t\t}\n\t});\n\n\t//animation complete callback\n\t$.fn.animationComplete = function( callback, data ){\n\t\tif('WebKitTransitionEvent' in window){\n\t\t\treturn $(this).one('webkitAnimationEnd', data, callback);\n\t\t}\n\t\telse{\n\t\t\t// defer execution for consistency between webkit/non webkit\n\t\t\tsetTimeout(callback, 0);\n\t\t\treturn $(this);\n\t\t}\n\t};\n\n\t\n\n\tX.platform = (function(){\n\t\tvar userAgent = navigator.userAgent.toLowerCase();\n\t\tvar platform = navigator.platform;\n\n\t\tvar iPhone = /iPhone/i.test(platform),\n\t\t\tiPad = /iPad/i.test(platform),\n\t\t\tiPod = /iPod/i.test(platform);\n\n\t\tvar win = /win/i.test(platform),\n\t\t\tmac = /mac/i.test(platform),\n\t\t\tlinux = /linux/i.test(platform),\n\t\t\tiOs = iPhone || iPad || iPod;\n\n\t\tvar android = /android/i.test(userAgent),\n\t\t\tandroidVersion = parseFloat(userAgent.slice(userAgent.indexOf(\"android\")+8));\n\n\t\treturn {\n\t\t\tisIos: iOs,\n\t\t\tisWindows: win,\n\t\t\tisMac: mac,\n\t\t\tisLinux: linux,\n\t\t\tisDesktop: win || (!android && linux) || mac,\n\t\t\tiPod: iPod,\n\t\t\tiPhone: iPhone,\n\t\t\tiPad: iPad,\n\t\t\tandroid: android,\n\t\t\tandroidVersion: androidVersion,\n\t\t\thasTouch: ('ontouchstart' in window)\n\t\t};\n\t})();\n\n\tX.events = (function(){\n\t\tvar hasTouch = X.platform.hasTouch ? true : false;\n\t\treturn {\n\t\t\tstart: hasTouch ? 'touchstart' : 'vmousedown',\n\t\t\tmove: hasTouch ? 'touchmove' : 'vmousemove',\n\t\t\tend: hasTouch ? 'touchend' : 'vmouseup',\n\t\t\torientationchange: hasTouch ? 'orientationchange' : 'resize'\n\t\t};\n\t})();\n})();\n\n\nX.apply(Array.prototype, {\n\tremove: function(from, to){\n\t\tvar rest = this.slice((to || from) + 1 || this.length);\n\t\tthis.length = from < 0 ? this.length + from : from;\n\t\treturn this.push.apply(this, rest);\n\t}\n});\n\n\nX.util = { };\nX.util.Observer = X.extend(X.emptyFn, {\n\tinitialize: function(listener){\n\t\tthis.eventTypes = this.eventTypes || {};\n\t\tfor (var attr in listener) {\n\t\t\tthis.eventTypes[attr] = listener[attr];\n\t\t}\n\t},\n\taddEvent: function(){\n\t\tvar a = arguments,\n\t\t\ti = a.length;\n\n\t\twhile(i--) {\n\t\t\tfor (var attr in a[i]){\n\t\t\t\tif(this.eventTypes[attr]){\n\t\t\t\t\tif(X.type(this.eventTypes[attr]) === 'array'){\n\t\t\t\t\t\tthis.eventTypes[attr].push(a[i][attr]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.eventTypes[attr] = [this.eventTypes[attr], a[i][attr]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.eventTypes[attr] = a[i][attr];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tfireEvent: function(o, type, args){\n\t\tvar params = o.config ? o.config.params || [] : [];\n\t\t\n\t\tif (this.eventTypes[type]) {\n\t\t\targs = args || [];\n\t\t\tif(X.type(this.eventTypes[type]) === 'object'){\n\t\t\t\tvar event = this.eventTypes[type];\n\t\t\t\tparams = event.params ? params.concat(event.params) : params;\n\t\t\t\t\n\t\t\t\tif(event.type === 'listener'){\n\t\t\t\t\tif(X.type(event.comp) === 'string') {\n\t\t\t\t\t\tevent.comp = X.util.cm.get(event.comp);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(event.comp){\n\t\t\t\t\t\treturn event.comp.fireEvent(event.comp, event.eventName, params);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(event.type === 'javascript'){\n\t\t\t\t\tif(params.length > 0){\n\t\t\t\t\t\tvar a = [];\n\t\t\t\t\t\tfor(var i=0; i<params.length; i++){\n\t\t\t\t\t\t\ta.push('a' + (i+1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar fn = new Function(a, event.body);\n\t\t\t\t\t\treturn fn.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tvar fn = new Function(event.body);\n\t\t\t\t\t\treturn fn.call(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\treturn event.fn.apply(event.scope || o, args.concat(params));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(X.type(this.eventTypes[type]) === 'array'){\n\t\t\t\tfor(var i=0, len = this.eventTypes[type].length; i<len; i++){\n\t\t\t\t\tvar event = this.eventTypes[type][i],\n\t\t\t\t\t\tresult = false;\n\n\t\t\t\t\tif(X.type(event) === 'object'){\n\t\t\t\t\t\tparams = event.params ? params.concat(event.params) : params;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(event.type === 'listener'){\n\t\t\t\t\t\t\tif(X.type(event.comp) === 'string') {\n\t\t\t\t\t\t\t\tevent.comp = X.util.cm.get(event.comp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(event.comp){\n\t\t\t\t\t\t\t\tresult = event.comp.fireEvent(event.comp, event.eventName, params);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(event.type === 'javascript'){\n\t\t\t\t\t\t\tif(params.length > 0){\n\t\t\t\t\t\t\t\tvar a = [];\n\t\t\t\t\t\t\t\tfor(var j=0; j<params.length; j++){\n\t\t\t\t\t\t\t\t\ta.push('a' + (j+1));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar fn = new Function(a, event.body);\n\t\t\t\t\t\t\t\tresult = fn.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tvar fn = new Function(event.body);\n\t\t\t\t\t\t\t\tresult = fn.call(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tresult = event.fn.apply(event.scope || o, args.concat(params));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tresult = event.apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn this.eventTypes[type].apply(o.config ? o.config.scope || o : o, args.concat(params));\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn false;\n\t},\n\tremoveEvent: function(type){\n\t\tif (this.eventTypes[type]) {\n\t\t\tdelete this.eventTypes[type];\n\t\t}\n\t},\n\tclear: function(){\n\t\tthis.eventTypes = {};\n\t}\n});\n\nX.util.Observer.prototype.on = X.util.Observer.prototype.addEvent;\nX.util.Observer.prototype.off = X.util.Observer.prototype.removeEvent;\nX.util.Observer.prototype.fire = X.util.Observer.prototype.fireEvent;\n\nX.util.ElementManager = X.util.em = {\n\tid: 'x-ui-',\n\tindex: 1000,\n\tget: function(selector){\n\t\tif(selector){\n\t\t\tvar type = X.type(selector);\n\t\t\tif(type === 'string' || type === 'dom'){\n\t\t\t\tvar el = $(selector),\n\t\t\t\t\tme = this;\n\t\t\t\t\n\t\t\t\tel.each(function(){\n\t\t\t\t\tif(!this.id){\n\t\t\t\t\t\tthis.id = me.id + me.index++;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\telse if(type === 'jquery'){\n\t\t\t\tvar el = selector,\n\t\t\t\t\tme = this;\n\t\t\t\t\n\t\t\t\tel.each(function(){\n\t\t\t\t\tif(!this.id){\n\t\t\t\t\t\tthis.id = me.id + me.index++;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\telse if(type === 'object'){\n\t\t\t\tvar config = selector,\n\t\t\t\t\ttag = config.tag;\n\t\t\t\t\n\t\t\t\treturn this.create(tag, config);\n\t\t\t}\n\t\t}\n\n\t\treturn this.create();\n\t},\n\tcreate: function(tag, config){\n\t\tvar el = null;\n\t\tconfig = config || {};\n\t\tdelete config.tag;\n\t\tif(tag){\n\t\t\tel = $('<' + tag + ' />', config);\n\t\t}\n\t\telse{\n\t\t\tel = $('<div />', config);\n\t\t}\n\n\t\tif(config.id){\n\t\t\tel.attr('id', config.id);\n\t\t}\n\t\telse{\n\t\t\tel.attr('id', this.id + this.index++);\n\t\t}\n\n\t\treturn el;\n\t}\n};\n\nX.util.ComponentManager = X.util.cm = {\n\tmap: { },\n\tcString: { },\n\tcreate: function(contain, items){\n\t\tfor(var i=0, len=items.length; i<len; i++){\n\t\t\tif(!items[i].render){\n\t\t\t\titems[i] = new this.cString[items[i].cString](items[i]);\n\t\t\t}\n\n\t\t\tthis.elementAdd(contain, items[i].el);\n\t\t\tif(!items[i].config.autoRender){\n\t\t\t\titems[i].render();\n\t\t\t}\n\t\t\t\n\t\t\tthis.set(items[i].el.attr('id'), items[i]);\n\t\t}\n\t\t\n\t\treturn items;\n\t},\n\telementAdd: function(contain, el){\n\t\tcontain.append(el);\n\t},\n\tset: function(id, item){\n\t\tthis.map[id] = item;\n\t},\n\tget: function(id){\n\t\treturn this.map[id];\n\t},\n\taddCString: function(name, klass){\n\t\tthis.cString[name] = klass;\n\t},\n\tremove: function(id){\n\t\tdelete this.map[id];\n\t},\n\tclear: function(){\n\t\tthis.map = { };\n\t}\n};\n\n\nX.util.History = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tvc: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.History.base.initialize.call(this, listener);\n\t\t\n\t\t/* view */\n\t\tthis.viewMap = { };\n\t\t\n\t\t/* ajax data save */\n\t\tthis.ajaxCache = { };\n\t\t\n\t\t/* view id */\n\t\tthis.stack = [];\n\t},\n\tinitPageSave: function(key, view){\n\t\tthis.clear();\n\t\t\n\t\tthis.viewMap[key] = {\n\t\t\tview: view,\n\t\t\ttransition: 'none'\n\t\t};\n\t\tthis.stack.push(key);\n\t},\n\tnextPageSave: function(key, view, transition){\n\t\tthis.viewMap[key] = {\n\t\t\tview: view,\n\t\t\ttransition: transition\n\t\t};\n\t\tthis.stack.push(key);\n\t},\n\tprevPageSave: function(key){\n\t\tvar reverse = this.stack.reverse();\n\t\tvar len = 0;\n\t\tvar removeView = [];\n\n\t\tfor(var i=0; i<reverse.length; i++){\n\t\t\tif(key === reverse[i]){\n\t\t\t\tlen = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tremoveView.push(reverse[i]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i=0; i<removeView.length; i++){\n\t\t\tif(this.viewMap[removeView[i]]){\n\t\t\t\tthis.viewMap[removeView[i]].view.destroy();\n\t\t\t\tthis.removeViewMap(removeView[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis.stack.reverse();\n\t\tthis.stack = this.stack.slice(0, this.stack.length - len);\n\t},\n\tremoveViewMap: function(key){\n\t\tthis.viewMap[key].view.destroy();\n\t\tdelete this.viewMap[key];\n\t},\n\tremoveStack: function(key){\n\t\tvar i=0,\n\t\t\tstack = this.stack,\n\t\t\tlen = stack.length,\n\t\t\tarray = [];\n\t\tfor(;i<len;i++){\n\t\t\tif(stack[i] !== key){\n\t\t\t\tarray.push(stack[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis.stack = array;\n\t},\n\tgetBackPageInfo: function(){\n\t\tif(this.stack.length < 2){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar from = this.stack[this.stack.length - 1];\n\t\tvar to = this.stack[this.stack.length - 2];\n\t\t\n\t\tvar fromView = this.viewMap[from];\n\t\tvar toView = this.viewMap[to];\n\t\t\n\t\treturn {\n\t\t\tfromView: fromView.view,\n\t\t\ttoView: toView.view,\n\t\t\ttransition: fromView.transition\n\t\t}\n\t},\n\tsetAjaxCache: function(key, cacheData){\n\t\tthis.ajaxCache[key] = cacheData;\n\t},\n\tgetAjaxCache: function(key){\n\t\treturn this.ajaxCache[key];\n\t},\n\tisCache: function(key){\n\t\tif(this.ajaxCache[key]){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\tgetViewInfo: function(key){\n\t\tif(this.viewMap[key]){\n\t\t\treturn this.viewMap[key];\n\t\t}\n\t\treturn null;\n\t},\n\tclear: function(){\n\t\tvar removeView = this.stack;\n\t\tfor(var i=0; i<removeView.length; i++){\n\t\t\tif(this.viewMap[removeView[i]]){\n\t\t\t\tthis.viewMap[removeView[i]].view.destroy();\n\t\t\t}\n\t\t}\n\n\t\tthis.viewMap = { };\n\t\tthis.ajaxCache = { };\n\t\tthis.stack = [ ];\n\t},\n\tgetStackLength: function(){\n\t\treturn this.stack.length;\n\t}\n});\n\n\n\nX.util.ViewController = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tactiveIndex: 0,\n\t\t\ttransition: 'slide'\n\t\t};\n\t\tX.apply(this.config, config);\n\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.ViewController.base.initialize.call(this, listener);\n\n\t\tthis.history = new X.util.History({\n\t\t\tvc: this\n\t\t});\n\t\t\n\t\tthis.id = this.config.id || 'ui-vc-' + (X.util.ViewController.id++);\n\n\t\tX.util.ViewController.set(this);\n\t},\n\tinit: function(view){\n\t\tthis.view = view;\n\t},\n\tvalid: function(fromView, toView){\n\t\tif(fromView === toView){\n\t\t\treturn true;\n\t\t}\n\t\telse{\n\t\t\treturn false;\n\t\t}\n\t},\n\ttransitionStart: function(fromView, toView, transition, reverse){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(fromView, toView, transition, reverse){\n\t\t\tvar viewIn = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.addClass(transition + ' in ' + reverse + ' ui-transitioning ui-vc-active');\n\t\t\t\ttel.animationComplete(viewOut);\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.addClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t},\n\t\t\tviewOut = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.removeClass(transition + ' in ' + reverse + ' ui-transitioning');\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.removeClass(transition + ' out ' + reverse + ' ui-transitioning ui-vc-active');\n\t\t\t\t\n\t\t\t\tdone();\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this, [fromView, toView]);\n\n\t\t\t\tfromView = null, toView = null, transition = null, reverse = null;\n\t\t\t};\n\n\t\t\tviewIn();\n\t\t}\n\n\t\ttransitionHandler(fromView, toView, transition, reverse);\n\t\t\n\t\treturn deferred;\n\t},\n\tprevMove: function(fromView, toView, config){\n\t\tvar promise,\n\t\t\tme = this;\n\n\t\tconfig = X.apply({\n\t\t\ttransition: this.config.transition,\n\t\t\treverse: 'reverse'\n\t\t}, config);\n\n\t\n\t\tif(!X.util.vcm.transition){\n\t\t\tconfig.transition = false;\n\t\t}\n\n\t\tthis.fireEvent(this, 'beforeprevchange', [fromView, toView, config.params || null]);\n\n\t\tpromise = this.transitionStart(fromView, toView, config.transition, config.reverse);\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\n\t\t\tme.setActiveView(toView);\n\t\t\tme.history.prevPageSave(toView.getId());\n\n\t\t\tme.fireEvent(me, 'afterprevchange', [fromView, toView, config.params || null]);\n\n\t\t\tme = null, fromView = null, toView = null, config = null;\n\t\t});\n\t},\n\tnextMove: function(fromView, toView, config){\n\t\tvar promise,\n\t\t\tme = this;\n\t\t\n\t\tconfig = X.apply({\n\t\t\ttransition: this.config.transition,\n\t\t\thistory: true,\n\t\t\treverse: ''\n\t\t}, config);\n\t\t\n\t\tif(!X.util.vcm.transition){\n\t\t\tconfig.transition = false;\n\t\t}\n\n\t\tthis.fireEvent(this, 'beforenextchange', [fromView, toView, config.params || null]);\n\n\t\tpromise = this.transitionStart(fromView, toView, config.transition, config.reverse);\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\t\t\t\n\t\t\tme.setActiveView(toView);\n\t\t\tme.history.nextPageSave(toView.getId(), toView, config.transition);\n\t\t\tme.fireEvent(me, 'afternextchange', [fromView, toView, config.params || null]);\n\n\t\t\tme = null, fromView = null, toView = null, config = null;\n\t\t});\n\t},\n\tbackPage: function(){\n\t\tif(this.history.getStackLength() < 2){\n\t\t\treturn false;\n\t\t}\n\t\tvar o = this.history.getBackPageInfo();\n\t\tthis.prevMove(o.fromView, o.toView, {\n\t\t\ttransition: o.transition\n\t\t});\n\n\t\treturn true;\n\t}\n});\n\nX.util.vcm = X.util.ViewControllerManager = X.apply(X.util.ViewController, {\n\tid: 0,\n\ttransition: true,\n\tchanging: false,\n\tmap: { },\n\tloadingMsg: 'Loading..',\n\terrorMsg: '화면을 불러오지 못했습니다.',\n\tget: function(id){\n\t\treturn this.map[id];\n\t},\n\tset: function(vc){\n\t\tthis.map[vc.id] = vc;\n\t}\n});\n\n\nX.util.LocalViewController = X.extend(X.util.ViewController, {\n\tinitialize: function(config){\n\t\tthis.config = {  };\n\t\tX.apply(this.config, config);\n\t\tX.util.LocalViewController.base.initialize.call(this, this.config);\n\n\t\tthis.views = [];\n\t},\n\tinit: function(view){\n\t\tX.util.LocalViewController.base.init.call(this, view);\n\t\t\n\t\tthis.views = this.view.config.items;\n\t\tthis.viewsInit();\n\t},\n\tviewsInit: function(){\n\t\tif(this.views.length < 1){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar views = this.views,\n\t\t\tlen = views.length,\n\t\t\tactiveIndex = this.config.activeIndex,\n\t\t\tactiveView;\n\n\t\tactiveView = views[activeIndex];\n\n\t\tthis.setActiveView(activeView);\n\t\tthis.history.initPageSave(activeView.getId(), activeView);\n\n\t\tviews.forEach(function(view){\n\t\t\tview.el.addClass('ui-vc-views');\n\t\t});\n\t},\n\tsetActiveView: function(activeView){\n\t\tthis.activeView = activeView;\n\t\tthis.activeView.el.addClass('ui-vc-active');\n\t},\n\tgetActiveView: function(){\n\t\treturn this.activeView;\n\t},\n\tgetActiveIndex: function(){\n\t\tvar active = this.getActiveView();\n\t\tfor(var i=0; i<this.config.views.length; i++){\n\t\t\tif(active === this.config.views[i]){\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t},\n\tgetView: function(index){\n\t\tif(this.views.length < 1){\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tvar view = this.views[index];\n\t\tif(!view){\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\treturn view;\n\t},\n\tnextPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoView = this.getView(config.index);\n\t\t\n\t\tif(this.valid(fromView, toView)){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tX.util.vcm.changing = true;\n\t\tthis.nextMove(fromView, toView, config);\n\t},\n\tprevPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoViewInfo = this.history.getViewInfo(this.getView(config.index).getId());\n\t\t\n\t\tif(this.valid(fromView, toViewInfo.view)){\n\t\t\treturn false;\n\t\t}\n\n\t\tX.util.vcm.changing = true;\n\t\tthis.prevMove(fromView, toViewInfo.view, {\n\t\t\ttransition: toViewInfo.transition\n\t\t});\n\t},\n\tappendView: function(view){\n\t\tview.el.addClass('ui-vc-active');\n\t\tthis.views.push(view);\n\t},\n\tremoveView: function(view){\n\t\tvar i=0,\n\t\t\tviews = this.views,\n\t\t\tlen = views.length,\n\t\t\tarray = [],\n\t\t\tid = view.getId();\n\t\t\n\t\tfor(; i<len; i++){\n\t\t\tif(views[i] !== view){\n\t\t\t\tarray.push(views[i]);\n\t\t\t}\n\t\t}\n\t\tthis.views = array;\n\n\t\tthis.history.removeMap(id);\n\t\tthis.history.removeStack(id);\n\t}\n});\n\n\nX.util.cm.addCString('localviewcontroller', X.util.LocalViewController);\n\n\nX.util.RemoteViewController = X.extend(X.util.ViewController, {\n\tinitialize: function(config){\n\t\tthis.config = {  };\n\t\tX.apply(this.config, config);\n\t\tX.util.RemoteViewController.base.initialize.call(this, this.config);\n\n\t\tthis.views = [];\n\t\tthis.updater = new X.util.ViewUpdater({\n\t\t\tvc: this\n\t\t});\n\t},\n\tinit: function(view){\n\t\tX.util.RemoteViewController.base.init.call(this, view);\n\t\t\n\t\tif(this.config.initPage){\n\t\t\tthis.initPage(this.config.initPage);\n\t\t}\n\t},\n\tinitPage: function(config){\n\t\tthis.fireEvent(this, 'beforeinit', []);\n\t\tthis.callMethod = 'initSuccess';\n\t\tthis.send(config);\n\t},\n\tnextPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn;\n\t\t}\n\t\tX.util.ViewController.changing = true;\n\t\tthis.callMethod = 'nextSuccess';\n\t\t\n\t\tthis.send(config);\n\t},\n\tprevPage: function(config){\n\t\tif(X.util.vcm.changing){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!config){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoViewInfo = this.history.getViewInfo(config.url);\n\t\t\n\t\tif(this.valid(fromView, toViewInfo.view)){\n\t\t\treturn false;\n\t\t}\n\n\t\tX.util.vcm.changing = true;\n\t\tthis.prevMove(fromView, toViewInfo.view, {\n\t\t\ttransition: toViewInfo.transition\n\t\t});\n\t},\n\tsetActiveView: function(active){\n\t\tthis.activeView = active;\n\t\tthis.activeView.el.addClass('ui-vc-active');\n\t},\n\tgetActiveView: function(){\n\t\tvar active = this.activeView;\n\t\treturn active;\n\t},\n\tgetToView: function(index){\n\t\tvar view;\n\t\tvar config = index;\n\t\tconfig.scroll = false;\n\t\tview = new X.View(config);\n\t\t\n\t\tview.getEl().addClass('ui-vc-views');\n\t\treturn view;\n\t},\n\tappend: function(view){\n\t\tthis.views.push(view);\n\t\tview.addClass('ui-vc-views');\n\t},\n\tsend: function(config){\n\t\tif(!this.history.isCache(config.url)){\n\t\t\t//loading..\n\t\t\tthis.loading = X.util.em.get()\n\t\t\t\t.html(X.util.vcm.loadingMsg).addClass('ui-loading-msg');\n\n\t\t\tX.getBody().prepend(this.loading);\n\t\t\tthis.loading.addClass('ui-popup in');\n\n\t\t\tif(this.updater && config.url){\n\t\t\t\tif(config.url){\n\t\t\t\t\tthis.updater.send(config);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tthis.success(this.history.getAjaxCache(config.url), config);\n\t\t}\n\t},\n\tsuccess: function(data, config){\n\t\tif(this.loading){\n\t\t\tthis.loading.remove();\n\t\t}\n\n\t\tthis.history.setAjaxCache(config.url, data);\n\t\tdata = $(data);\n\n\t\tvar html = [],\n\t\t\tscript = [];\n\t\t\n\t\tdata.each(function(){\n\t\t\tif(this.nodeName !== 'SCRIPT'){\n\t\t\t\thtml.push(this);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tscript.push(this);\n\t\t\t}\n\t\t});\n\t\t\n\t\tdata = {\n\t\t\thtml: $(html),\n\t\t\tscript: $(script)\n\t\t};\n\t\t\n\t\tvar toViewEl = data.html.eq(0),\n\t\t\tviewConfig = { id: config.url },\n\t\t\ttoView;\n\t\t\n\t\ttoView = this.history.getViewInfo(config.url);\n\t\tif(!toView){\n\t\t\ttoView = this.getToView(viewConfig);\n\t\t\ttoView.el.addClass('ui-vc-views');\n\t\t}\n\t\telse{\n\t\t\ttoView = toView.view;\n\t\t}\n\n\t\tthis[this.callMethod](data, toView, config);\n\t},\n\tinitSuccess: function(data, toView, config){\n\t\tthis.history.initPageSave(config.url, toView);\n\t\n\t\tthis.setActiveView(toView);\n\t\ttoView.setContent(data.html);\n\t\tthis.view.append([toView]);\n\t\ttoView.body.append(data.script);\n\n\t\tthis.fireEvent(this, 'afterinit', [this.getActiveView()]);\n\t},\n\tnextSuccess: function(data, toView, config){\n\t\tvar fromView = this.getActiveView({\n\t\t\tid: config.url\n\t\t});\t\t\n\n\t\tif(!this.history.getViewInfo(config.url)){\n\t\t\ttoView.setContent(data.html);\n\t\t\tthis.view.append([toView]);\n\t\t\ttoView.body.append(data.script);\n\t\t}\n\t\tthis.nextMove(fromView, toView, config);\n\t},\n\terrorTransition: function(div, type){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(div, type){\n\t\t\tvar divIn = function(){\n\t\t\t\tdiv.addClass('ui-popup in');\n\t\t\t\tdiv.animationComplete(divOut);\n\t\t\t},\n\t\t\tdivOut = function(){\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tdiv.removeClass('ui-popup in').addClass('ui-popup out');\n\t\t\t\t\tdiv.animationComplete(done);\n\t\t\t\t}, 3000);\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this);\n\n\t\t\t\tdiv = null, type = null;\n\t\t\t};\n\n\t\t\tif(type === 'show'){\n\t\t\t\tdivOut();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdivIn();\n\t\t\t}\n\t\t}\n\n\t\ttransitionHandler(div, type);\n\t\t\n\t\treturn deferred;\n\t},\n\terror: function(){\n\t\t//error\n\t\tvar div,\n\t\t\tpromise,\n\t\t\tfn = function(div){\n\t\t\t\tvar promise = this.errorTransition(div);\n\t\t\t\treturn promise;\n\t\t\t};\n\t\t\n\t\tif(this.loading){\n\t\t\tdiv = this.loading;\n\t\t\tdiv.html(X.util.vcm.errorMsg);\n\t\t\t\n\t\t\tif(div.css('display') !== 'none'){\n\t\t\t\tpromise = this.errorTransition(div, 'show');\n\t\t\t}\n\t\t\telse{\n\t\t\t\tpromise = fn.call(this, div);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tvar div = X.util.em.get()\n\t\t\t\t.html(X.util.vcm.errorMsg).addClass('ui-loading-msg');\n\t\t\tX.getBody().prepend(div);\n\t\t\t\n\t\t\tpromise = fn.call(this, div);\n\t\t}\n\n\t\tpromise.done(function(){\n\t\t\tX.util.vcm.changing = false;\n\t\t\tdiv.remove();\n\t\t\tdiv = null;\n\t\t});\n\t}\n});\n\n\nX.util.ViewUpdater = X.extend(X.util.Observer,{\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tclear: true,\n\t\t\tajax: {\n\t\t\t\tcontext: this,\n\t\t\t\ttimeout: 10000,\n\t\t\t\tdataType: 'html',\n\t\t\t\tsuccess: this.success,\n\t\t\t\terror: this.error\n\t\t\t}\n\t\t};\n\t\t\n\t\tX.apply(true, this.config, config);\n\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.util.ViewUpdater.base.initialize.call(this, listener);\n\t},\n\tsend: function(config){\n\t\tconfig = X.apply(config, this.config.ajax);\n\t\tvar xhr = $.ajax(config);\n\n\t\tvar params = { };\n\t\tparams.url = config.url;\n\t\tif(config.hasOwnProperty('transition')){\n\t\t\tparams.transition = config.transition;\n\t\t}\n\t\tif(config.hasOwnProperty('history')){\n\t\t\tparams.history = config.history;\n\t\t}\n\t\txhr.params = params;\n\t},\n\tsuccess: function(data, status, xhr){\n\t\tthis.config.vc.success(data, xhr.params);\n\t},\n\terror: function(xhr, status){\n\t\tthis.config.vc.error(xhr);\n\t}\n});\n\nX.util.cm.addCString('viewupdater', X.util.ViewUpdater);\n\nX.View = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tel: null,\n\t\t\twidth: 200,\n\t\t\theight: 200,\n\t\t\tautoSize: true,\n\t\t\tscroll: true,\n\t\t\tscrollConfig: { },\n\t\t\tcontent: null,\n\t\t\titems: [ ],\n\t\t\ttoolbars: [ ],\n\t\t\tfloating: false,\n\t\t\toverlay: false,\n\t\t\tviewController: null,\n\t\t\tlayout: 'y',\n\t\t\tflexible: true,\n\t\t\tpanels: null,\n\t\t\tclassName: null,\n\t\t\tstyle: null\n\t\t};\n\t\tX.apply(true, this.config, config);\n\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.View.base.initialize.call(this, listener);\n\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t\t\n\t\tthis.body = this.el.wrapInner(\n\t\t\tX.util.em.get().addClass('ui-view-body')\n\t\t).children();\n\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\tthis.el.addClass('ui-view');\n\n\t\tthis.setLayout(this.config.layout);\n\t\tthis.setSize(this.config.autoSize);\n\n\t\tif(this.config.className){\n\t\t\tthis.el.addClass(this.config.className);\n\t\t}\n\n\t\tif(this.config.style){\n\t\t\tthis.el.css(this.config.style);\n\t\t}\n\n\t\tif(this.config.toolbars.length > 0){\n\t\t\tthis.addToolbar(this.config.toolbars);\n\t\t}\n\n\t\tif(this.config.content){\n\t\t\tthis.setContent(this.config.content);\n\t\t}\n\t\t\n\t\tif(this.config.items.length > 0){\n\t\t\tthis.add(this.config.items);\n\t\t}\n\n\t\tif(this.config.viewController){\n\t\t\tthis.setViewController(this.config.viewController);\n\t\t}\n\t\t\n\t\tif(this.config.floating){\n\t\t\tthis.setFloating(this.config.floating);\n\t\t}\n\t\t\n\t\tif(this.config.panels){\n\t\t\tthis.panelsCreate(this.config.panels);\n\t\t}\t\n\n\t\tthis.setFlexible(this.config.flexible);\n\t\tthis.scrollCreate(this.config.scroll);\n\n\t\tX.getWindow().on(X.events.orientationchange, { me: this }, this.onOrientationChange);\n\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tscrollRefresh: function(){\n\t\tif(this.scroll){\n\t\t\tthis.scroll.refresh();\n\t\t}\n\t},\n\tpanelsCreate: function(panels){\n\t\tif(panels.left){\n\t\t\tthis.panelsLeft = X.util.em.get()\n\t\t\t\t.addClass('ui-view-panels-left');\n\t\t\t\n\t\t\tthis.el.append(this.panelsLeft);\n\t\t\t\n\t\t\tX.util.cm.create(this.panelsLeft, [panels.left]);\n\t\t}\n\t\t\n\t\tif(panels.right){\n\t\t\tthis.panelsRight = X.util.em.get()\n\t\t\t\t.addClass('ui-view-panels-right');\n\t\t\t\n\t\t\tthis.el.append(this.panelsRight);\n\t\t\t\n\t\t\tX.util.cm.create(this.panelsRight, [panels.right]);\n\t\t}\t\t\n\t\t\n\t\tthis.body.addClass('ui-view-panels ui-view-panels-close');\n\t},\n\tpanelsOpen: function(type){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tthis.body.removeClass('ui-view-panels-close').addClass('ui-view-panels-open-' + type);\n\t\t\t\n\t\t\tthis.fireEvent(this, 'panelsopen', [this]);\n\t\t}\n\t},\n\tpanelsClose: function(){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tthis.body.removeClass('ui-view-panels-open').addClass('ui-view-panels-close');\n\t\t\t\n\t\t\tthis.fireEvent(this, 'panelsclose', [this]);\n\t\t}\n\t},\n\tpanelsToggle: function(type){\n\t\tif(this.panelsRight || this.panelsLeft){\n\t\t\tif(this.body.hasClass('ui-view-panels-close')){\n\t\t\t\tthis.panelsOpen(type);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.panelsClose(type);\n\t\t\t}\n\t\t}\n\t},\n\tsetContent: function(content){\n\t\tvar reg = /^#/;\n\t\tif(X.type(content) === 'string' && reg.test(content)){\n\t\t\tcontent = $(content);\n\t\t\tif(this.body.children('.ui-scrollview-view').length > 0){\n\t\t\t\tthis.body.children('.ui-scrollview-view').html(content);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.body.html(content);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(this.body.children('.ui-scrollview-view').length > 0){\n\t\t\t\tthis.body.children('.ui-scrollview-view').html(content);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.body.html(content);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.createHtmlComponent();\n\t},\n\tsetLayout: function(layout){\n\t\tif(layout === \"x\"){\n\t\t\tthis.el.addClass(\"ui-view-horizontal\");\n\t\t\tthis.body.removeClass(\"ui-view-body-vertical\")\n\t\t\t\t.addClass(\"ui-view-body-horizontal\");\n\t\t}\n\t\telse if(layout === \"y\"){\n\t\t\tthis.body.removeClass(\"ui-view-body-horizontal\")\n\t\t\t\t.addClass('ui-view-body-vertical');\n\t\t}\n\t},\n\tsetFlexible: function(flex){\n\t\tif(flex){\n\t\t\tthis.el.removeClass('ui-view-inflexible')\n\t\t\t\t.addClass('ui-view-flexible');\n\t\t}\n\t\telse{\n\t\t\tthis.el.removeClass('ui-view-flexible')\n\t\t\t\t.addClass('ui-view-inflexible');\n\t\t}\n\t},\n\tsetSize: function(autoSize){\n\t\tthis.setWidth(autoSize);\n\t\tthis.setHeight(autoSize);\n\t},\n\tsetWidth: function(width){\n\t\tif(X.type(width) !== 'boolean' && width !== true){\n\t\t\tthis.setFlexible(false);\n\t\t\tvar w = width || this.config.width;\n\t\t\tthis.el.width(w);\n\t\t}\n\t},\n\tsetHeight: function(height){\n\t\tif(X.type(height) !== 'boolean' && height !== true){\n\t\t\tthis.setFlexible(false);\n\t\t\tvar h = height || this.config.height;\n\t\t\tthis.el.height(h)\n\t\t\t\t.css('min-height', h);\n\t\t}\n\t},\n\tgetWidth: function(){\n\t\tvar width = this.el.outerWidth();\n\t\treturn width;\n\t},\n\tgetHeight: function(){\n\t\tvar height = this.el.outerHeight();\n\t\treturn height;\n\t},\n\tscrollCreate: function(scroll){\n\t\tif(scroll){\n\t\t\tthis.scroll = new iScroll(this.body.get(0), this.config.scrollConfig);\n\t\t}\n\t},\n\tscrollDestroy: function(){\n\t\tif(this.scroll){\n\t\t\tthis.scroll.destroy();\n\t\t}\n\t},\n\tonOrientationChange: function(e){\n\t\tvar me = e.data.me;\n\t\tme.fireEvent(me, 'orientationchange', []);\n\t},\n\tshow: function(transition){\n\t\tif(!this.el.hasClass('ui-view-hide')){\n\t\t\treturn;\n\t\t}\n\n\t\tif(this.config.floating){\n\t\t\tif(this.config.floating){\n\t\t\t\tvar style = this.el.get(0).style;\n\t\t\t\tthis.el.css({\n\t\t\t\t\tmarginTop: -(parseInt(style.height) / 2),\n\t\t\t\t\tmarginLeft: -(parseInt(style.width) / 2)\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(this.overlay){\n\t\t\t\tthis.overlay.show();\n\t\t\t}\n\t\t}\n\n\t\tthis.el.removeClass('ui-view-hide');\n\n\t\tif(transition){\n\t\t\tthis.el.addClass('pop in').animationComplete(function(){\n\t\t\t\tthis.className = this.className.replace('pop in', '');\n\t\t\t});\n\t\t}\t\n\t\tthis.fireEvent(this, 'show', [this]);\n\n\t\treturn this;\n\t},\n\thide: function(transition){\n\t\tif(this.el.hasClass('ui-view-hide')){\n\t\t\treturn;\n\t\t}\n\n\t\tif(transition){\n\t\t\tthis.el.addClass('out').animationComplete(function(){\n\t\t\t\tthis.className = this.className.replace('out', '') + 'ui-view-hide';\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tthis.el.addClass('ui-view-hide');\n\t\t}\n\t\t\n\t\t\n\t\tif(this.config.floating && this.overlay){\n\t\t\tthis.overlay.hide();\n\t\t}\n\n\t\tthis.fireEvent(this, 'hide', [this]);\n\t\treturn this;\n\t},\n\ttoggle: function(){\n\t\tif(this.el.hasClass('ui-view-hide')){\n\t\t\tthis.show();\n\t\t}\n\t\telse{\n\t\t\tthis.hide();\n\t\t}\n\t},\n\tgetEl: function(){\n\t\treturn this.el;\n\t},\n\tgetId: function(){\n\t\treturn this.el.attr('id');\n\t},\n\tgetViewController: function(){\n\t\treturn this.config.viewController;\n\t},\n\tsetViewController: function(vc){\n\t\tif(X.type(vc) === 'string'){\n\t\t\tvc = X.util.ViewController.get(vc);\n\t\t}\n\n\t\tif(!vc){\n\t\t\tnew Error('arguments is unknow');\n\t\t}\n\n\t\tvc.init(this);\n\t\tthis.config.viewController = vc;\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t\tX.getWindow().off(X.events.orientationchange, this.onOrientationChange);\n\n\t\tthis.fireEvent(this, 'destroy', [this]);\n\t},\n\tadd: function(comps){\n\t\tvar el = this.body.children('.ui-scrollview-view');\n\t\tif(el.length < 1){\n\t\t\tel = this.body;\n\t\t}\n\t\tcomps = X.util.cm.create(el, comps);\n\t\tthis.config.items = $.unique(this.config.items.concat(comps));\n\t\tthis.config.items.reverse();\n\t\t\n\t\treturn comps;\n\t},\n\tremove: function(index){\n\n\t},\n\taddToolbar: function(toolbars){\n\t\ttoolbars = X.util.cm.create(this.el, toolbars);\n\t\tthis.config.toolbars.push(toolbars);\n\n\t\treturn toolbars;\n\t},\n\tsetFloating: function(float){\n\t\tif(float){\n\t\t\tthis.config.floating = float;\n\t\t\tthis.el.addClass('ui-view-floating ui-view-hide');\n\t\t}\n\t\telse{\n\t\t\tthis.el.removeClass('ui-view-floating ui-view-hide');\n\t\t}\t\t\n\t\tthis.setOverlay(this.config.overlay);\n\t},\n\tsetOverlay: function(overlay){\n\t\tif(overlay){\n\t\t\tif(this.config.floating){\n\t\t\t\tthis.overlay = X.util.em.get().addClass('ui-overlay');\n\t\t\t\tX.getBody().append(this.overlay);\n\t\t\t\tthis.overlay.bind('vclick', { me: this }, function(e){\n\t\t\t\t\tvar me = e.data.me;\n\t\t\t\t\tme.hide();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(this.overlay){\n\t\t\t\t\tthis.overlay.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(this.overlay){\n\t\t\t\tthis.overlay.remove();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.config.overlay = overlay;\n\t},\n\tcreateHtmlComponent: function(){\n\t\tvar\tviews = this.el.find('[data-role=\"view\"]');\n\t\tviews.each(function(){\n\t\t\tvar el = $(this);\n\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val, panels = { };\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\t\t\t\n\t\t\tconfig.el = el;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tnew X.View(config);\n\t\t});\n\n\t\tvar panels = this.el.find('[data-role=\"view\"][data-panels=\"true\"]');\n\t\tpanels.each(function(){\n\t\t\tvar id = this.id,\n\t\t\t\tview = X.util.cm.get(id),\n\t\t\t\tpanels = { }, left, right;\n\n\t\t\tif(!view.scroll){\n\t\t\t\tleft = view.body.children('[data-role=\"view\"][data-panels=\"left\"]');\n\t\t\t\tright = view.body.children('[data-role=\"view\"][data-panels=\"right\"]');\n\n\t\t\t\tif(left.length > 0){\n\t\t\t\t\tpanels.left = X.util.cm.get(left.get(0).id);\n\t\t\t\t}\n\n\t\t\t\tif(right.length > 0){\n\t\t\t\t\tpanels.right = X.util.cm.get(right.get(0).id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tview.panelsCreate(panels);\n\t\t});\n\t\t\n\n\t\tvar\tcomps = this.el.find('[data-role]').not('[data-role=\"view\"]');\n\t\tvar charts = [];\n\t\t\n\t\tcomps.each(function(){\n\t\t\tvar el = $(this),\n\t\t\t\tcomp = el.data('role');\n\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val;\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\t\t\t\n\t\t\tconfig.el = el;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tif(comp === 'toolbar'){\n\t\t\t\tel.parents('.ui-view').eq(0).prepend(el);\n\t\t\t\tconfig.title = el.html();\n\t\t\t\tel.empty();\n\t\t\t\tnew X.ui.Toolbar(config);\n\t\t\t}\n\n\t\t\tif(comp === 'tabs'){\n\t\t\t\tvar tabs = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ], titles = [ ];\n\t\t\t\t\n\t\t\t\ttabs.each(function(){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t\ttitles.push(this.dataset.title);\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tconfig.titles = titles;\n\t\t\t\t\n\t\t\t\tnew X.ui.Tabs(config);\n\t\t\t}\n\n\t\t\tif(comp === 'carousel'){\n\t\t\t\tvar views = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ];\n\t\t\t\t\n\t\t\t\tviews.each(function(){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tnew X.ui.Carousel(config);\n\t\t\t}\n\n\t\t\tif(comp === 'listview'){\n\t\t\t\tnew X.ui.ListView(config);\n\t\t\t}\n\n\t\t\tif(comp === 'accordion'){\n\t\t\t\tvar views = el.children('[data-role=\"view\"]'),\n\t\t\t\t\titems = [ ], titles = [ ];\n\n\t\t\t\tviews.each(function(i){\n\t\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t\t\ttitles.push(this.dataset.title);\n\t\t\t\t});\n\n\t\t\t\tconfig.items = items;\n\t\t\t\tconfig.titles = titles;\n\n\t\t\t\tnew X.ui.Accordion(config);\n\t\t\t}\n\n\t\t\tif(comp === 'textbox'){\n\t\t\t\tnew X.ui.TextBox(config);\n\t\t\t}\n\n\t\t\tif(comp === 'slider'){\n\t\t\t\tnew X.ui.Slider(config);\n\t\t\t}\n\n\t\t\tif(comp === 'progress'){\n\t\t\t\tnew X.ui.Progressbar(config);\n\t\t\t}\n\n\t\t\tif(comp === 'spinner'){\n\t\t\t\tnew X.ui.Spinner(config);\n\t\t\t}\n\n\t\t\tif(comp === 'switchbox'){\n\t\t\t\tnew X.ui.SwitchBox(config);\n\t\t\t}\n\n\t\t\tif(comp === 'checkbox'){\n\t\t\t\tnew X.ui.CheckBox(config);\n\t\t\t}\n\t\t\t\n\t\t\tif(comp === 'radiobox'){\n\t\t\t\tnew X.ui.RadioBox(config);\n\t\t\t}\n\t\t\t\n\t\t\tif(comp === 'selectbox'){\n\t\t\t\tnew X.ui.SelectBox(config);\n\t\t\t}\n\t\t});\n\n\t\tvar\tformView = this.el.find('[data-role=\"formview\"]');\n\t\tformView.each(function(){\n\t\t\tvar el = $(this),\n\t\t\t\titems = [],\n\t\t\t\tselector = '[data-role=\"textbox\"],' +\n\t\t\t\t\t'[data-role=\"slider\"],' +\n\t\t\t\t\t'[data-role=\"spinner\"],' + \n\t\t\t\t\t'[data-role=\"switchbox\"],' +\n\t\t\t\t\t'[data-role=\"progress\"]';\n\t\t\t\n\t\t\tvar dataset = this.dataset,\n\t\t\t\tconfig = { }, val, panels = { };\n\t\t\t\n\t\t\tfor(attr in dataset){\n\t\t\t\tif(dataset[attr] === \"true\" \n\t\t\t\t\t|| dataset[attr] === \"false\"\n\t\t\t\t\t|| parseFloat(dataset[attr])\n\t\t\t\t\t|| /^\\{(.*?)\\}$/.test(attr)){\n\t\t\t\t\tval = JSON.parse(dataset[attr]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tval = dataset[attr];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconfig[attr] = val;\n\t\t\t}\n\n\t\t\tel.children(selector).each(function(){\n\t\t\t\titems.push(X.util.cm.get(this.id));\n\t\t\t});\n\n\t\t\tconfig.el = el;\n\t\t\tconfig.items = items;\n\t\t\tconfig.autoRender = true;\n\n\t\t\tnew X.ui.FormView(config);\n\t\t});\n\t}\t\n});\n\nX.util.cm.addCString('view', X.View);\n\n\n\n\n\nX.ui = { };\nX.ui.ListView = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tscrollConfig: {\n\t\t\t\tdirection: 'y'\n\t\t\t}\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.ListView.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.ListView.base.render.call(this);\n\t\tthis.el.addClass('ui-listview');\n\n\t\tthis.ul = this.body.children('.ui-scrollview-view').children('ul');\n\t\tthis.ul.children('li').addClass('ui-listview-item');\n\n\t\tthis.scrollEvent();\n\t},\n\tscrollEvent: function(){\n\t\tthis.scroll.options.onScrollStart = function(){\n\t\t\t\n\t\t};\n\n\t\tthis.scroll.options.onScrollMove = function(){\n\t\t\t\n\t\t};\n\n\t\tthis.scroll.options.onScrollEnd = function(){\n\t\t\t\n\t\t};\n\t},\n\tappend: function(rows){\n\t\tvar type = X.type(row);\n\t\tif(type === 'string'){\n\t\t\trows = $(rows).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trows.addClass('ui-listview-item');\n\t\t}\n\n\t\tthis.ul.append(rows);\n\t\tthis.scrollRefresh();\n\t},\n\tprepend: function(rows){\n\t\tvar type = X.type(rows);\n\t\tif(type === 'string'){\n\t\t\trows = $(rows).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trows.addClass('ui-listview-item');\n\t\t}\n\n\t\tthis.ul.prepend(rows);\n\t\tthis.scrollRefresh();\n\t},\n\treplaceWith: function(index, row){\n\t\tif(X.type(index) !== 'number'){\n\t\t\tthrow new Error('arguments must be number ');\n\t\t}\n\n\t\tvar type = X.type(row);\n\t\tif(type === 'string'){\n\t\t\trow = $(row).addClass('ui-listview-item');\n\t\t}\n\t\telse if(type === 'jquery'){\n\t\t\trow.addClass('ui-listview-item');\n\t\t}\n\t\n\t\tthis.ul.children('li:eq(' + index + ')').replaceWith(row);\n\t},\n\tremove: function(index){\n\t\tif(X.type(index) !== 'number'){\n\t\t\tthrow new Error('arguments must be number ');\n\t\t}\n\t\tthis.ul.children('li:eq(' + index + ')').remove();\n\t\tthis.scrollRefresh();\n\t}\n});\n\nX.util.cm.addCString('listview', X.ui.ListView);\n\n\n\nX.ui.Accordion = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\ttitles: [],\n\t\t\titems: [],\n\t\t\tscroll: false,\n\t\t\tactiveIndex: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Accordion.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Accordion.base.render.call(this);\n\t\tthis.el.addClass('ui-accordion');\n\t\t\n\t\tthis.createItems();\n\t\tthis.createTitle();\n\n\t\tviews = this.body.on('vclick', '.ui-accordion-views > .ui-accordion-title', { me: this }, function(e){\n\t\t\tvar me = e.data.me;\n\t\t\t\n\t\t\tvar index = me.body.children('.ui-accordion-views').index($(this).parent());\n\t\t\tme.change(index);\n\t\t\treturn false;\n\t\t});\n\t},\n\tcreateItems: function(){\n\t\tthis.body.children('.ui-view').each(function(){\n\t\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\t\t\t\n\t\t\t$(this).wrap(div);\n\t\t});\n\n\t\tvar items = this.body.children('.ui-accordion-views');\n\t\titems.eq(this.config.activeIndex)\n\t\t\t.removeClass('ui-accordion-close')\n\t\t\t.addClass('ui-accordion-open');\n\t},\n\tcreateTitle: function(){\n\t\tvar views = this.body.children('.ui-accordion-views'),\n\t\t\ttitles = this.config.titles;\n\t\tviews.each(function(i){\n\t\t\tif(titles[i]){\n\t\t\t\tdiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(titles[i]);\n\t\t\t\t\n\t\t\t\t$(this).prepend(div);\n\t\t\t}\n\t\t});\n\n\t\ttitles = null;\t\t\n\t},\n\tchange: function(index){\n\t\tif(this.config.activeIndex === index){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.body.children('.ui-accordion-views')\n\t\t\t.removeClass('ui-accordion-open')\n\t\t\t.addClass('ui-accordion-close')\n\t\t\t.eq(index).addClass('ui-accordion-open')\n\t\t\t.removeClass('ui-accordion-close');\n\t\t\n\t\tthis.config.activeIndex = index;\n\n\t\tthis.fireEvent(this, 'change', [this]);\n\t},\n\tappend: function(comp, title){\n\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(title);\n\n\t\tthis.body.append(div);\n\t\tcomp = X.util.cm.create(div, [comp]);\n\t\tdiv.prepend(titleDiv);\n\n\t\tthis.config.activeIndex = null;\n\n\t\treturn [comp[0], title];\n\t},\n\tprepend: function(comp, title){\n\t\tvar div = X.util.em.get()\n\t\t\t\t.addClass('ui-accordion-views ui-accordion-close');\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t\t\t.addClass('ui-accordion-title')\n\t\t\t\t\t.html(title);\n\n\t\tthis.body.prepend(div);\n\t\tcomp = X.util.cm.create(div, [comp]);\n\t\tdiv.prepend(titleDiv);\n\n\t\tthis.config.activeIndex = null;\n\n\t\treturn [comp[0], title];\n\t},\n\tremove: function(index){\n\t\tthis.body.children('.ui-accordion-views').eq(index).remove();\n\t\tthis.config.items = this.config.items.filter(function(el, i){\n\t\t\treturn (index !== i);\n\t\t});\n\n\t\tthis.config.titles = this.config.titles.filter(function(el, i){\n\t\t\treturn (index !== i);\n\t\t});\n\t\tthis.config.activeIndex = null;\n\t},\n\tremoveAll: function(){\n\t\tthis.body.empty();\n\t\tthis.config.activeIndex = null;\n\t},\n\tchangeTitle: function(title, index){\n\t\tindex = index || 0;\n\t\tvar view = this.body.children('.ui-accordion-views')\n\t\t\t.eq(index);\n\t\t\n\t\tview\n\t\t\t.children('.ui-accordion-title')\n\t\t\t.html(title);\n\t\t\n\t\tthis.config.titles[index] = title;\n\t},\n\tgetItem: function(index){\n\t\treturn this.config.items[index];\n\t}\n});\n\nX.util.cm.addCString('accordion', X.ui.Accordion);\n\n\nX.ui.Toolbar = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tposition: 'top',\n\t\t\ttitle: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\n\t\tvar listener = { };\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.ui.Toolbar.base.initialize.call(this, listener);\n\t\t\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\t\n\t\tif(!X.util.cm.get(this.el.get(0).id)){\n\t\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t}\n\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\t\n\t\tthis.el.addClass('ui-toolbar ' + this.config.position);\n\n\t\tthis.inner = X.util.em.get()\n\t\t\t.addClass('ui-toolbar-inner');\n\n\t\tthis.el.append(this.inner);\n\n\t\tthis.setTitle(this.config.title);\n\t\t\n\t\tvar parent = this.el.parent();\n\t\tif(this.config.position === 'bottom'){\n\t\t\tparent.append(this.el);\n\t\t}\n\t\telse{\n\t\t\tparent.prepend(this.el);\n\t\t}\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tsetTitle: function(title){\n\t\tif(!this.title){\n\t\t\tthis.title = X.util.em.get().\n\t\t\t\taddClass('ui-toolbar-title');\n\n\t\t\tthis.inner.append(this.title);\n\t\t}\n\t\tthis.title.html(title);\n\t},\n\tgetTitle: function(){\n\t\tif(this.title){\n\t\t\treturn this.title.text();\n\t\t}\n\t},\n\tchangeTitle: function(title){\n\t\tthis.title.html(title);\n\t\t\n\t\tthis.fireEvent(this, 'changetitle', [this, title]);\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t}\n});\n\nX.util.cm.addCString('toolbar', X.ui.Toolbar);\n\n\n\nX.ui.Tabs = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tposition: 'top',\n\t\t\tactiveIndex: 0,\n\t\t\ttitles: [],\n\t\t\tautoSize: true,\n\t\t\ttransition: 'slide',\n\t\t\tscroll: false,\n\t\t\titems: []\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Tabs.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Tabs.base.render.call(this);\n\t\tthis.el.addClass('ui-tabs');\n\n\t\tthis.createTabBar();\n\t\t\n\t\tvar activeIndex = this.config.activeIndex;\n\t\t\n\t\tthis.tabBar\n\t\t\t.children('.ui-tabs-bar-items')\n\t\t\t.eq(activeIndex)\n\t\t\t.addClass('ui-tabs-bar-items-active');\n\t\t\n\t\tthis.activeView = this.config.items[activeIndex];\n\t\tfor(var i=0,len=this.config.items.length; i<len; i++){\n\t\t\tif(i === activeIndex){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.config.items[i].hide();\n\t\t}\n\t},\n\tcreateTabBar: function(){\n\t\tthis.tabBar = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar ui-tabs-bar-' + this.config.position);\n\t\t\n\t\tvar items = this.config.items,\n\t\t\tlen = items.length,\n\t\t\to, html = '';\n\n\t\tfor(var i=0; i<len; i++){\n\t\t\thtml += '<div class=\"ui-tabs-bar-items\"><span>' + items[i].config.title + '</span></div>'; \n\t\t}\n\t\tthis.tabBar.html(html);\n\t\t\n\t\tif(this.config.position === 'top'){\n\t\t\tthis.el.prepend(this.tabBar);\n\t\t}\n\t\telse{\n\t\t\tthis.el.append(this.tabBar);\n\t\t}\n\t\t\n\t\tthis.tabBar.on('vclick', '.ui-tabs-bar-items', { me: this }, this._click);\n\t},\n\t_click: function(e){\n\t\tvar me = e.data.me,\n\t\t\tbar = $(this), parent = bar.parent();\n\t\t\n\t\tvar index = parent.find('.ui-tabs-bar-items').index(bar);\n\t\t\n\t\tparent.find('.ui-tabs-bar-items').removeClass('ui-tabs-bar-items-active');\n\t\tbar.addClass('ui-tabs-bar-items-active');\n\t\t\n\t\tme.change(index);\n\t\treturn false;\n\t},\n\tchange: function(index){\n\t\tvar fromView = this.getActiveView(),\n\t\t\ttoView = this.config.items[index];\n\t\t\t\n\t\tif(fromView === toView){\n\t\t\treturn;\n\t\t}\t\n\t\n\t\tif(fromView.el.nextAll('#' + toView.getId()).length > 0){\n\t\t\tthis.right(fromView, toView);\n\t\t}\n\t\telse{\n\t\t\tthis.left(fromView, toView);\n\t\t}\n\t},\n\ttransitionStart: function(fromView, toView, transition, reverse){\n\t\tvar deferred = new $.Deferred();\n\n\t\tfunction transitionHandler(fromView, toView, transition, reverse){\n\t\t\tvar viewIn = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttoView.show();\n\t\t\t\ttel.show().addClass(transition + ' in ' + reverse + ' ui-transitioning');\n\t\t\t\ttel.animationComplete(viewOut);\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.addClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t},\n\t\t\tviewOut = function(){\n\t\t\t\tvar tel = toView.getEl();\n\t\t\t\ttel.removeClass(transition + ' in ' + reverse + ' ui-transitioning');\n\n\t\t\t\tvar fel = fromView.getEl();\n\t\t\t\tfel.removeClass(transition + ' out ' + reverse + ' ui-transitioning');\n\t\t\t\t\n\t\t\t\tdone();\n\t\t\t},\n\t\t\tdone = function(){\n\t\t\t\tdeferred.resolve(this, [fromView, toView]);\n\n\t\t\t\tfromView = null, toView = null, transition = null, reverse = null;\n\t\t\t};\n\n\t\t\tviewIn();\n\t\t}\n\n\t\ttransitionHandler(fromView, toView, transition, reverse);\n\t\t\n\t\treturn deferred;\n\t},\n\tsetActiveView: function(view){\n\t\tthis.activeView = view;\n\t},\n\tgetActiveView: function(){\n\t\treturn this.activeView;\n\t},\n\tgetActiveViewIndex: function(){\n\t\tvar active = this.getActiveView();\n\t\tfor(var i=0; i<this.config.items.length; i++){\n\t\t\tif(active === this.config.items[i]){\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t},\n\tgetView: function(index){\n\t\treturn this.config.items[index];\n\t},\n\tright: function(fromView, toView){\n\t\tthis.fireEvent(this, 'beforechange', [this, this.getActiveView(), this.getActiveViewIndex(), toView]);\n\n\t\tvar promise = this.transitionStart(fromView, toView, this.config.transition, ''), me = this;\n\t\tpromise.done(function(){\n\t\t\tfromView.hide();\n\t\t\tme.setActiveView(toView);\n\n\t\t\tme.fireEvent(me, 'afterchange', [me.getActiveView(), me.getActiveViewIndex(), fromView]);\n\t\t\tme = null, fromView = null, toView = null;\n\t\t});\n\t},\n\tleft: function(fromView, toView){\n\t\tthis.fireEvent(this, 'beforechange', [this, this.getActiveView(), this.getActiveViewIndex(), toView]);\n\n\t\tvar promise = this.transitionStart(fromView, toView, this.config.transition, 'reverse'), me = this;\n\t\tpromise.done(function(){\n\t\t\tfromView.hide();\n\t\t\tme.setActiveView(toView);\n\n\t\t\tme.fireEvent(me, 'afterchange', [me.getActiveView(), me.getActiveViewIndex(), fromView]);\n\t\t\tme = null, fromView = null, toView = null;\n\t\t});\n\t},\n\tappend: function(comp, title){\n\t\tcomp = X.util.cm.create(this.body, [comp]);\n\t\tthis.config.items.push(comp[0]);\n\t\tcomp[0].hide();\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar-items')\n\t\t\t.html('<span>' + title + '</span>');\n\n\t\tthis.tabBar.append(titleDiv);\n\t\treturn [comp[0], title];\n\t},\n\tprepend: function(comp, title){\n\t\tcomp = X.util.cm.create(this.body, [comp]);\n\t\tthis.config.items = comp.concat(this.config.items);\n\t\tcomp[0].hide();\n\t\tthis.body.prepend(comp[0].el);\n\n\t\tvar titleDiv = X.util.em.get()\n\t\t\t.addClass('ui-tabs-bar-items')\n\t\t\t.html('<span>' + title + '</span>');\n\n\t\tthis.tabBar.prepend(titleDiv);\n\t\treturn [comp[0], title];\n\t},\n\tremove: function(index){\n\t\tthis.config.items[index].destroy();\n\t\tthis.config.items.remove(index);\n\n\t\tthis.tabBar.children('.ui-tabs-bar-items').eq(index).remove();\n\t},\n\tdestroy: function(){\n\t\tX.ui.Tabs.base.destroy.call(this);\n\t\tthis.tabBar.remove();\n\t}\n});\nX.util.cm.addCString('tabs', X.ui.Tabs);\n\nX.ui.Carousel = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tdirection: 'x',\n\t\t\tscroll: false\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Carousel.base.initialize.call(this, this.config);\n\t\t\n\t\tthis.current = 0;\n\t\tthis.endPos = 0;\n\t\tthis.dragging = false;\n\t},\n\trender: function(){\n\t\tX.ui.Carousel.base.render.call(this);\n\t\tthis.el.addClass('ui-carousel');\n\n\t\tvar views = this.body.children('.ui-view').addClass('ui-carousel-views');\n\t\tthis.carouselBody = X.util.em.get().addClass('ui-carousel-body');\n\t\t\n\t\tif(views.length > 0){\n\t\t\tviews.wrapAll(this.carouselBody);\n\t\t}\n\t\telse{\n\t\t\tthis.el.append(this.carouselBody);\n\t\t}\n\t\t\n\t\t\n\t\tthis.carouselBody = this.body.children('.ui-carousel-body');\n\t\t\n\t\tif(this.config.direction === 'x'){\n\t\t\tthis.carouselBody.addClass('ui-carousel-horizontal');\n\t\t}\n\t\telse{\n\t\t\tthis.carouselBody.addClass('ui-carousel-vertical');\n\t\t}\n\n\t\tif(this.config.direction === 'y'){\n\t\t\tvar me = this;\n\t\t\tthis.config.items.forEach(function(view){\n\t\t\t\tview.setHeight(me.getHeight());\n\t\t\t});\n\t\t\tme = null;\n\t\t\t\n\t\t\tX.getWindow().on(X.events.orientationchange, { me: this }, this.resize);\n\t\t}\n\t\t\n\t\tthis.carouselBody.bind(X.events.start, {me: this}, this.onStart);\n\t},\n\tresize: function(e){\n\t\tvar me = e.data.me;\n\t\tme.config.items.forEach(function(view){\n\t\t\tview.setHeight(me.getHeight());\n\t\t});\n\t\tme = null;\n\t\treturn false;\n\t},\n\tonStart: function(e){\n\t\tvar me = e.data.me;\n\n\t\tvar pageX = e.originalEvent.touches ? \n\t\t\t\te.originalEvent.touches[0].pageX : e.originalEvent.pageX,\n\t\t\tpageY = e.originalEvent.touches ? \n\t\t\t\te.originalEvent.touches[0].pageY : e.originalEvent.pageY;\n\n\t\tme.startPageX = pageX;\n\t\tme.startPageY = pageY;\n\t\tme.dragging = true;\n\n\t\tme.carouselBody.on(X.events.move, { me: me }, me.onMove);\n\t\tme.carouselBody.on(X.events.end, { me: me }, me.onEnd);\n\t},\n\tonMove: function(e){\n\t\tvar me = e.data.me;\n\t\t\n\t\tif(me.dragging){\n\t\t\tvar pageX = e.originalEvent.touches ? \n\t\t\t\t\te.originalEvent.touches[0].pageX : e.originalEvent.pageX;\n\n\t\t\tvar\tpageY = e.originalEvent.touches ? \n\t\t\t\t\te.originalEvent.touches[0].pageY : e.originalEvent.pageY;\n\n\t\t\tme.carouselBody.get(0).style.webkitTransitionDuration = \"0\";\n\t\t\tif(me.config.direction === 'x'){\n\t\t\t\tme.movePos  = (pageX - me.startPageX) + (-1 * me.current) * me.getWidth();\n\t\t\t\tme.moveLimit = Math.abs(pageX - me.startPageX);\n\n\t\t\t\tme.carouselBody.get(0).style.webkitTransform = 'translate3d(' + me.movePos + 'px, 0px, 0px)';\n\t\t\t\tme.carouselBody.get(0).style.msTransform = 'translateX(' + me.movePos + 'px)';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tme.movePos  = (pageY - me.startPageY) + (-1 * me.current) * me.getHeight();\n\t\t\t\tme.moveLimit = Math.abs(pageY - me.startPageY);\n\n\t\t\t\tme.carouselBody.get(0).style.webkitTransform = 'translate3d(0px, ' + me.movePos + 'px, 0px)';\n\t\t\t\tme.carouselBody.get(0).style.msTransform = 'translateY(' + me.movePos + 'px)';\t\t\n\t\t\t}\n\n\t\t\tconsole.log(me.moveLimit);\n\t\t}\n\t\t\n\t\treturn false;\n\t},\n\tonEnd: function(e){\n\t\tvar me = e.data.me, \n\t\t\tendPos = 0,\n\t\t\tstyle = me.carouselBody.get(0).style;\n\n\t\tif(me.moveLimit > 30){\n\t\t\tif(me.movePos > 0){\n\t\t\t\tme.current = 0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(Math.abs(me.movePos) > Math.abs(me.endPos)){\n\t\t\t\t\tme.current++;\n\t\t\t\t\tif(me.current >= (me.config.items.length - 1)){\n\t\t\t\t\t\tme.current = me.config.items.length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tme.current--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(me.current === 0){\n\t\t\t\tendPos = 0;\n\t\t\t}\n\t\t\telse if(me.current > 0){\n\t\t\t\tif(me.config.direction === 'x'){\n\t\t\t\t\tendPos = (me.getWidth() * me.current) * -1;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tendPos = (me.getHeight() * me.current) * -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tme.endPos = endPos;\n\t\t}\n\t\telse{\n\t\t\tendPos = me.endPos;\t\n\t\t}\n\t\t\n\t\tstyle.webkitTransitionDuration = '200ms';\n\t\tif(me.config.direction === 'x'){\n\t\t\tstyle.webkitTransform = 'translate3d(' + endPos + 'px, 0px, 0px)';\n\t\t}\n\t\telse{\n\t\t\tstyle.webkitTransform = 'translate3d(0px, ' + endPos + 'px, 0px)';\n\t\t}\n\n\t\tme.fireEvent(me, 'change', [me, me.current, me.getActive()]);\n\n\t\tme.carouselBody.off(X.events.move);\n\t\tme.carouselBody.off(X.events.end);\n\n\t\tme.dragging = false;\n\t},\n\tgetActive: function(){\n\t\treturn this.config.items[this.current];\n\t},\n\tappend: function(comp){\n\t\tvar comps = X.util.cm.create(this.carouselBody, [comp]);\n\t\tthis.config.items.push(comps[0]);\n\t\tcomps[0].addClass('ui-carousel-views');\n\t\t\n\t\treturn comps[0];\n\t},\n\tremove: function(index){\n\t\tthis.config.items[index].destroy();\n\t\tthis.config.items.remove(index);\n\t},\n\tdestroy: function(){\n\t\tX.ui.Carousel.base.destroy.call(this);\n\t\tX.getWindow().off(X.events.orientationchange, { me: this }, this.resize);\n\t}\n});\n\nX.util.cm.addCString('carousel', X.ui.Carousel);\n\n\nX.ui.FormView = X.extend(X.View, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\t\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.FormView.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.FormView.base.render.call(this);\n\t},\n\tserialize: function(){\n\t\treturn $.param(this.getJSON());\n\t},\n\tgetJSON: function(){\n\t\tvar params = { },\n\t\t\titems = this.config.items,\n\t\t\tlen = items.length;\n\t\t\n\t\tfor(var i=0; i<len; i++){\n\t\t\tparams[items[i].getName()] = items[i].getValue();\n\t\t}\n\n\t\treturn params;\n\t}\n});\n\n\nX.ui.Form = X.extend(X.util.Observer, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tplaceholder: 'please..',\n\t\t\trequired: false,\n\t\t\tdisabled: false,\n\t\t\tdefaultValue: null,\n\t\t\tlabel: null\n\t\t};\n\t\tX.apply(this.config, config);\n\t\t\t\n\t\tvar listener = {};\n\t\tif(this.config.listener){\n\t\t\tlistener = this.config.listener;\n\t\t}\n\t\tX.ui.Form.base.initialize.call(this, listener);\n\n\t\tif(!this.config.el){\n\t\t\tthis.config.el = {\n\t\t\t\ttag: 'div',\n\t\t\t\tid: this.config.id\n\t\t\t};\n\t\t}\n\t\t\n\t\tthis.el = X.util.em.get(this.config.el);\n\t\t\n\t\tif(!X.util.cm.get(this.el.get(0).id)){\n\t\t\tX.util.cm.set(this.el.get(0).id, this);\n\t\t}\n\t\t\n\t\tif(this.config.autoRender){\n\t\t\tthis.render();\n\t\t}\n\t},\n\trender: function(){\n\t\tthis.fireEvent(this, 'beforerender', [this]);\n\t\tthis.el.addClass('ui-form-box');\n\t\t\n\t\tif(this.config.label){\n\t\t\tthis.labelCreate();\n\t\t}\n\t\t\n\t\tif(this.config.style){\n\t\t\tthis.el.css(this.config.style);\n\t\t}\n\t\t\n\t\tthis.formcontin = X.util.em.get()\n\t\t\t.addClass('ui-form-container');\n\t\t\n\t\tthis.el.append(this.formcontin);\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t},\n\tgetName: function(){\n\t\treturn this.config.name || this.el.get(0).id;\n\t},\n\tsetValue: function(val){\n\t\tif (this.form.attr('disabled')) {\n\t\t\treturn;\n\t\t}\n\t\tthis.form.val(val);\n\t\tthis.fireEvent(this, 'setvalue', [this, val]);\n\t},\n\tgetValue: function(){\n\t\treturn this.form.val();\n\t},\n\tlabelCreate: function(){\n\t\tthis.formlabel = X.util.em.get()\n\t\t\t.addClass('ui-form-label').html(this.config.label);\n\t\t\n\t\tthis.el.append(this.formlabel);\n\t},\n\tshow: function(){\n\t\tthis.el.show();\n\t\tthis.fireEvent(this, 'show', [this]);\n\t},\n\thide: function(){\n\t\tthis.el.hide();\n\t\tthis.fireEvent(this, 'hide', [this]);\n\t},\n\ttoggle: function(){\n\t\tif(this.el.css('display') !== 'none'){\n\t\t\tthis.hide();\n\t\t}\n\t\telse{\n\t\t\tthis.show();\n\t\t}\n\t},\n\tgetEl: function(){\n\t\treturn this.el;\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.form.attr('disabled', true);\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.form.attr('disabled', false);\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t},\n\tdestroy: function(){\n\t\tthis.el.remove();\n\t}\n});\n\nX.ui.TextBox = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\ttype: 'text'\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.TextBox.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.TextBox.base.render.call(this);\n\n\t\tthis.el.addClass('ui-textbox');\n\t\tthis.formCreate();\n\t\t\n\t\tthis.form.bind('focus keypress blur keydown keyup', {me: this}, this.setEvt);\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', []);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: this.config.type,\n\t\t\t'class': 'ui-text-input',\n\t\t\tplaceholder: this.config.placeholder,\n\t\t\tdisabled: this.config.disabled,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsetType: function(type){\n\t\tthis.form.prop('type', type);\n\t},\n\tsetPlaceholder: function(placeholder){\n\t\tthis.config.placeholder = placeholder;\n\t\tthis.form.attr('placeholder', placeholder);\n\t},\n\tsetEvt: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = me.getValue(),\n\t\t\ttype =  e.type;\n\n\t\tme.fireEvent(me, type, [val]);\n\t}\n});\n\nX.util.cm.addCString('textbox', X.ui.TextBox);\n\nX.ui.Slider = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmin: 0,\n\t\t\tmax: 100,\n\t\t\tstep: 1,\n\t\t\tdefaultValue: 50,\n\t\t\tdirection: 'x',\n\t\t\tstyle: { },\n\t\t\tsubhandle: false\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Slider.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Slider.base.render.call(this);\n\t\t\n\t\tthis.el.addClass('ui-slider ui-slider-' + this.config.direction);\n\t\tthis.formCreate();\n\t\tthis.handleCreate();\n\t\tthis.subHandleCreate();\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t\t\n\t\tthis.dragging = false;\n\t\tthis.handle.bind( X.events.start, {me: this}, function(e){\n\t\t\tvar me = e.data.me,\n\t\t\t\tel = me.el;\n\t\t\t\n\t\t\tif(el.hasClass('ui-disabled')){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tme.dragging = true;\n\t\t\tme.subdragging = false;\n\n\t\t\tX.getDoc().on(X.events.move, {me: me}, me.move);\n\t\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\t\treturn false;\n\t\t});\n\n\t\t\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.bind( X.events.start, {me: this}, function(e){\n\t\t\t\tvar me = e.data.me,\n\t\t\t\t\tel = me.el;\n\t\t\t\t\n\t\t\t\tif(el.hasClass('ui-disabled')){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tme.dragging = true;\n\t\t\t\tme.subdragging = true;\n\n\t\t\t\tX.getDoc().on(X.events.move, {me: me}, me.move);\n\t\t\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\n\t\tthis.setValue(this.config.defaultValue);\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tmove: function(e){\n\t\tvar me = e.data.me;\n\t\tif ( me.dragging ) {\n\t\t\tme.setValue( e );\n\t\t\treturn false;\n\t\t}\n\t},\n\tend: function(e){\n\t\tvar me = e.data.me;\n\t\tif ( me.dragging ) {\n\t\t\tme.dragging = false;\n\t\t\tvar val = me.getValue();\n\t\t\tme.fireEvent(me, 'change', [val]);\n\t\t\treturn false;\n\t\t}\n\n\t\tX.getDoc().off(X.events.move, {me: me}, me.move);\n\t\tX.getDoc().off(X.events.end, {me: me}, me.end);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'range',\n\t\t\t'class': 'ui-slider-input',\n\t\t\trequired: this.config.required,\n\t\t\tplaceholder: this.config.placeholder,\n\t\t\tmin: this.config.min,\n\t\t\tmax: this.config.max,\n\t\t\tstep: this.config.step,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsubHandleCreate: function(){\n\t\tif(this.config.subhandle){\n\t\t\tthis.subhandle = X.util.em.get().addClass('ui-slider-subhandle');\n\t\t\tthis.formcontin.append(this.subhandle);\n\t\t\t\n\t\t\tif(X.type(this.config.range) === 'object'){\n\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.subhandle.addClass('ui-slider-subhandle');\n\t\t\t}\n\t\t}\n\t},\n\thandleCreate: function(val){\n\t\tthis.handle = X.util.em.get(false, false, 'a').addClass('ui-slider-handle');\n\t\tthis.formcontin.append(this.handle);\n\n\t\tif(X.type(this.config.range) === 'object'){\n\t\t\tthis.subhandle = X.util.em.get(false, false, 'a').addClass('ui-slider-handle ui-slider-subhandle');\n\t\t\tthis.formcontin.append(this.subhandle);\n\t\t}\n\t},\n\tsetValue: function(val){\n\t\tvar percent,\n\t\t\tmin = this.getMin(),\n\t\t\tmax = this.getMax();\t\n\t\t\t\n\t\tif (X.type(val) === 'object') {\n\t\t\tvar e = val,\n\t\t\t\ttol = 8;\n\n\t\t\tif(this.config.direction === 'x'){\n\t\t\t\tvar w = this.formcontin.width(),\n\t\t\t\t\tl = this.formcontin.offset().left,\n\t\t\t\t\tx = e.originalEvent.pageX;\n\t\t\t\t\n\t\t\t\tif ( !this.dragging || x < l - tol || x > l + w + tol ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpercent = Math.round(((x - l) / w ) * 100 );\n\t\t\t}\n\t\t\tif(this.config.direction === 'y'){\n\t\t\t\tvar h = this.formcontin.height(),\n\t\t\t\t\tt = this.formcontin.offset().top,\n\t\t\t\t\ty = e.originalEvent.pageY;\n\t\t\t\t\t\n\t\t\t\tif ( !this.dragging || y < t - tol || y > t + h + tol ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpercent = Math.round(((y - t) / h ) * 100);\n\t\t\t}\n\t\t}\n\n\t\tif(X.type(val) === 'number'){\n\t\t\tpercent = this.percentValue(val);\n\t\t}\n\t\t\n\t\tvar newval = Math.round( (percent / 100) * (max - min) ) + min;\n\t\tnewval = this.trimValue(newval);\n\n\t\tpercent = this.percentValue(newval);\n\n\t\tif(this.subdragging){\n\t\t\tvar data = this.handle.data('data');\n\n\t\t\tif(data){\n\t\t\t\tdata = parseInt(data);\n\t\t\t\tif(newval < data){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(!this.subdragging && this.subhandle){\n\t\t\tvar data = this.subhandle.data('data');\n\t\t\tif(data){\n\t\t\t\tdata = parseInt(data);\n\t\t\t\tif(newval > data)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar subPercent = (this.config.subhandle - min) / (max - min) * 100;\n\t\t\t\tvar subNewVal = Math.round( (subPercent / 100) * (max - min) ) + min;\n\t\t\t\t\n\n\t\t\t\tif(this.config.direction === 'x'){\n\t\t\t\t\tthis.subhandle.css(\"left\", subPercent + \"%\").data('data', subNewVal);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.subhandle.css(\"top\", subPercent + \"%\").data('data', subNewVal);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(this.config.direction === 'x'){\n\t\t\tif(this.subdragging){\n\t\t\t\tthis.subhandle.css(\"left\", percent + \"%\").data('data', newval);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.handle.css(\"left\", percent + \"%\").data('data', newval);\n\t\t\t}\n\t\t}\n\n\t\tif(this.config.direction === 'y'){\n\t\t\tif(this.subdragging){\n\t\t\t\tthis.subhandle.css(\"top\", (percent) + \"%\").data('data', newval);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.handle.css(\"top\", (percent) + \"%\").data('data', newval);\n\t\t\t}\n\t\t}\n\n\t\tthis.change(percent, newval);\n\t},\n\ttrimValue: function(val){\n\t\tvar min = this.getMin(),\n\t\t\tmax = this.getMax();\n\n\t\tif ( val <= min ) {\n\t\t\treturn min;\n\t\t}\n\t\tif ( val >= max ) {\n\t\t\treturn max;\n\t\t}\n\t\tvar step = ( this.config.step > 0 ) ? this.config.step : 1,\n\t\t\tstepVal = (val - min) % step,\n\t\t\talignValue = val - stepVal;\n\n\t\tif ( Math.abs(stepVal) * 2 >= step ) {\n\t\t\talignValue += ( stepVal > 0 ) ? step : ( -step );\n\t\t}\n\n\t\treturn parseFloat(alignValue.toFixed(5));\n\t},\n\tpercentValue: function(val){\n\t\tvar min = this.getMin(),\n\t\t\tmax = this.getMax();\n\n\t\tpercent = (parseFloat(val) - min) / (max - min) * 100;\n\t\t\n\t\tif(isNaN(percent)){\n\t\t\treturn 0;\n\t\t}\n\t\tif (percent < 0) { \n\t\t\tpercent = 0; \n\t\t}\n\t\tif (percent > 100) { \n\t\t\tpercent = 100; \n\t\t}\n\n\t\treturn percent;\n\t},\n\tchange: function(p, v){\n\t\tthis.fireEvent(this, 'change', [this, p, v]);\n\t},\n\t//override\n\tgetValue: function(){\n\t\tif(this.subhandle){\n\t\t\treturn [this.handle.data('data'), this.subhandle.data('data')];\n\t\t}\n\t\telse{\n\t\t\treturn this.handle.data('data');\n\t\t}\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.handle.addClass('ui-disabled');\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.addClass('ui-disabled');\n\t\t}\n\t\tthis.form.attr('disabled', true);\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.handle.removeClass('ui-disabled');\n\t\tif(this.subhandle){\n\t\t\tthis.subhandle.removeClass('ui-disabled');\n\t\t}\n\t\tthis.form.attr('disabled', false);\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t},\n\tsetMin: function(min){\n\t\tthis.config.min = min;\n\t},\n\tsetMax: function(max){\n\t\tthis.config.max = max;\n\t},\n\tgetMin: function(){\n\t\treturn this.config.min;\n\t},\n\tgetMax: function(){\n\t\treturn this.config.max;\n\t}\n});\n\nX.util.cm.addCString('slider', X.ui.Slider);\n\nX.ui.Progressbar = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmax: 100,\n\t\t\tdefaultValue: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Progressbar.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Progressbar.base.render.call(this);\n\t\t\n\t\tthis.el.addClass('ui-progressbar');\n\t\n\t\tthis.formCreate();\n\t\t\n\t\tthis.setValue(this.config.defaultValue);\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'progress',\n\t\t\t'class': 'ui-progress',\n\t\t\tmax: this.config.max,\n\t\t\tvalue: this.config.defaultValue\n\t\t});\n\t\t\n\t\tthis.gauge = X.util.em.get().addClass('ui-progress-gauge');\n\t\tthis.bar = X.util.em.get().addClass('ui-progress-bar');\n\t\tthis.formcontin.append(this.gauge, this.bar);\n\t\tthis.formcontin.append(this.form);\n\t},\n\tsetValue: function(val){\n\t\tif (this.el.hasClass('ui-disabled')) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar w = this.el.width(),\n\t\t\tpercent = (w / this.config.max) * val;\n\n\t\tif(isNaN(percent)){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(percent > w){\n\t\t\tpercent = w;\n\t\t}\t\t\n\t\t\n\t\tif(val < 0){\n\t\t\tval = 0;\n\t\t}\n\t\t\n\t\tif(val > this.config.max){\n\t\t\tval = this.config.max;\n\t\t}\n\t\tthis.form.val(val);\n\t\t\n\t\tthis.gauge.width(percent);\n\t\tthis.fireEvent(this, 'update', [this, val]);\n\t},\n\tsetMax: function(max){\n\t\tthis.config.max = max;\n\t},\n\tdisabled: function(){\n\t\tthis.el.addClass('ui-disabled');\n\t\tthis.fireEvent(this, 'disabled', [this]);\n\t},\n\tenabled: function(){\n\t\tthis.el.removeClass('ui-disabled');\n\t\tthis.fireEvent(this, 'enabled', [this]);\n\t}\n});\n\nX.util.cm.addCString('progressbar', X.ui.Progressbar);\n\n\nX.ui.Spinner = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tmin: 0,\n\t\t\tmax: 100,\n\t\t\tstep: 1,\n\t\t\tdefaultValue: 0\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.Spinner.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.Spinner.base.render.call(this);\n\t\tthis.el.addClass('ui-spinner').width(this.config.width);\n\t\t\n\t\tthis.formCreate();\n\t\tthis.handleCreate();\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', []);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'number',\n\t\t\tmin: this.config.min,\n\t\t\tmax: this.config.max,\n\t\t\tvalue: this.config.defaultValue,\n\t\t\tstep: this.config.step\n\t\t});\n\t\tthis.formcontin.append(this.form);\n\t\t\n\t\tthis.form.bind('change', { me: this }, this._change);\n\t},\n\t_change: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tif(val < me.config.min){\n\t\t\tval = me.config.min\n\t\t\tme.form.val(val);\n\t\t}\n\t\telse if(val > me.config.max){\n\t\t\tval = me.config.max;\n\t\t\tme.form.val(val);\n\t\t}\n\t\t\n\t\tme.fireEvent(me, 'change', [me,  val]);\n\t},\n\thandleCreate: function(){\n\t\tvar plus = X.util.em.get()\n\t\t\t.html('+').addClass('ui-spinner-btn ui-spinner-plus');\n\n\t\tthis.formcontin.append(plus);\n\t\t\n\t\t\n\t\tvar minus = X.util.em.get()\n\t\t\t.html('-').addClass('ui-spinner-btn ui-spinner-minus');\n\n\t\tthis.formcontin.append(minus);\n\t\t\n\t\tplus.bind(X.events.start, { me: this }, this.plus);\n\t\tminus.bind(X.events.start, { me: this }, this.minus);\n\t},\n\tend: function(e){\n\t\tvar me = e.data.me;\n\t\tme.clearTimer();\n\t\t\n\t\treturn false;\n\t},\n\tclearTimer: function(){\n\t\tif(this.interval){\n\t\t\twindow.clearInterval(this.interval);\n\t\t\tthis.interval = null;\n\t\t}\n\n\t\tX.getDoc().off(X.events.end, {me: this}, this.end);\n\t},\n\ttimer: function(e, flag){\n\t\tif(!this.interval){\n\t\t\tvar me = this;\n\t\t\tthis.interval = window.setInterval(function(){\n\t\t\t\tme[flag](e);\n\t\t\t}, 100);\n\t\t}\n\t},\n\tplus: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tvar result = val + me.config.step;\n\t\t\n\t\tif(result > me.config.max){\n\t\t\tresult = me.config.max;\n\t\t}\n\t\t\n\t\tresult = parseFloat(result.toFixed(1), 10);\n\t\tme.form.val(result);\n\n\t\tme.timer(e, 'plus');\n\t\t\n\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\treturn false;\n\t},\n\tminus: function(e){\n\t\tvar me = e.data.me,\n\t\t\tval = parseFloat(me.form.val(), 10) || 0;\n\t\t\n\t\tvar result = val - me.config.step;\n\t\t\n\t\tif(result < me.config.min){\n\t\t\tresult = me.config.min;\n\t\t}\n\t\t\n\t\tresult = parseFloat(result.toFixed(1), 10);\n\t\tme.form.val(result);\n\t\t\n\t\tme.timer(e, 'minus');\n\n\t\tX.getDoc().on(X.events.end, {me: me}, me.end);\n\t\treturn false;\n\t},\n\tsetValue: function(val){\n\t\tif (this.el.hasClass('ui-disabled')) {\n\t\t\treturn;\n\t\t}\n\t\tif(!val){\n\t\t\tval = 0;\n\t\t}\n\n\t\tif(val < this.config.min){\n\t\t\tval = this.config.min;\n\t\t}\n\t\tif(val > this.config.max){\n\t\t\tval = this.config.max;\n\t\t}\n\t\t\n\t\tthis.form.val(val);\n\t\t\n\t\tthis.fireEvent(this, 'change', [this,  val]);\n\t},\n\tsetMax: function(max){\n\t\tif(X.type(max) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.max = max;\n\t\tthis.form.attr('max', max);\n\t},\n\tsetMin: function(min){\n\t\tif(X.type(min) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.min = min;\n\t\tthis.form.attr('min', min);\n\t},\n\tgetMax: function(){\n\t\treturn this.config.max;\n\t},\n\tgetMin: function(){\n\t\treturn this.config.min;\n\t},\n\tsetStep: function(step){\n\t\tif(X.type(step) !== 'number'){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.config.step = step;\n\t\tthis.form.attr('step', step);\n\t}\n});\n\nX.util.cm.addCString('spinner', X.ui.Spinner);\n\n\nX.ui.SwitchBox = X.extend(X.ui.Form, {\n\tinitialize: function(config){\n\t\tthis.config = {\n\t\t\tchecked: false,\n\t\t\ton: 'ON',\n\t\t\toff: 'OFF'\n\t\t};\n\t\tX.apply(this.config, config);\n\t\tX.ui.SwitchBox.base.initialize.call(this, this.config);\n\t},\n\trender: function(){\n\t\tX.ui.SwitchBox.base.render.call(this);\n\t\tthis.el.addClass('ui-switchbox').width(this.config.width);\n\t\tthis.formCreate();\n\n\t\tthis.handle = X.util.em.get().addClass('ui-switchbox-handle');\n\t\tthis.text = X.util.em.get({tag: 'span'}).addClass('ui-switchbox-text');\n\t\t\n\n\t\tthis.formcontin.append(this.text)\n\t\t\t.append(this.handle);\n\t\t\n\t\tthis.el.bind('vclick', { me: this }, this._change);\n\n\t\tif(this.config.checked){\n\t\t\tthis.el.addClass('on');\n\t\t}\n\t\telse{\n\t\t\tthis.el.addClass('off');\n\t\t}\n\n\t\tthis.setText();\n\n\t\tif(this.config.disabled){\n\t\t\tthis.disabled();\n\t\t}\n\t\t\n\t\tthis.fireEvent(this, 'afterrender', [this]);\n\t},\n\tformCreate: function(){\n\t\tthis.form = X.util.em.get({\n\t\t\ttag: 'input',\n\t\t\ttype: 'checkbox',\n\t\t\tchecked: this.config.checked\n\t\t}).hide();\n\t\tthis.formcontin.append(this.form);\n\t},\n\t_change: function(e){\n\t\tvar me = e.data.me,\n\t\t\tel = me.el;\n\n\t\tif(me.el.hasClass('on')){\n\t\t\tme.unchecked();\n\t\t}\n\t\telse{\n\t\t\tme.checked();\n\t\t}\n\t},\n\tsetOn: function(on){\n\t\tthis.config.on = on;\n\t},\n\tsetOff: function(off){\n\t\tthis.config.off = off;\n\t},\n\tsetText: function(){\n\t\tvar text;\n\t\tif(this.el.hasClass('on')){\n\t\t\ttext = this.config.on;\n\t\t}\n\t\telse{\n\t\t\ttext = this.config.off;\n\t\t}\n\n\t\tthis.text.html(text);\n\t},\n\ttoggle: function(){\n\t\tif(this.el.hasClass('on')){\n\t\t\tthis.unchecked();\n\t\t}\n\t\telse{\n\t\t\tthis.checked();\n\t\t}\n\t},\n\tchecked: function(){\n\t\tif(this.el.hasClass('ui-disabled')){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.el.removeClass('off').addClass('on');\n\t\t\n\t\tthis.setText();\n\t\tthis.form.attr('checked', true);\n\n\t\tthis.fireEvent(this, 'change', [this, true]);\n\t},\n\tunchecked: function(){\n\t\tif(this.el.hasClass('ui-disabled')){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.el.removeClass('on').addClass('off');\n\t\t\n\t\tthis.setText();\n\t\tthis.form.attr('checked', false);\n\t\tthis.fireEvent(this, 'change', [this, false]);\n\t},\n\tgetValue: function(){\n\t\treturn this.form.is(':checked');\n\t}\n});\n\nX.util.cm.addCString('switchbox', X.ui.SwitchBox);\n\n(function(){\n\t\n\tvar head = $('head');\n\tfunction SetMeta(name, content){\n\t\tvar meta = $('<meta />');\n\t\tmeta.attr('name', name);\n\t\tmeta.attr('content', content);\n\t\t\n\t\thead.eq(0).append(meta);\n\t}\n\t\n\t\n\t// Non-Retina iPhone, iPod touch, and Android devices\n\t//57\n\t// Non-Retina iPad\n\t//72\n\t// Retina iPhone and iPod touch\n\t//114\n\t// Retina iPad\n\t//144\n\t\n\tfunction SetLink(rel, icon, size){\n\t\tvar link = $('<link />');\n\t\tlink.attr('rel', rel);\n\t\tlink.attr('href', icon);\n\t\t\n\t\tif (size) {\n\t\t\tlink.setAttribute('sizes', size + 'x' + size);\n\t\t}\n\t\thead.eq(0).append(link);\n\t}\t\n\t\n\tX.App = function(config){\n\t\tvar default_config = {\n\t\t\tname: 'Application',\n\t\t\ticon: null,\n\t\t\ticonsize: null,\n\t\t\tsplash: null,\n\t\t\tviewport: true,\n\t\t\tfullscreen: true,\n\t\t\tstatusbar: null,\n\t\t\tready: null,\n\t\t\tinitialScale: 1,\n\t\t\tmaximumScale: 1,\n\t\t\tminimumScale: 1,\n\t\t\tuserScalable: 'no'\n\t\t};\n\t\tconfig = X.apply(default_config, config);\n\n\t\tif(config.viewport){\n\t\t\tSetMeta('viewport', 'initial-scale=' + default_config.initialScale + \n\t\t\t\t\t', maximum-scale=' + default_config.maximumScale + \n\t\t\t\t\t', minimum-scale=' + default_config.minimumScale + \n\t\t\t\t\t', user-scalable=' + default_config.userScalable);\n\t\t}\n\t\tif(config.fullscreen){\n\t\t\tSetMeta('apple-mobile-web-app-capable', 'yes');\n\t\t\tSetMeta('apple-touch-fullscreen', 'yes');\n\t\t}\n\t\t\n\t\tif(config.statusbar){\n\t\t\tSetMeta('apple-mobile-web-app-status-bar-style', config.statusbar);\n\t\t}\n\t\t\n\t\tif(config.splash){\n\t\t\tSetLink('apple-touch-startup-image', config.splash);\n\t\t}\n\t\t\n\t\tif(config.icon){\n\t\t\tSetLink('apple-touch-icon', config.icon, config.iconsize);\n\t\t}\n\t\t\n\t\t\n\t\tif(config.id){\n\t\t\tconfig.id = config.id + config.name;\n\t\t}\n\n\t\tX.getDoc().ready(function(){\n\t\t\tvar default_config = {\n\t\t\t\tid: config.id,\n\t\t\t\tel: 'body',\n\t\t\t\tautoSize: true,\n\t\t\t\tautoRender: true,\n\t\t\t\tscroll: false\n\t\t\t};\n\t\t\t\n\t\t\tdefault_config = X.apply(default_config, config.viewConfig);\n\t\n\t\t\t\n\t\t\tX.App.View = new X.View(default_config);\n\n\t\t\tX.getDoc().on('vclick', 'a', { view: X.App.View }, function(e){\n\t\t\t\tvar el = $(this),\n\t\t\t\t\thref = el.attr('href'),\n\t\t\t\t\ttransition = el.data('transition') || 'slide',\n\t\t\t\t\thistory = el.data('history') === false ? false : true,\n\t\t\t\t\tback = el.data('back'),\n\t\t\t\t\trel = el.attr('rel'),\n\t\t\t\t\tparents, vc;\n\t\t\t\t\n\t\t\t\tif(!href){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(rel === \"external\"){\n\t\t\t\t\tif(!X.platform.isDesktop){\n\t\t\t\t\t\tvar href = el.attr(\"href\");\n\t\t\t\t\t\thref = href.replace(\"emulIndex\", \"mssIndex\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tel.attr(\"href\", href);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(href.match(/^tel\\:/)){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tparents = el.parents('.ui-view');\n\t\t\t\tparents.each(function(){\n\t\t\t\t\tvar id = this.id;\n\t\t\t\t\tvar view = X.util.cm.get(id);\n\t\t\t\t\tvc = view.getViewController();\n\t\t\t\t\tif(vc){\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(!vc){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(back && href === '#'){\n\t\t\t\t\tvc.backPage();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(href !== '#' && back){\n\t\t\t\t\tvc.prevPage({ url: href });\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\n\t\t\t\tif(href === '#' || !href){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvc.nextPage({\n\t\t\t\t\turl: href,\n\t\t\t\t\ttransition: transition,\n\t\t\t\t\thistory: history\n\t\t\t\t});\n\t\n\t\t\t\treturn false;\n\t\t\t});\n\n\n\t\t\tif(config.ready){\n\t\t\t\tconfig.ready(X.App.View);\n\t\t\t}\n\n\t\t\tconfig = null;\n\n\t\t\tX.getDoc().bind('orientationchange', function(e){\n\t\t\t\treturn false;\n\t\t\t});\n\t\t});\n\t};\n\t\n\tX.getApp = function(){\n\t\tif(X.App.View){\n\t\t\treturn X.App.View;\n\t\t}\n\t\treturn null;\n\t};\n})();"],[1,"(function(){var t=this;var e=t.Backbone;var i=[];var r=i.push;var s=i.slice;var n=i.splice;var a;if(typeof exports!==\"undefined\"){a=exports}else{a=t.Backbone={}}a.VERSION=\"1.1.0\";var h=t._;if(!h&&typeof require!==\"undefined\")h=require(\"underscore\");a.$=t.jQuery||t.Zepto||t.ender||t.$;a.noConflict=function(){t.Backbone=e;return this};a.emulateHTTP=false;a.emulateJSON=false;var o=a.Events={on:function(t,e,i){if(!l(this,\"on\",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);r.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!l(this,\"once\",t,[e,i])||!e)return this;var r=this;var s=h.once(function(){r.off(t,s);e.apply(this,arguments)});s._callback=e;return this.on(t,s,i)},off:function(t,e,i){var r,s,n,a,o,u,c,f;if(!this._events||!l(this,\"off\",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}a=t?[t]:h.keys(this._events);for(o=0,u=a.length;o<u;o++){t=a[o];if(n=this._events[t]){this._events[t]=r=[];if(e||i){for(c=0,f=n.length;c<f;c++){s=n[c];if(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context){r.push(s)}}}if(!r.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,\"trigger\",t,e))return this;var i=this._events[t];var r=this._events.all;if(i)c(i,e);if(r)c(r,arguments);return this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var s=!e&&!i;if(!i&&typeof e===\"object\")i=this;if(t)(r={})[t._listenId]=t;for(var n in r){t=r[n];t.off(e,i,this);if(s||h.isEmpty(t._events))delete this._listeningTo[n]}return this}};var u=/\\s+/;var l=function(t,e,i,r){if(!i)return true;if(typeof i===\"object\"){for(var s in i){t[e].apply(t,[s,i[s]].concat(r))}return false}if(u.test(i)){var n=i.split(u);for(var a=0,h=n.length;a<h;a++){t[e].apply(t,[n[a]].concat(r))}return false}return true};var c=function(t,e){var i,r=-1,s=t.length,n=e[0],a=e[1],h=e[2];switch(e.length){case 0:while(++r<s)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<s)(i=t[r]).callback.call(i.ctx,n);return;case 2:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a);return;case 3:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a,h);return;default:while(++r<s)(i=t[r]).callback.apply(i.ctx,e)}};var f={listenTo:\"on\",listenToOnce:\"once\"};h.each(f,function(t,e){o[e]=function(e,i,r){var s=this._listeningTo||(this._listeningTo={});var n=e._listenId||(e._listenId=h.uniqueId(\"l\"));s[n]=e;if(!r&&typeof i===\"object\")r=this;e[t](i,r,this);return this}});o.bind=o.on;o.unbind=o.off;h.extend(a,o);var d=a.Model=function(t,e){var i=t||{};e||(e={});this.cid=h.uniqueId(\"c\");this.attributes={};if(e.collection)this.collection=e.collection;if(e.parse)i=this.parse(i,e)||{};i=h.defaults({},i,h.result(this,\"defaults\"));this.set(i,e);this.changed={};this.initialize.apply(this,arguments)};h.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:\"id\",initialize:function(){},toJSON:function(t){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return h.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var r,s,n,a,o,u,l,c;if(t==null)return this;if(typeof t===\"object\"){s=t;i=e}else{(s={})[t]=e}i||(i={});if(!this._validate(s,i))return false;n=i.unset;o=i.silent;a=[];u=this._changing;this._changing=true;if(!u){this._previousAttributes=h.clone(this.attributes);this.changed={}}c=this.attributes,l=this._previousAttributes;if(this.idAttribute in s)this.id=s[this.idAttribute];for(r in s){e=s[r];if(!h.isEqual(c[r],e))a.push(r);if(!h.isEqual(l[r],e)){this.changed[r]=e}else{delete this.changed[r]}n?delete c[r]:c[r]=e}if(!o){if(a.length)this._pending=true;for(var f=0,d=a.length;f<d;f++){this.trigger(\"change:\"+a[f],this,c[a[f]],i)}}if(u)return this;if(!o){while(this._pending){this._pending=false;this.trigger(\"change\",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,h.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,h.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!h.isEmpty(this.changed);return h.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?h.clone(this.changed):false;var e,i=false;var r=this._changing?this._previousAttributes:this.attributes;for(var s in t){if(h.isEqual(r[s],e=t[s]))continue;(i||(i={}))[s]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(r){if(!e.set(e.parse(r,t),t))return false;if(i)i(e,r,t);e.trigger(\"sync\",e,r,t)};M(this,t);return this.sync(\"read\",this,t)},save:function(t,e,i){var r,s,n,a=this.attributes;if(t==null||typeof t===\"object\"){r=t;i=e}else{(r={})[t]=e}i=h.extend({validate:true},i);if(r&&!i.wait){if(!this.set(r,i))return false}else{if(!this._validate(r,i))return false}if(r&&i.wait){this.attributes=h.extend({},a,r)}if(i.parse===void 0)i.parse=true;var o=this;var u=i.success;i.success=function(t){o.attributes=a;var e=o.parse(t,i);if(i.wait)e=h.extend(r||{},e);if(h.isObject(e)&&!o.set(e,i)){return false}if(u)u(o,t,i);o.trigger(\"sync\",o,t,i)};M(this,i);s=this.isNew()?\"create\":i.patch?\"patch\":\"update\";if(s===\"patch\")i.attrs=r;n=this.sync(s,this,i);if(r&&i.wait)this.attributes=a;return n},destroy:function(t){t=t?h.clone(t):{};var e=this;var i=t.success;var r=function(){e.trigger(\"destroy\",e,e.collection,t)};t.success=function(s){if(t.wait||e.isNew())r();if(i)i(e,s,t);if(!e.isNew())e.trigger(\"sync\",e,s,t)};if(this.isNew()){t.success();return false}M(this,t);var s=this.sync(\"delete\",this,t);if(!t.wait)r();return s},url:function(){var t=h.result(this,\"urlRoot\")||h.result(this.collection,\"url\")||U();if(this.isNew())return t;return t+(t.charAt(t.length-1)===\"/\"?\"\":\"/\")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},h.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=h.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger(\"invalid\",this,i,h.extend(e,{validationError:i}));return false}});var p=[\"keys\",\"values\",\"pairs\",\"invert\",\"pick\",\"omit\"];h.each(p,function(t){d.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.attributes);return h[t].apply(h,e)}});var v=a.Collection=function(t,e){e||(e={});if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,h.extend({silent:true},e))};var g={add:true,remove:true,merge:true};var m={add:true,remove:false};h.extend(v.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,h.extend({merge:false},e,m))},remove:function(t,e){var i=!h.isArray(t);t=i?[t]:h.clone(t);e||(e={});var r,s,n,a;for(r=0,s=t.length;r<s;r++){a=t[r]=this.get(t[r]);if(!a)continue;delete this._byId[a.id];delete this._byId[a.cid];n=this.indexOf(a);this.models.splice(n,1);this.length--;if(!e.silent){e.index=n;a.trigger(\"remove\",a,this,e)}this._removeReference(a)}return i?t[0]:t},set:function(t,e){e=h.defaults({},e,g);if(e.parse)t=this.parse(t,e);var i=!h.isArray(t);t=i?t?[t]:[]:h.clone(t);var r,s,n,a,o,u,l;var c=e.at;var f=this.model;var p=this.comparator&&c==null&&e.sort!==false;var v=h.isString(this.comparator)?this.comparator:null;var m=[],y=[],_={};var w=e.add,b=e.merge,x=e.remove;var E=!p&&w&&x?[]:false;for(r=0,s=t.length;r<s;r++){o=t[r];if(o instanceof d){n=a=o}else{n=o[f.prototype.idAttribute]}if(u=this.get(n)){if(x)_[u.cid]=true;if(b){o=o===a?a.attributes:o;if(e.parse)o=u.parse(o,e);u.set(o,e);if(p&&!l&&u.hasChanged(v))l=true}t[r]=u}else if(w){a=t[r]=this._prepareModel(o,e);if(!a)continue;m.push(a);a.on(\"all\",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}if(E)E.push(u||a)}if(x){for(r=0,s=this.length;r<s;++r){if(!_[(a=this.models[r]).cid])y.push(a)}if(y.length)this.remove(y,e)}if(m.length||E&&E.length){if(p)l=true;this.length+=m.length;if(c!=null){for(r=0,s=m.length;r<s;r++){this.models.splice(c+r,0,m[r])}}else{if(E)this.models.length=0;var T=E||m;for(r=0,s=T.length;r<s;r++){this.models.push(T[r])}}}if(l)this.sort({silent:true});if(!e.silent){for(r=0,s=m.length;r<s;r++){(a=m[r]).trigger(\"add\",a,this,e)}if(l||E&&E.length)this.trigger(\"sort\",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();t=this.add(t,h.extend({silent:true},e));if(!e.silent)this.trigger(\"reset\",this,e);return t},push:function(t,e){return this.add(t,h.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){return this.add(t,h.extend({at:0},e))},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(t==null)return void 0;return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){if(h.isEmpty(t))return e?void 0:[];return this[e?\"find\":\"filter\"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error(\"Cannot sort a set without a comparator\");t||(t={});if(h.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(h.bind(this.comparator,this))}if(!t.silent)this.trigger(\"sort\",this,t);return this},pluck:function(t){return h.invoke(this.models,\"get\",t)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(r){var s=t.reset?\"reset\":\"set\";i[s](r,t);if(e)e(i,r,t);i.trigger(\"sync\",i,r,t)};M(this,t);return this.sync(\"read\",this,t)},create:function(t,e){e=e?h.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var r=e.success;e.success=function(t,e,s){if(s.wait)i.add(t,s);if(r)r(t,e,s)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof d){if(!t.collection)t.collection=this;return t}e=e?h.clone(e):{};e.collection=this;var i=new this.model(t,e);if(!i.validationError)return i;this.trigger(\"invalid\",this,i.validationError,e);return false},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off(\"all\",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t===\"add\"||t===\"remove\")&&i!==this)return;if(t===\"destroy\")this.remove(e,r);if(e&&t===\"change:\"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var y=[\"forEach\",\"each\",\"map\",\"collect\",\"reduce\",\"foldl\",\"inject\",\"reduceRight\",\"foldr\",\"find\",\"detect\",\"filter\",\"select\",\"reject\",\"every\",\"all\",\"some\",\"any\",\"include\",\"contains\",\"invoke\",\"max\",\"min\",\"toArray\",\"size\",\"first\",\"head\",\"take\",\"initial\",\"rest\",\"tail\",\"drop\",\"last\",\"without\",\"difference\",\"indexOf\",\"shuffle\",\"lastIndexOf\",\"isEmpty\",\"chain\"];h.each(y,function(t){v.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.models);return h[t].apply(h,e)}});var _=[\"groupBy\",\"countBy\",\"sortBy\"];h.each(_,function(t){v.prototype[t]=function(e,i){var r=h.isFunction(e)?e:function(t){return t.get(e)};return h[t](this.models,r,i)}});var w=a.View=function(t){this.cid=h.uniqueId(\"view\");t||(t={});h.extend(this,h.pick(t,x));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var b=/^(\\S+)\\s*(.*)$/;var x=[\"model\",\"collection\",\"el\",\"id\",\"attributes\",\"className\",\"tagName\",\"events\"];h.extend(w.prototype,o,{tagName:\"div\",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){if(this.$el)this.undelegateEvents();this.$el=t instanceof a.$?t:a.$(t);this.el=this.$el[0];if(e!==false)this.delegateEvents();return this},delegateEvents:function(t){if(!(t||(t=h.result(this,\"events\"))))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(!h.isFunction(i))i=this[t[e]];if(!i)continue;var r=e.match(b);var s=r[1],n=r[2];i=h.bind(i,this);s+=\".delegateEvents\"+this.cid;if(n===\"\"){this.$el.on(s,i)}else{this.$el.on(s,n,i)}}return this},undelegateEvents:function(){this.$el.off(\".delegateEvents\"+this.cid);return this},_ensureElement:function(){if(!this.el){var t=h.extend({},h.result(this,\"attributes\"));if(this.id)t.id=h.result(this,\"id\");if(this.className)t[\"class\"]=h.result(this,\"className\");var e=a.$(\"<\"+h.result(this,\"tagName\")+\">\").attr(t);this.setElement(e,false)}else{this.setElement(h.result(this,\"el\"),false)}}});a.sync=function(t,e,i){var r=T[t];h.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var s={type:r,dataType:\"json\"};if(!i.url){s.url=h.result(e,\"url\")||U()}if(i.data==null&&e&&(t===\"create\"||t===\"update\"||t===\"patch\")){s.contentType=\"application/json\";s.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){s.contentType=\"application/x-www-form-urlencoded\";s.data=s.data?{model:s.data}:{}}if(i.emulateHTTP&&(r===\"PUT\"||r===\"DELETE\"||r===\"PATCH\")){s.type=\"POST\";if(i.emulateJSON)s.data._method=r;var n=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader(\"X-HTTP-Method-Override\",r);if(n)return n.apply(this,arguments)}}if(s.type!==\"GET\"&&!i.emulateJSON){s.processData=false}if(s.type===\"PATCH\"&&E){s.xhr=function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}}var o=i.xhr=a.ajax(h.extend(s,i));e.trigger(\"request\",e,o,i);return o};var E=typeof window!==\"undefined\"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var T={create:\"POST\",update:\"PUT\",patch:\"PATCH\",\"delete\":\"DELETE\",read:\"GET\"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var k=a.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var S=/\\((.*?)\\)/g;var $=/(\\(\\?)?:\\w+/g;var H=/\\*\\w+/g;var A=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;h.extend(k.prototype,o,{initialize:function(){},route:function(t,e,i){if(!h.isRegExp(t))t=this._routeToRegExp(t);if(h.isFunction(e)){i=e;e=\"\"}if(!i)i=this[e];var r=this;a.history.route(t,function(s){var n=r._extractParameters(t,s);i&&i.apply(r,n);r.trigger.apply(r,[\"route:\"+e].concat(n));r.trigger(\"route\",e,n);a.history.trigger(\"route\",r,e,n)});return this},navigate:function(t,e){a.history.navigate(t,e);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=h.result(this,\"routes\");var t,e=h.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(A,\"\\\\$&\").replace(S,\"(?:$1)?\").replace($,function(t,e){return e?t:\"([^/]+)\"}).replace(H,\"(.*?)\");return new RegExp(\"^\"+t+\"$\")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return h.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=a.History=function(){this.handlers=[];h.bindAll(this,\"checkUrl\");if(typeof window!==\"undefined\"){this.location=window.location;this.history=window.history}};var N=/^[#\\/]|\\s+$/g;var O=/^\\/+|\\/+$/g;var P=/msie [\\w.]+/;var C=/\\/$/;var j=/[?#].*$/;I.started=false;h.extend(I.prototype,o,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:\"\"},getFragment:function(t,e){if(t==null){if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,\"\");if(!t.indexOf(i))t=t.slice(i.length)}else{t=this.getHash()}}return t.replace(N,\"\")},start:function(t){if(I.started)throw new Error(\"Backbone.history has already been started\");I.started=true;this.options=h.extend({root:\"/\"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment();var i=document.documentMode;var r=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=(\"/\"+this.root+\"/\").replace(O,\"/\");if(r&&this._wantsHashChange){this.iframe=a.$('<iframe src=\"javascript:0\" tabindex=\"-1\" />').hide().appendTo(\"body\")[0].contentWindow;this.navigate(e)}if(this._hasPushState){a.$(window).on(\"popstate\",this.checkUrl)}else if(this._wantsHashChange&&\"onhashchange\"in window&&!r){a.$(window).on(\"hashchange\",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=e;var s=this.location;var n=s.pathname.replace(/[^\\/]$/,\"$&/\")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!n){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+\"#\"+this.fragment);return true}else if(this._hasPushState&&n&&s.hash){this.fragment=this.getHash().replace(N,\"\");this.history.replaceState({},document.title,this.root+this.fragment+s.search)}}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off(\"popstate\",this.checkUrl).off(\"hashchange\",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getFragment(this.getHash(this.iframe))}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()},loadUrl:function(t){t=this.fragment=this.getFragment(t);return h.any(this.handlers,function(e){if(e.route.test(t)){e.callback(t);return true}})},navigate:function(t,e){if(!I.started)return false;if(!e||e===true)e={trigger:!!e};var i=this.root+(t=this.getFragment(t||\"\"));t=t.replace(j,\"\");if(this.fragment===t)return;this.fragment=t;if(t===\"\"&&i!==\"/\")i=i.slice(0,-1);if(this._hasPushState){this.history[e.replace?\"replaceState\":\"pushState\"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){if(!e.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}else{return this.location.assign(i)}if(e.trigger)return this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,\"\");t.replace(r+\"#\"+e)}else{t.hash=\"#\"+e}}});a.history=new I;var R=function(t,e){var i=this;var r;if(t&&h.has(t,\"constructor\")){r=t.constructor}else{r=function(){return i.apply(this,arguments)}}h.extend(r,i,e);var s=function(){this.constructor=r};s.prototype=i.prototype;r.prototype=new s;if(t)h.extend(r.prototype,t);r.__super__=i.prototype;return r};d.extend=v.extend=k.extend=w.extend=I.extend=R;var U=function(){throw new Error('A \"url\" property or function must be specified')};var M=function(t,e){var i=e.error;e.error=function(r){if(i)i(t,r,e);t.trigger(\"error\",t,r,e)}}}).call(this);\r\n//# sourceMappingURL=backbone-min.map"]],"start1":0,"start2":0,"length1":72788,"length2":19549}]],"length":19549,"saved":false}
{"contributors":[],"silentsave":false,"ts":1382330465220,"patch":[[{"diffs":[[-1,"(function(){var t=this;var e=t.Backbone;var i=[];var r=i.push;var s=i.slice;var n=i.splice;var a;if(typeof exports!==\"undefined\"){a=exports}else{a=t.Backbone={}}a.VERSION=\"1.1.0\";var h=t._;if(!h&&typeof require!==\"undefined\")h=require(\"underscore\");a.$=t.jQuery||t.Zepto||t.ender||t.$;a.noConflict=function(){t.Backbone=e;return this};a.emulateHTTP=false;a.emulateJSON=false;var o=a.Events={on:function(t,e,i){if(!l(this,\"on\",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);r.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!l(this,\"once\",t,[e,i])||!e)return this;var r=this;var s=h.once(function(){r.off(t,s);e.apply(this,arguments)});s._callback=e;return this.on(t,s,i)},off:function(t,e,i){var r,s,n,a,o,u,c,f;if(!this._events||!l(this,\"off\",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}a=t?[t]:h.keys(this._events);for(o=0,u=a.length;o<u;o++){t=a[o];if(n=this._events[t]){this._events[t]=r=[];if(e||i){for(c=0,f=n.length;c<f;c++){s=n[c];if(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context){r.push(s)}}}if(!r.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,\"trigger\",t,e))return this;var i=this._events[t];var r=this._events.all;if(i)c(i,e);if(r)c(r,arguments);return this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var s=!e&&!i;if(!i&&typeof e===\"object\")i=this;if(t)(r={})[t._listenId]=t;for(var n in r){t=r[n];t.off(e,i,this);if(s||h.isEmpty(t._events))delete this._listeningTo[n]}return this}};var u=/\\s+/;var l=function(t,e,i,r){if(!i)return true;if(typeof i===\"object\"){for(var s in i){t[e].apply(t,[s,i[s]].concat(r))}return false}if(u.test(i)){var n=i.split(u);for(var a=0,h=n.length;a<h;a++){t[e].apply(t,[n[a]].concat(r))}return false}return true};var c=function(t,e){var i,r=-1,s=t.length,n=e[0],a=e[1],h=e[2];switch(e.length){case 0:while(++r<s)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<s)(i=t[r]).callback.call(i.ctx,n);return;case 2:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a);return;case 3:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a,h);return;default:while(++r<s)(i=t[r]).callback.apply(i.ctx,e)}};var f={listenTo:\"on\",listenToOnce:\"once\"};h.each(f,function(t,e){o[e]=function(e,i,r){var s=this._listeningTo||(this._listeningTo={});var n=e._listenId||(e._listenId=h.uniqueId(\"l\"));s[n]=e;if(!r&&typeof i===\"object\")r=this;e[t](i,r,this);return this}});o.bind=o.on;o.unbind=o.off;h.extend(a,o);var d=a.Model=function(t,e){var i=t||{};e||(e={});this.cid=h.uniqueId(\"c\");this.attributes={};if(e.collection)this.collection=e.collection;if(e.parse)i=this.parse(i,e)||{};i=h.defaults({},i,h.result(this,\"defaults\"));this.set(i,e);this.changed={};this.initialize.apply(this,arguments)};h.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:\"id\",initialize:function(){},toJSON:function(t){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return h.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var r,s,n,a,o,u,l,c;if(t==null)return this;if(typeof t===\"object\"){s=t;i=e}else{(s={})[t]=e}i||(i={});if(!this._validate(s,i))return false;n=i.unset;o=i.silent;a=[];u=this._changing;this._changing=true;if(!u){this._previousAttributes=h.clone(this.attributes);this.changed={}}c=this.attributes,l=this._previousAttributes;if(this.idAttribute in s)this.id=s[this.idAttribute];for(r in s){e=s[r];if(!h.isEqual(c[r],e))a.push(r);if(!h.isEqual(l[r],e)){this.changed[r]=e}else{delete this.changed[r]}n?delete c[r]:c[r]=e}if(!o){if(a.length)this._pending=true;for(var f=0,d=a.length;f<d;f++){this.trigger(\"change:\"+a[f],this,c[a[f]],i)}}if(u)return this;if(!o){while(this._pending){this._pending=false;this.trigger(\"change\",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,h.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,h.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!h.isEmpty(this.changed);return h.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?h.clone(this.changed):false;var e,i=false;var r=this._changing?this._previousAttributes:this.attributes;for(var s in t){if(h.isEqual(r[s],e=t[s]))continue;(i||(i={}))[s]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(r){if(!e.set(e.parse(r,t),t))return false;if(i)i(e,r,t);e.trigger(\"sync\",e,r,t)};M(this,t);return this.sync(\"read\",this,t)},save:function(t,e,i){var r,s,n,a=this.attributes;if(t==null||typeof t===\"object\"){r=t;i=e}else{(r={})[t]=e}i=h.extend({validate:true},i);if(r&&!i.wait){if(!this.set(r,i))return false}else{if(!this._validate(r,i))return false}if(r&&i.wait){this.attributes=h.extend({},a,r)}if(i.parse===void 0)i.parse=true;var o=this;var u=i.success;i.success=function(t){o.attributes=a;var e=o.parse(t,i);if(i.wait)e=h.extend(r||{},e);if(h.isObject(e)&&!o.set(e,i)){return false}if(u)u(o,t,i);o.trigger(\"sync\",o,t,i)};M(this,i);s=this.isNew()?\"create\":i.patch?\"patch\":\"update\";if(s===\"patch\")i.attrs=r;n=this.sync(s,this,i);if(r&&i.wait)this.attributes=a;return n},destroy:function(t){t=t?h.clone(t):{};var e=this;var i=t.success;var r=function(){e.trigger(\"destroy\",e,e.collection,t)};t.success=function(s){if(t.wait||e.isNew())r();if(i)i(e,s,t);if(!e.isNew())e.trigger(\"sync\",e,s,t)};if(this.isNew()){t.success();return false}M(this,t);var s=this.sync(\"delete\",this,t);if(!t.wait)r();return s},url:function(){var t=h.result(this,\"urlRoot\")||h.result(this.collection,\"url\")||U();if(this.isNew())return t;return t+(t.charAt(t.length-1)===\"/\"?\"\":\"/\")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},h.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=h.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger(\"invalid\",this,i,h.extend(e,{validationError:i}));return false}});var p=[\"keys\",\"values\",\"pairs\",\"invert\",\"pick\",\"omit\"];h.each(p,function(t){d.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.attributes);return h[t].apply(h,e)}});var v=a.Collection=function(t,e){e||(e={});if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,h.extend({silent:true},e))};var g={add:true,remove:true,merge:true};var m={add:true,remove:false};h.extend(v.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,h.extend({merge:false},e,m))},remove:function(t,e){var i=!h.isArray(t);t=i?[t]:h.clone(t);e||(e={});var r,s,n,a;for(r=0,s=t.length;r<s;r++){a=t[r]=this.get(t[r]);if(!a)continue;delete this._byId[a.id];delete this._byId[a.cid];n=this.indexOf(a);this.models.splice(n,1);this.length--;if(!e.silent){e.index=n;a.trigger(\"remove\",a,this,e)}this._removeReference(a)}return i?t[0]:t},set:function(t,e){e=h.defaults({},e,g);if(e.parse)t=this.parse(t,e);var i=!h.isArray(t);t=i?t?[t]:[]:h.clone(t);var r,s,n,a,o,u,l;var c=e.at;var f=this.model;var p=this.comparator&&c==null&&e.sort!==false;var v=h.isString(this.comparator)?this.comparator:null;var m=[],y=[],_={};var w=e.add,b=e.merge,x=e.remove;var E=!p&&w&&x?[]:false;for(r=0,s=t.length;r<s;r++){o=t[r];if(o instanceof d){n=a=o}else{n=o[f.prototype.idAttribute]}if(u=this.get(n)){if(x)_[u.cid]=true;if(b){o=o===a?a.attributes:o;if(e.parse)o=u.parse(o,e);u.set(o,e);if(p&&!l&&u.hasChanged(v))l=true}t[r]=u}else if(w){a=t[r]=this._prepareModel(o,e);if(!a)continue;m.push(a);a.on(\"all\",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}if(E)E.push(u||a)}if(x){for(r=0,s=this.length;r<s;++r){if(!_[(a=this.models[r]).cid])y.push(a)}if(y.length)this.remove(y,e)}if(m.length||E&&E.length){if(p)l=true;this.length+=m.length;if(c!=null){for(r=0,s=m.length;r<s;r++){this.models.splice(c+r,0,m[r])}}else{if(E)this.models.length=0;var T=E||m;for(r=0,s=T.length;r<s;r++){this.models.push(T[r])}}}if(l)this.sort({silent:true});if(!e.silent){for(r=0,s=m.length;r<s;r++){(a=m[r]).trigger(\"add\",a,this,e)}if(l||E&&E.length)this.trigger(\"sort\",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();t=this.add(t,h.extend({silent:true},e));if(!e.silent)this.trigger(\"reset\",this,e);return t},push:function(t,e){return this.add(t,h.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){return this.add(t,h.extend({at:0},e))},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(t==null)return void 0;return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){if(h.isEmpty(t))return e?void 0:[];return this[e?\"find\":\"filter\"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error(\"Cannot sort a set without a comparator\");t||(t={});if(h.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(h.bind(this.comparator,this))}if(!t.silent)this.trigger(\"sort\",this,t);return this},pluck:function(t){return h.invoke(this.models,\"get\",t)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(r){var s=t.reset?\"reset\":\"set\";i[s](r,t);if(e)e(i,r,t);i.trigger(\"sync\",i,r,t)};M(this,t);return this.sync(\"read\",this,t)},create:function(t,e){e=e?h.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var r=e.success;e.success=function(t,e,s){if(s.wait)i.add(t,s);if(r)r(t,e,s)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof d){if(!t.collection)t.collection=this;return t}e=e?h.clone(e):{};e.collection=this;var i=new this.model(t,e);if(!i.validationError)return i;this.trigger(\"invalid\",this,i.validationError,e);return false},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off(\"all\",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t===\"add\"||t===\"remove\")&&i!==this)return;if(t===\"destroy\")this.remove(e,r);if(e&&t===\"change:\"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var y=[\"forEach\",\"each\",\"map\",\"collect\",\"reduce\",\"foldl\",\"inject\",\"reduceRight\",\"foldr\",\"find\",\"detect\",\"filter\",\"select\",\"reject\",\"every\",\"all\",\"some\",\"any\",\"include\",\"contains\",\"invoke\",\"max\",\"min\",\"toArray\",\"size\",\"first\",\"head\",\"take\",\"initial\",\"rest\",\"tail\",\"drop\",\"last\",\"without\",\"difference\",\"indexOf\",\"shuffle\",\"lastIndexOf\",\"isEmpty\",\"chain\"];h.each(y,function(t){v.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.models);return h[t].apply(h,e)}});var _=[\"groupBy\",\"countBy\",\"sortBy\"];h.each(_,function(t){v.prototype[t]=function(e,i){var r=h.isFunction(e)?e:function(t){return t.get(e)};return h[t](this.models,r,i)}});var w=a.View=function(t){this.cid=h.uniqueId(\"view\");t||(t={});h.extend(this,h.pick(t,x));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var b=/^(\\S+)\\s*(.*)$/;var x=[\"model\",\"collection\",\"el\",\"id\",\"attributes\",\"className\",\"tagName\",\"events\"];h.extend(w.prototype,o,{tagName:\"div\",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){if(this.$el)this.undelegateEvents();this.$el=t instanceof a.$?t:a.$(t);this.el=this.$el[0];if(e!==false)this.delegateEvents();return this},delegateEvents:function(t){if(!(t||(t=h.result(this,\"events\"))))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(!h.isFunction(i))i=this[t[e]];if(!i)continue;var r=e.match(b);var s=r[1],n=r[2];i=h.bind(i,this);s+=\".delegateEvents\"+this.cid;if(n===\"\"){this.$el.on(s,i)}else{this.$el.on(s,n,i)}}return this},undelegateEvents:function(){this.$el.off(\".delegateEvents\"+this.cid);return this},_ensureElement:function(){if(!this.el){var t=h.extend({},h.result(this,\"attributes\"));if(this.id)t.id=h.result(this,\"id\");if(this.className)t[\"class\"]=h.result(this,\"className\");var e=a.$(\"<\"+h.result(this,\"tagName\")+\">\").attr(t);this.setElement(e,false)}else{this.setElement(h.result(this,\"el\"),false)}}});a.sync=function(t,e,i){var r=T[t];h.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var s={type:r,dataType:\"json\"};if(!i.url){s.url=h.result(e,\"url\")||U()}if(i.data==null&&e&&(t===\"create\"||t===\"update\"||t===\"patch\")){s.contentType=\"application/json\";s.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){s.contentType=\"application/x-www-form-urlencoded\";s.data=s.data?{model:s.data}:{}}if(i.emulateHTTP&&(r===\"PUT\"||r===\"DELETE\"||r===\"PATCH\")){s.type=\"POST\";if(i.emulateJSON)s.data._method=r;var n=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader(\"X-HTTP-Method-Override\",r);if(n)return n.apply(this,arguments)}}if(s.type!==\"GET\"&&!i.emulateJSON){s.processData=false}if(s.type===\"PATCH\"&&E){s.xhr=function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}}var o=i.xhr=a.ajax(h.extend(s,i));e.trigger(\"request\",e,o,i);return o};var E=typeof window!==\"undefined\"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var T={create:\"POST\",update:\"PUT\",patch:\"PATCH\",\"delete\":\"DELETE\",read:\"GET\"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var k=a.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var S=/\\((.*?)\\)/g;var $=/(\\(\\?)?:\\w+/g;var H=/\\*\\w+/g;var A=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;h.extend(k.prototype,o,{initialize:function(){},route:function(t,e,i){if(!h.isRegExp(t))t=this._routeToRegExp(t);if(h.isFunction(e)){i=e;e=\"\"}if(!i)i=this[e];var r=this;a.history.route(t,function(s){var n=r._extractParameters(t,s);i&&i.apply(r,n);r.trigger.apply(r,[\"route:\"+e].concat(n));r.trigger(\"route\",e,n);a.history.trigger(\"route\",r,e,n)});return this},navigate:function(t,e){a.history.navigate(t,e);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=h.result(this,\"routes\");var t,e=h.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(A,\"\\\\$&\").replace(S,\"(?:$1)?\").replace($,function(t,e){return e?t:\"([^/]+)\"}).replace(H,\"(.*?)\");return new RegExp(\"^\"+t+\"$\")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return h.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=a.History=function(){this.handlers=[];h.bindAll(this,\"checkUrl\");if(typeof window!==\"undefined\"){this.location=window.location;this.history=window.history}};var N=/^[#\\/]|\\s+$/g;var O=/^\\/+|\\/+$/g;var P=/msie [\\w.]+/;var C=/\\/$/;var j=/[?#].*$/;I.started=false;h.extend(I.prototype,o,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:\"\"},getFragment:function(t,e){if(t==null){if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,\"\");if(!t.indexOf(i))t=t.slice(i.length)}else{t=this.getHash()}}return t.replace(N,\"\")},start:function(t){if(I.started)throw new Error(\"Backbone.history has already been started\");I.started=true;this.options=h.extend({root:\"/\"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment();var i=document.documentMode;var r=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=(\"/\"+this.root+\"/\").replace(O,\"/\");if(r&&this._wantsHashChange){this.iframe=a.$('<iframe src=\"javascript:0\" tabindex=\"-1\" />').hide().appendTo(\"body\")[0].contentWindow;this.navigate(e)}if(this._hasPushState){a.$(window).on(\"popstate\",this.checkUrl)}else if(this._wantsHashChange&&\"onhashchange\"in window&&!r){a.$(window).on(\"hashchange\",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=e;var s=this.location;var n=s.pathname.replace(/[^\\/]$/,\"$&/\")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!n){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+\"#\"+this.fragment);return true}else if(this._hasPushState&&n&&s.hash){this.fragment=this.getHash().replace(N,\"\");this.history.replaceState({},document.title,this.root+this.fragment+s.search)}}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off(\"popstate\",this.checkUrl).off(\"hashchange\",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getFragment(this.getHash(this.iframe))}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()},loadUrl:function(t){t=this.fragment=this.getFragment(t);return h.any(this.handlers,function(e){if(e.route.test(t)){e.callback(t);return true}})},navigate:function(t,e){if(!I.started)return false;if(!e||e===true)e={trigger:!!e};var i=this.root+(t=this.getFragment(t||\"\"));t=t.replace(j,\"\");if(this.fragment===t)return;this.fragment=t;if(t===\"\"&&i!==\"/\")i=i.slice(0,-1);if(this._hasPushState){this.history[e.replace?\"replaceState\":\"pushState\"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){if(!e.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}else{return this.location.assign(i)}if(e.trigger)return this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,\"\");t.replace(r+\"#\"+e)}else{t.hash=\"#\"+e}}});a.history=new I;var R=function(t,e){var i=this;var r;if(t&&h.has(t,\"constructor\")){r=t.constructor}else{r=function(){return i.apply(this,arguments)}}h.extend(r,i,e);var s=function(){this.constructor=r};s.prototype=i.prototype;r.prototype=new s;if(t)h.extend(r.prototype,t);r.__super__=i.prototype;return r};d.extend=v.extend=k.extend=w.extend=I.extend=R;var U=function(){throw new Error('A \"url\" property or function must be specified')};var M=function(t,e){var i=e.error;e.error=function(r){if(i)i(t,r,e);t.trigger(\"error\",t,r,e)}}}).call(this);\r\n//# sourceMappingURL=backbon"],[1,"//     Underscore.js 1.5.2\r\n//     http://underscorejs.org\r\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\r\n//     Underscore may be freely distributed under the MIT license.\r\n(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?(this._wrapped=n,void 0):new j(n)};\"undefined\"!=typeof exports?(\"undefined\"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION=\"1.5.2\";var A=j.each=j.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E=\"Reduce of empty array with no initial value\";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(E);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(E);return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?\"find\":\"filter\"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return arguments.length<2||r?n[j.random(n.length-1)]:j.shuffle(n).slice(0,Math.max(0,t))};var k=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=k(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),\"value\")};var F=function(n){return function(t,r,e){var u={},i=null==r?j.identity:k(r);return A(t,function(r,a){var o=i.call(e,r,a,t);n(u,o,r)}),u}};j.groupBy=F(function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,\"length\").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,\"\"+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if(\"number\"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error(\"bindAll must be passed function names\");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o;return function(){i=this,u=arguments,a=new Date;var c=function(){var l=new Date-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u)))},l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u)),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=w||function(n){if(n!==Object(n))throw new TypeError(\"Invalid object\");var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case\"[object String]\":return n==String(t);case\"[object Number]\":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case\"[object Date]\":case\"[object Boolean]\":return+n==+t;case\"[object RegExp]\":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if(\"object\"!=typeof n||\"object\"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,f=!0;if(\"[object Array]\"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return\"[object Array]\"==l.call(n)},j.isObject=function(n){return n===Object(n)},A([\"Arguments\",\"Function\",\"String\",\"Number\",\"Date\",\"RegExp\"],function(n){j[\"is\"+n]=function(t){return l.call(t)==\"[object \"+n+\"]\"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,\"callee\"))}),\"function\"!=typeof/./&&(j.isFunction=function(n){return\"function\"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||\"[object Boolean]\"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp(\"[\"+j.keys(I.escape).join(\"\")+\"]\",\"g\"),unescape:new RegExp(\"(\"+j.keys(I.unescape).join(\"|\")+\")\",\"g\")};j.each([\"escape\",\"unescape\"],function(n){j[n]=function(t){return null==t?\"\":(\"\"+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+\"\";return n?n+t:t},j.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var q=/(.)^/,B={\"'\":\"'\",\"\\\\\":\"\\\\\",\"\\r\":\"r\",\"\\n\":\"n\",\"\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},D=/\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join(\"|\")+\"|$\",\"g\"),i=0,a=\"__p+='\";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return\"\\\\\"+B[n]}),r&&(a+=\"'+\\n((__t=(\"+r+\"))==null?'':_.escape(__t))+\\n'\"),e&&(a+=\"'+\\n((__t=(\"+e+\"))==null?'':__t)+\\n'\"),u&&(a+=\"';\\n\"+u+\"\\n__p+='\"),i=o+t.length,t}),a+=\"';\\n\",r.variable||(a=\"with(obj||{}){\\n\"+a+\"}\\n\"),a=\"var __t,__p='',__j=Array.prototype.join,\"+\"print=function(){__p+=__j.call(arguments,'');};\\n\"+a+\"return __p;\\n\";try{e=new Function(r.variable||\"obj\",\"_\",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source=\"function(\"+(r.variable||\"obj\")+\"){\\n\"+a+\"}\",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),\"shift\"!=n&&\"splice\"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A([\"concat\",\"join\",\"slice\"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);\r\n//# sourceMappingURL=underscor"],[0,"e-mi"]],"start1":0,"start2":0,"length1":19544,"length2":14358}]],"length":14363,"saved":false}
